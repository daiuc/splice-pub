[
  {
    "objectID": "analysis/2024-08-15-GWAS-sQTL-coloc-tally.html",
    "href": "analysis/2024-08-15-GWAS-sQTL-coloc-tally.html",
    "title": "Summarise coloc for GWAS eQTL sQTL",
    "section": "",
    "text": "Note\n\n\n\n\nGES: GWAS eQTL sQTL\nGE: GWAS eQTL\nGS: GWAS sQTL\n\nColoc loci selected with PIP &gt; 0.5\nGWAS hit loci are constructed with 1MB window centering on the lead SNP (&lt; 1e-5)\n\n\n\nAD\nNumber of AD, eQTL only coloc\n\n\nPD\nNumber of PD, eQTL only coloc\n\n\nHeight\nNumber of HT, eQTL only coloc\n\n\nT2D (Type 2 Diabetes)\nNumber of T2D, eQTL only coloc\n\n\n\n\n\n\n\n\nFigure 1: Percentage of loci with GWAS, eQTL, sQTL coloc"
  },
  {
    "objectID": "analysis/2024-07-16-sQTL-beta-beta-plot-check-Liver.html",
    "href": "analysis/2024-07-16-sQTL-beta-beta-plot-check-Liver.html",
    "title": "Check sqtl beta beta corr plot - Liver",
    "section": "",
    "text": "Check sqtl beta beta corr plot\n\n\n[1] \"../smk-plots/gtex-sqtl-enrichment-v4/Cells-EBV-transformedlymphocytes-scatter.png\"\n[2] \"../smk-plots/gtex-sqtl-enrichment-v4/Liver-scatter.png\"                           \n[3] \"../smk-plots/gtex-sqtl-enrichment-v4/WholeBlood-scatter.png\"                      \n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 2: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 3: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\nTake a closer look at whole blood\nConsider selecting random intron for PR also try random selection for UP\n\n\nRemoved 67 transcriptional snps\n\n\n\n\nWarning: Transformation introduced infinite values in continuous x-axis\n\n\nWarning: Removed 450 rows containing non-finite values (`stat_ecdf()`).\n\n\n\n\n\n\n\n\n\nRemove introns with low read counts (less than 10 reads).\n\n\n[1] \"Number of sQTLs removed due to low read counts:\"\n\n\n   ctype   N\n1:    PR 536\n2: PR,UP  73\n\n\n[1] \"Number of sQTLs remaining:\"\n\n\n   ctype   N\n1:    PR 675\n2: PR,UP 520\n\n\nCorrelation test for Liver:\nOriginal:\n\n\n          ctype         pval   estimate xpos ypos\nPR   Productive 1.569125e-04 -0.1440360    0    0\nUP Unproductive 1.205498e-12 -0.3037351    0    0\n\n\nsplit by intron bins:\n\n\n    ctype binsbyMean   N\n 1:    PR      (0,1] 227\n 2:    PR      (1,2] 133\n 3:    PR      (2,5] 178\n 4:    PR     (5,10] 146\n 5:    PR    (10,20] 169\n 6:    PR    (20,50] 145\n 7:    PR   (50,100]  95\n 8:    PR  (100,Inf] 131\n 9: PR,UP      (0,1] 202\n10: PR,UP      (1,2] 106\n11: PR,UP      (2,5] 123\n12: PR,UP     (5,10]  93\n13: PR,UP    (10,20]  39\n14: PR,UP    (20,50]  24\n15: PR,UP   (50,100]   8\n16: PR,UP  (100,Inf]   4\n\n\n\n\n\n\n\n\n\n\n\nbefore removing low reads\n\n\n\n\n\n\n\n\n\nafter removing low reads\n\n\n\n\n\n\n\nFigure 4: Beta beta correlation plot for Liver:\n\n\n\n\n\n$`(0,1]`\n          ctype         pval   estimate xpos ypos\nPR   Productive 8.193055e-10 -0.3932333    0    0\nUP Unproductive 1.139917e-12 -0.4732474    0    0\n\n$`(1,2]`\n          ctype       pval   estimate xpos ypos\nUP Unproductive 0.02968139 -0.2113030    0    0\nPR   Productive 0.43620741 -0.0680786    0    0\n\n$`(10,20]`\n          ctype      pval    estimate xpos ypos\nPR   Productive 0.4299658 -0.06110832    0    0\nUP Unproductive 0.8583073  0.02954254    0    0\n\n$`(100,Inf]`\n          ctype       pval   estimate xpos ypos\nPR   Productive 0.02455384  0.1964043    0    0\nUP Unproductive 0.39536401 -0.6046360    0    0\n\n$`(2,5]`\n          ctype       pval    estimate xpos ypos\nPR   Productive 0.50020538 -0.05085651    0    0\nUP Unproductive 0.05991577 -0.17013945    0    0\n\n$`(20,50]`\n          ctype      pval     estimate xpos ypos\nPR   Productive 0.9423765 -0.006055148    0    0\nUP Unproductive 0.2912667  0.224645397    0    0\n\n$`(5,10]`\n          ctype      pval    estimate xpos ypos\nPR   Productive 0.2736122  0.09119975    0    0\nUP Unproductive 0.1549035 -0.14868809    0    0\n\n$`(50,100]`\n          ctype      pval     estimate xpos ypos\nPR   Productive 0.3968099  0.087929945    0    0\nUP Unproductive 0.9959961 -0.002135432    0    0"
  },
  {
    "objectID": "analysis/2024-06-10-tally-sQTLs.html",
    "href": "analysis/2024-06-10-tally-sQTLs.html",
    "title": "QTL tally",
    "section": "",
    "text": "Code\nbase.geu &lt;- \"../code/results/qtl/noisy/Geuvadis/EUR/separateNoise/cis_100000/perm\"\ngeu.sql.f &lt;- glue(\"{base}/chr{chroms}.addQval.txt.gz\", base = base.geu, chroms = 1:22)\nnames(geu.sql.f) &lt;- glue(\"chr{1:22}\")\n\n\n\n\nCode\ngeu.sql &lt;- map_dfr(geu.sql.f, fread)\n\n\n\n\nCode\naddLabels &lt;- function(dt) {\n  pid_split &lt;- str_split(dt$phenotype_id, \":\")\n  dt$itype &lt;- map_chr(pid_split, ~ .x[5])\n  dt$clu &lt;- map_chr(pid_split, ~ .x[4])\n  dt$clu &lt;- str_extract(dt$clu, \"clu_[0-9]+\")\n\n  dt &lt;- dt[, ctype := paste(sort(unique(itype)), collapse = \",\"), by = clu][]\n  return(dt)\n}\n\n\n\n\nCode\ngeu.sql &lt;- addLabels(geu.sql)\n\n\n\n\nCode\ngeu.sql[1:2, ] %&gt;% DT::datatable()\n\n\n\n\n\n\n\n\nNumber of introns\n\n\nCode\ngeu.sql[, .N, by = itype\n  ][, .(itype, N, P = N/sum(N)  )\n  ][order(-N)]\n\n\n    itype     N          P\n   &lt;char&gt; &lt;int&gt;      &lt;num&gt;\n1:     PR 83826 0.63891768\n2:     UP 29665 0.22610518\n3:     IN 11756 0.08960366\n4:     NE  5953 0.04537348\n\n\nNumber of clusters\n\n\nCode\ngeu.sql[, .(N = uniqueN(clu)), by = .(ctype)][, .(ctype, N, P = N/sum(N))][order(-N)]\n\n\n          ctype     N            P\n         &lt;char&gt; &lt;int&gt;        &lt;num&gt;\n 1:          PR 21693 0.4992175634\n 2:       PR,UP 14598 0.3359414553\n 3:          IN  2943 0.0677267915\n 4:       NE,PR  2154 0.0495696599\n 5:    NE,PR,UP  1277 0.0293873982\n 6:          UP   488 0.0112302665\n 7:          NE    72 0.0016569246\n 8:    IN,PR,UP    53 0.0012196806\n 9:       IN,UP    43 0.0009895522\n10:       IN,PR    38 0.0008744880\n11:    IN,NE,PR    31 0.0007133981\n12: IN,NE,PR,UP    22 0.0005062825\n13:       IN,NE    20 0.0004602568\n14:       NE,UP    17 0.0003912183\n15:    IN,NE,UP     5 0.0001150642\n\n\n\n\n\nNumber of introns with FDR &lt; 0.1\n\n\nCode\nFDR = params$fdr\n\n\n\n\nCode\ngeu.sql[q &lt; FDR, .N, by = .(itype)][, .(itype, N, P = N/sum(N))][order(-N)]\n\n\n    itype     N          P\n   &lt;char&gt; &lt;int&gt;      &lt;num&gt;\n1:     PR  9092 0.54777684\n2:     UP  3981 0.23984817\n3:     IN  2690 0.16206772\n4:     NE   835 0.05030727\n\n\nNumber of clusters with FDR &lt; 0.1\n\n\nCode\ngeu.sql[q &lt; FDR, .(N = uniqueN(clu)), by = .(ctype)][, .(ctype, N, P = N/sum(N))][order(-N)]\n\n\n          ctype     N            P\n         &lt;char&gt; &lt;int&gt;        &lt;num&gt;\n 1:       PR,UP  3391 0.4070828331\n 2:          PR  2405 0.2887154862\n 3:          IN   971 0.1165666267\n 4:       NE,PR   700 0.0840336134\n 5:    NE,PR,UP   642 0.0770708283\n 6:          UP    86 0.0103241297\n 7:    IN,PR,UP    27 0.0032412965\n 8:       IN,PR    22 0.0026410564\n 9:    IN,NE,PR    21 0.0025210084\n10:       IN,UP    20 0.0024009604\n11: IN,NE,PR,UP    17 0.0020408163\n12:          NE    15 0.0018007203\n13:       IN,NE     8 0.0009603842\n14:       NE,UP     4 0.0004801921\n15:    IN,NE,UP     1 0.0001200480\n\n\n\n\n\nNumber of introns satisfying FDR &lt; 0.1 and from clusters of PR or PR,UP\n\n\nCode\ngeu.sql[q &lt; FDR & ctype %in% c(\"PR\", \"PR,UP\"), .N, by = .(itype)][, .(itype, N, P = N/sum(N))][order(-N)]\n\n\n    itype     N         P\n   &lt;char&gt; &lt;int&gt;     &lt;num&gt;\n1:     PR  6960 0.6886998\n2:     UP  3146 0.3113002\n\n\nNumber of clusters satisfying FDR &lt; 0.1 and from clusters of PR or PR,UP\n\n\nCode\ngeu.sql[q &lt; FDR & ctype %in% c(\"PR\", \"PR,UP\"), .(N = uniqueN(clu)), by = .(ctype)][, .(ctype, N, P = N/sum(N))][order(-N)]\n\n\n    ctype     N         P\n   &lt;char&gt; &lt;int&gt;     &lt;num&gt;\n1:  PR,UP  3391 0.5850587\n2:     PR  2405 0.4149413\n\n\n\n\n\n\nFor GTEx, use sQTLs from 49 tissues. We use FDR &lt; 0.1 and cluster type PR or PR,UP to filter sQTLs.\n\n\nCode\nTissues &lt;- dir(\"../code/results/qtl/noisy/GTEx/\")\nTissues &lt;- Tissues[!Tissues %in% c(\"Bladder\")]\nnames(Tissues) &lt;- Tissues \nbase1.gtex &lt;- \"../code/results/qtl/noisy/GTEx\"\nbase2.gtex &lt;- \"/cis_100000/perm\"\nsuffix &lt;- \"addQval.txt.gz\"\n# \"../code/results/qtl/noisy/GTEx/Liver/separateNoise/cis_100000/perm/chr1.addQval.txt.gz\"\n\n\n\n\nCode\nreadGTExSQTL &lt;- function(tissue) {\n  base1.gtex &lt;- \"../code/results/qtl/noisy/GTEx/\"\n  base2.gtex &lt;- \"/cis_100000/perm\"\n  suffix &lt;- \"addQval.txt.gz\"\n  folder &lt;- glue(\"{base1.gtex}/{tissue}/separateNoise{base2.gtex}\")\n  files &lt;- glue(\"{folder}/chr{1:22}.{suffix}\")\n  dt &lt;- map_dfr(files, fread)\n}\n\n\n\n\nCode\ngtex.sqls &lt;- readRDS(\"2024-06-10-gtex-sQTLs.rds\")\n\n\n\n\nCode\ntissue.labels &lt;- fread(\"/project/yangili1/cdai/splice-pub/analysis/gtex-tissue-code.csv\",\n                      col.names = c(\"tissue\", \"label\"), header = F)\n\n\nNumber of introns that satisfy FDR &lt; 0.1 and from clusters of PR or PR,UP\n\n\nCode\ngtex.plot1.dt &lt;- imap_dfr(gtex.sqls, \\(x, y) {x[q &lt; FDR & ctype %in% c(\"PR\", \"PR,UP\"), .N, by = .(itype)][, .(tissue = y, itype, N, P = N/sum(N))][order(-N)]})\n\n\n\n\nCode\ngtex.plot1.dt %&gt;% \n  left_join(y = tissue.labels, by = \"tissue\") %&gt;% \n  ggplot() + geom_col(aes(x = forcats::fct_reorder(label, -N), y = N, fill = itype)) +\n    scale_fill_brewer(palette = \"Blues\", direction = 1) +\n    labs(x = NULL, y = \"Num. of sQTL introns\", fill = NULL) + \n    theme_cowplot() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1),\n          legend.position = \"top\"\n         )\n\n\n\n\n\n\n\n\nFigure 1\n\n\n\n\n\n\n\nCode\ngtex.plot1.dt %&gt;% DT::datatable()\n\n\n\n\nTable 1\n\n\n\n\n\n\n\n\n\n\nNumber of clusters that satisfy FDR &lt; 0.1 and from clusters of PR or PR,UP\n\n\nCode\ngtex.plot2.dt &lt;- imap_dfr(gtex.sqls, \\(x, y) {\n  x[q &lt; FDR & ctype %in% c(\"PR\", \"PR,UP\"), .(N = uniqueN(clu)), by = .(ctype)][, .(tissue = y, ctype, N, P = N/sum(N))][order(-N)]\n}\n)\n\n\n\n\nCode\ngtex.plot2.dt %&gt;% \n  left_join(y = tissue.labels, by = \"tissue\") %&gt;% \n  ggplot() + geom_col(aes(x = forcats::fct_reorder(label, -N), y = N, fill = ctype)) +\n    scale_fill_brewer(palette = \"Blues\", direction = 1) +\n    labs(x = NULL, y = \"Num. of sQTL (cluster)\", fill = NULL) + \n    theme_cowplot() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1),\n          legend.position = \"top\"\n         )\n\n\n\n\n\n\n\n\nFigure 2\n\n\n\n\n\n\n\nCode\nggsave(\"2024-06-10-gtex-sqtl-tally-by-tissue.svg\", width = 8, height = 4)\n\n\n\n\nCode\ngtex.plot2.dt %&gt;% DT::datatable()\n\n\n\n\nTable 2"
  },
  {
    "objectID": "analysis/2024-06-10-tally-sQTLs.html#geuvaids-eur",
    "href": "analysis/2024-06-10-tally-sQTLs.html#geuvaids-eur",
    "title": "QTL tally",
    "section": "",
    "text": "Code\nbase.geu &lt;- \"../code/results/qtl/noisy/Geuvadis/EUR/separateNoise/cis_100000/perm\"\ngeu.sql.f &lt;- glue(\"{base}/chr{chroms}.addQval.txt.gz\", base = base.geu, chroms = 1:22)\nnames(geu.sql.f) &lt;- glue(\"chr{1:22}\")\n\n\n\n\nCode\ngeu.sql &lt;- map_dfr(geu.sql.f, fread)\n\n\n\n\nCode\naddLabels &lt;- function(dt) {\n  pid_split &lt;- str_split(dt$phenotype_id, \":\")\n  dt$itype &lt;- map_chr(pid_split, ~ .x[5])\n  dt$clu &lt;- map_chr(pid_split, ~ .x[4])\n  dt$clu &lt;- str_extract(dt$clu, \"clu_[0-9]+\")\n\n  dt &lt;- dt[, ctype := paste(sort(unique(itype)), collapse = \",\"), by = clu][]\n  return(dt)\n}\n\n\n\n\nCode\ngeu.sql &lt;- addLabels(geu.sql)\n\n\n\n\nCode\ngeu.sql[1:2, ] %&gt;% DT::datatable()\n\n\n\n\n\n\n\n\nNumber of introns\n\n\nCode\ngeu.sql[, .N, by = itype\n  ][, .(itype, N, P = N/sum(N)  )\n  ][order(-N)]\n\n\n    itype     N          P\n   &lt;char&gt; &lt;int&gt;      &lt;num&gt;\n1:     PR 83826 0.63891768\n2:     UP 29665 0.22610518\n3:     IN 11756 0.08960366\n4:     NE  5953 0.04537348\n\n\nNumber of clusters\n\n\nCode\ngeu.sql[, .(N = uniqueN(clu)), by = .(ctype)][, .(ctype, N, P = N/sum(N))][order(-N)]\n\n\n          ctype     N            P\n         &lt;char&gt; &lt;int&gt;        &lt;num&gt;\n 1:          PR 21693 0.4992175634\n 2:       PR,UP 14598 0.3359414553\n 3:          IN  2943 0.0677267915\n 4:       NE,PR  2154 0.0495696599\n 5:    NE,PR,UP  1277 0.0293873982\n 6:          UP   488 0.0112302665\n 7:          NE    72 0.0016569246\n 8:    IN,PR,UP    53 0.0012196806\n 9:       IN,UP    43 0.0009895522\n10:       IN,PR    38 0.0008744880\n11:    IN,NE,PR    31 0.0007133981\n12: IN,NE,PR,UP    22 0.0005062825\n13:       IN,NE    20 0.0004602568\n14:       NE,UP    17 0.0003912183\n15:    IN,NE,UP     5 0.0001150642\n\n\n\n\n\nNumber of introns with FDR &lt; 0.1\n\n\nCode\nFDR = params$fdr\n\n\n\n\nCode\ngeu.sql[q &lt; FDR, .N, by = .(itype)][, .(itype, N, P = N/sum(N))][order(-N)]\n\n\n    itype     N          P\n   &lt;char&gt; &lt;int&gt;      &lt;num&gt;\n1:     PR  9092 0.54777684\n2:     UP  3981 0.23984817\n3:     IN  2690 0.16206772\n4:     NE   835 0.05030727\n\n\nNumber of clusters with FDR &lt; 0.1\n\n\nCode\ngeu.sql[q &lt; FDR, .(N = uniqueN(clu)), by = .(ctype)][, .(ctype, N, P = N/sum(N))][order(-N)]\n\n\n          ctype     N            P\n         &lt;char&gt; &lt;int&gt;        &lt;num&gt;\n 1:       PR,UP  3391 0.4070828331\n 2:          PR  2405 0.2887154862\n 3:          IN   971 0.1165666267\n 4:       NE,PR   700 0.0840336134\n 5:    NE,PR,UP   642 0.0770708283\n 6:          UP    86 0.0103241297\n 7:    IN,PR,UP    27 0.0032412965\n 8:       IN,PR    22 0.0026410564\n 9:    IN,NE,PR    21 0.0025210084\n10:       IN,UP    20 0.0024009604\n11: IN,NE,PR,UP    17 0.0020408163\n12:          NE    15 0.0018007203\n13:       IN,NE     8 0.0009603842\n14:       NE,UP     4 0.0004801921\n15:    IN,NE,UP     1 0.0001200480\n\n\n\n\n\nNumber of introns satisfying FDR &lt; 0.1 and from clusters of PR or PR,UP\n\n\nCode\ngeu.sql[q &lt; FDR & ctype %in% c(\"PR\", \"PR,UP\"), .N, by = .(itype)][, .(itype, N, P = N/sum(N))][order(-N)]\n\n\n    itype     N         P\n   &lt;char&gt; &lt;int&gt;     &lt;num&gt;\n1:     PR  6960 0.6886998\n2:     UP  3146 0.3113002\n\n\nNumber of clusters satisfying FDR &lt; 0.1 and from clusters of PR or PR,UP\n\n\nCode\ngeu.sql[q &lt; FDR & ctype %in% c(\"PR\", \"PR,UP\"), .(N = uniqueN(clu)), by = .(ctype)][, .(ctype, N, P = N/sum(N))][order(-N)]\n\n\n    ctype     N         P\n   &lt;char&gt; &lt;int&gt;     &lt;num&gt;\n1:  PR,UP  3391 0.5850587\n2:     PR  2405 0.4149413"
  },
  {
    "objectID": "analysis/2024-06-10-tally-sQTLs.html#gtex",
    "href": "analysis/2024-06-10-tally-sQTLs.html#gtex",
    "title": "QTL tally",
    "section": "",
    "text": "For GTEx, use sQTLs from 49 tissues. We use FDR &lt; 0.1 and cluster type PR or PR,UP to filter sQTLs.\n\n\nCode\nTissues &lt;- dir(\"../code/results/qtl/noisy/GTEx/\")\nTissues &lt;- Tissues[!Tissues %in% c(\"Bladder\")]\nnames(Tissues) &lt;- Tissues \nbase1.gtex &lt;- \"../code/results/qtl/noisy/GTEx\"\nbase2.gtex &lt;- \"/cis_100000/perm\"\nsuffix &lt;- \"addQval.txt.gz\"\n# \"../code/results/qtl/noisy/GTEx/Liver/separateNoise/cis_100000/perm/chr1.addQval.txt.gz\"\n\n\n\n\nCode\nreadGTExSQTL &lt;- function(tissue) {\n  base1.gtex &lt;- \"../code/results/qtl/noisy/GTEx/\"\n  base2.gtex &lt;- \"/cis_100000/perm\"\n  suffix &lt;- \"addQval.txt.gz\"\n  folder &lt;- glue(\"{base1.gtex}/{tissue}/separateNoise{base2.gtex}\")\n  files &lt;- glue(\"{folder}/chr{1:22}.{suffix}\")\n  dt &lt;- map_dfr(files, fread)\n}\n\n\n\n\nCode\ngtex.sqls &lt;- readRDS(\"2024-06-10-gtex-sQTLs.rds\")\n\n\n\n\nCode\ntissue.labels &lt;- fread(\"/project/yangili1/cdai/splice-pub/analysis/gtex-tissue-code.csv\",\n                      col.names = c(\"tissue\", \"label\"), header = F)\n\n\nNumber of introns that satisfy FDR &lt; 0.1 and from clusters of PR or PR,UP\n\n\nCode\ngtex.plot1.dt &lt;- imap_dfr(gtex.sqls, \\(x, y) {x[q &lt; FDR & ctype %in% c(\"PR\", \"PR,UP\"), .N, by = .(itype)][, .(tissue = y, itype, N, P = N/sum(N))][order(-N)]})\n\n\n\n\nCode\ngtex.plot1.dt %&gt;% \n  left_join(y = tissue.labels, by = \"tissue\") %&gt;% \n  ggplot() + geom_col(aes(x = forcats::fct_reorder(label, -N), y = N, fill = itype)) +\n    scale_fill_brewer(palette = \"Blues\", direction = 1) +\n    labs(x = NULL, y = \"Num. of sQTL introns\", fill = NULL) + \n    theme_cowplot() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1),\n          legend.position = \"top\"\n         )\n\n\n\n\n\n\n\n\nFigure 1\n\n\n\n\n\n\n\nCode\ngtex.plot1.dt %&gt;% DT::datatable()\n\n\n\n\nTable 1\n\n\n\n\n\n\n\n\n\n\nNumber of clusters that satisfy FDR &lt; 0.1 and from clusters of PR or PR,UP\n\n\nCode\ngtex.plot2.dt &lt;- imap_dfr(gtex.sqls, \\(x, y) {\n  x[q &lt; FDR & ctype %in% c(\"PR\", \"PR,UP\"), .(N = uniqueN(clu)), by = .(ctype)][, .(tissue = y, ctype, N, P = N/sum(N))][order(-N)]\n}\n)\n\n\n\n\nCode\ngtex.plot2.dt %&gt;% \n  left_join(y = tissue.labels, by = \"tissue\") %&gt;% \n  ggplot() + geom_col(aes(x = forcats::fct_reorder(label, -N), y = N, fill = ctype)) +\n    scale_fill_brewer(palette = \"Blues\", direction = 1) +\n    labs(x = NULL, y = \"Num. of sQTL (cluster)\", fill = NULL) + \n    theme_cowplot() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1),\n          legend.position = \"top\"\n         )\n\n\n\n\n\n\n\n\nFigure 2\n\n\n\n\n\n\n\nCode\nggsave(\"2024-06-10-gtex-sqtl-tally-by-tissue.svg\", width = 8, height = 4)\n\n\n\n\nCode\ngtex.plot2.dt %&gt;% DT::datatable()\n\n\n\n\nTable 2"
  },
  {
    "objectID": "analysis/2024-08-06-process-GWAS-summary-stats.html",
    "href": "analysis/2024-08-06-process-GWAS-summary-stats.html",
    "title": "Process GWAS summary stats",
    "section": "",
    "text": "GWAS\nTrait\n\n\n\n\nAD\nAlzheimer's disease\n\n\nPD\nParkinson's disease\n\n\nT2D\nType 2 diabetes\n\n\nHT\nHeight\n\n\n\n\n\n\n\n\n\n\n\n\n\nGWAS\nPath\n\n\n\n\nAD\n/project/yangili1/cdai/SpliFi/code/resources/GWAS/zpmu-GWAS_loci/AD_sumstats_Jansenetal.txt.gz\n\n\nPD\n/project/yangili1/cdai/SpliFi/code/resources/GWAS/zpmu-GWAS_loci/pkd_nallsEtAl2019_excluding23andMe_allVariants.tab.gz\n\n\nT2D\n/project/yangili1/cdai/SpliFi/code/resources/GWAS/zpmu-GWAS_loci/Mahajan.NatGenet2018b.T2D.European.txt.gz\n\n\nHT\n/project/yangili1/cdai/SpliFi/code/resources/GWAS/zpmu-GWAS_loci/Locke_height_UKBiobank_2018.txt.gz"
  },
  {
    "objectID": "analysis/2024-08-06-process-GWAS-summary-stats.html#ad",
    "href": "analysis/2024-08-06-process-GWAS-summary-stats.html#ad",
    "title": "Process GWAS summary stats",
    "section": "AD",
    "text": "AD\n\nTotal Number of SNPs: 13,367,299;\nNumber of SNPs with P-value &lt; 10^{-5}: 1,457,396;\n\n\n\n\n\n\n\n\n\nuniqID.a1a2\nCHR\nBP\nA1\nA2\nSNP\nZ\nP\nNsum\nNeff\ndir\nMAF\nBETA\nSE\n\n\n\n\n1:715265_T_C\n1\n715265\nT\nC\nrs12184267\n2.121973\n0.03384\n381761\n381761\n??+?\n0.0408069\n0.01227458\n0.005784513\n\n\n1:715367_G_A\n1\n715367\nG\nA\nrs12184277\n1.957915\n0.05024\n382151\n382151\n??+?\n0.0410687\n0.01128522\n0.005763896\n\n\n1:717485_A_C\n1\n717485\nA\nC\nrs12184279\n1.912438\n0.05582\n382180\n382180\n??+?\n0.0405759\n0.01108656\n0.005797083\n\n\n1:720381_T_G\n1\n720381\nT\nG\nrs116801199\n2.295404\n0.02171\n382954\n382954\n??+?\n0.0421620\n0.01305152\n0.005685937\n\n\n1:721290_C_G\n1\n721290\nC\nG\nrs12565286\n2.315602\n0.02058\n382779\n382779\n??+?\n0.0423776\n0.01313731\n0.005673389\n\n\n1:723891_G_C\n1\n723891\nG\nC\nrs2977670\n2.468185\n0.01358\n381362\n381362\n??+?\n0.0631200\n0.01162158\n0.004708552"
  },
  {
    "objectID": "analysis/2024-08-06-process-GWAS-summary-stats.html#pd",
    "href": "analysis/2024-08-06-process-GWAS-summary-stats.html#pd",
    "title": "Process GWAS summary stats",
    "section": "PD",
    "text": "PD\n\nTotal Number of SNPs: 17,510,617;\nNumber of SNPs with P-value &lt; 10^{-5}: 5,806;\n\n\n\n\n\n\n\n\n\nSNP\nA1\nA2\nfreq\nb\nse\np\nN_cases\nN_controls\n\n\n\n\nchr11:88249377\nT\nC\n0.9931\n0.1575\n0.1783\n0.3771\n7161\n5356\n\n\nchr1:60320992\nA\nG\n0.9336\n0.0605\n0.0456\n0.1846\n26421\n442271\n\n\nchr2:18069070\nT\nC\n0.9988\n-0.6774\n1.3519\n0.6163\n582\n905\n\n\nchr8:135908647\nA\nG\n0.2081\n-0.0358\n0.0273\n0.1887\n26421\n442271\n\n\nchr12:3871714\nA\nC\n0.9972\n0.1489\n1.0636\n0.8886\n749\n658\n\n\nchr16:77148858\nA\nG\n0.9976\n-0.1213\n0.3874\n0.7543\n6248\n4391"
  },
  {
    "objectID": "analysis/2024-08-06-process-GWAS-summary-stats.html#ht",
    "href": "analysis/2024-08-06-process-GWAS-summary-stats.html#ht",
    "title": "Process GWAS summary stats",
    "section": "HT",
    "text": "HT\n\nTotal Number of SNPs: 2,348,397;\nNumber of SNPs with P-value &lt; 10^{-5}: 5,806;\n\n\n\n\n\n\n\n\n\nCHR\nPOS\nSNP\nTested_Allele\nOther_Allele\nFreq_Tested_Allele_in_HRS\nBETA\nSE\nP\nN\n\n\n\n\n7\n92383888\nrs10\nA\nC\n0.06431\n0.0006\n0.0044\n0.890\n598895\n\n\n12\n126890980\nrs1000000\nA\nG\n0.22190\n0.0001\n0.0023\n0.950\n689928\n\n\n4\n21618674\nrs10000010\nT\nC\n0.50860\n0.0008\n0.0020\n0.670\n785319\n\n\n4\n1357325\nrs10000012\nC\nG\n0.86340\n0.0034\n0.0028\n0.230\n692463\n\n\n4\n37225069\nrs10000013\nA\nC\n0.77080\n-0.0051\n0.0024\n0.034\n687856\n\n\n4\n84778125\nrs10000017\nT\nC\n0.22840\n0.0042\n0.0024\n0.073\n686123"
  },
  {
    "objectID": "analysis/2024-08-06-process-GWAS-summary-stats.html#t2d",
    "href": "analysis/2024-08-06-process-GWAS-summary-stats.html#t2d",
    "title": "Process GWAS summary stats",
    "section": "T2D",
    "text": "T2D\n\nTotal Number of SNPs: 23,465,132;\nNumber of SNPs with P-value &lt; 10^{-5}: 44,546;\n\n\n\n\n\n\n\n\n\nSNP\nChr\nPos\nEA\nNEA\nEAF\nBeta\nSE\nPvalue\nNeff\n\n\n\n\n1:100000012\n1\n100000012\nT\nG\n0.2500\n-0.0260\n0.0073\n0.00040\n231420\n\n\n1:10000006\n1\n10000006\nA\nG\n0.0047\n-0.0380\n0.0560\n0.49000\n225429\n\n\n1:100000135\n1\n100000135\nA\nT\n0.9900\n-0.0330\n0.0550\n0.55000\n226311\n\n\n1:100000436\n1\n100000436\nT\nC\n1.0000\n-0.0980\n0.1900\n0.61000\n185906\n\n\n1:100000827\n1\n100000827\nT\nC\n0.3000\n-0.0230\n0.0069\n0.00075\n231420\n\n\n1:100000843\n1\n100000843\nT\nC\n0.9400\n0.0006\n0.0140\n0.97000\n231420"
  },
  {
    "objectID": "analysis/2024-08-06-process-GWAS-summary-stats.html#ad-1",
    "href": "analysis/2024-08-06-process-GWAS-summary-stats.html#ad-1",
    "title": "Process GWAS summary stats",
    "section": "AD",
    "text": "AD\n\n\n\n\n\n\n\n\n#CHR\nBP\nid\nSNP\nZ\nP\nBETA\nSE\nNsum\nNeff\nA1\nA2\nMAF\n\n\n\n\nchr1\n779885\n1:715265_T_C\nrs12184267\n2.121973\n0.03384\n0.01227458\n0.005784513\n381761\n381761\nT\nC\n0.0408069\n\n\nchr1\n779987\n1:715367_G_A\nrs12184277\n1.957915\n0.05024\n0.01128522\n0.005763896\n382151\n382151\nG\nA\n0.0410687\n\n\nchr1\n782105\n1:717485_A_C\nrs12184279\n1.912438\n0.05582\n0.01108656\n0.005797083\n382180\n382180\nA\nC\n0.0405759\n\n\nchr1\n785001\n1:720381_T_G\nrs116801199\n2.295404\n0.02171\n0.01305152\n0.005685937\n382954\n382954\nT\nG\n0.0421620\n\n\nchr1\n785910\n1:721290_C_G\nrs12565286\n2.315602\n0.02058\n0.01313731\n0.005673389\n382779\n382779\nC\nG\n0.0423776\n\n\nchr1\n788511\n1:723891_G_C\nrs2977670\n2.468185\n0.01358\n0.01162158\n0.004708552\n381362\n381362\nG\nC\n0.0631200"
  },
  {
    "objectID": "analysis/2024-08-06-process-GWAS-summary-stats.html#pd-1",
    "href": "analysis/2024-08-06-process-GWAS-summary-stats.html#pd-1",
    "title": "Process GWAS summary stats",
    "section": "PD",
    "text": "PD\n\n\n\n\n\n\n\n\n#CHR\nBP\nid\nBETA\nSE\nP\nN_cases\nN_controls\nA1\nA2\nfreq\n\n\n\n\nchr1\n54591\nchr1:54591\n-0.6797\n0.8869\n0.44350\n527\n472\nA\nG\n0.9938\n\n\nchr1\n54676\nchr1:54676\n-0.0996\n0.0656\n0.12870\n1169\n968\nT\nC\n0.3166\n\n\nchr1\n79188\nchr1:79188\n0.6704\n0.8795\n0.44590\n527\n472\nT\nG\n0.0062\n\n\nchr1\n82994\nchr1:82994\n1.2614\n1.8502\n0.49540\n527\n472\nA\nG\n0.9984\n\n\nchr1\n86028\nchr1:86028\n-0.2158\n0.1222\n0.07745\n1169\n968\nT\nC\n0.9345\n\n\nchr1\n90231\nchr1:90231\n-1.7603\n1.8868\n0.35080\n527\n472\nA\nC\n0.0017"
  },
  {
    "objectID": "analysis/2024-08-06-process-GWAS-summary-stats.html#ht-1",
    "href": "analysis/2024-08-06-process-GWAS-summary-stats.html#ht-1",
    "title": "Process GWAS summary stats",
    "section": "HT",
    "text": "HT\n\n\n\n\n\n\n\n\n#CHR\nBP\nSNP\nBETA\nSE\nP\nN\nTested_Allele\nOther_Allele\nfreq\n\n\n\n\nchr1\n818161\nrs2073813\n-0.0041\n0.0029\n0.17\n517173\nA\nG\n0.1425\n\n\nchr1\n818812\nrs3131968\n-0.0034\n0.0029\n0.25\n551519\nA\nG\n0.1437\n\n\nchr1\n841742\nrs2980319\n-0.0027\n0.0029\n0.35\n598447\nA\nT\n0.1368\n\n\nchr1\n843942\nrs4040617\n0.0032\n0.0029\n0.27\n587624\nA\nG\n0.8647\n\n\nchr1\n845405\nrs2977612\n0.0030\n0.0029\n0.31\n582906\nA\nT\n0.8550\n\n\nchr1\n849670\nrs2905062\n0.0030\n0.0029\n0.30\n641437\nA\nG\n0.8558"
  },
  {
    "objectID": "analysis/2024-08-06-process-GWAS-summary-stats.html#t2d-1",
    "href": "analysis/2024-08-06-process-GWAS-summary-stats.html#t2d-1",
    "title": "Process GWAS summary stats",
    "section": "T2D",
    "text": "T2D\n\n\n\n\n\n\n\n\n#CHR\nBP\nid\nBETA\nSE\nP\nNeff\nEA\nNEA\nEAF\n\n\n\n\nchr1\n79033\n1:79033\n0.190\n0.19\n0.31\n93943\nA\nG\n0.0014\n\n\nchr1\n79137\n1:79137\n-0.043\n0.32\n0.89\n93632\nA\nT\n1.0000\n\n\nchr1\n118630\n1:118630\n0.080\n0.46\n0.86\n129175\nT\nC\n0.0004\n\n\nchr1\n597799\n1:533179\n0.250\n0.50\n0.62\n87636\nA\nG\n1.0000\n\n\nchr1\n605323\n1:540703\n0.270\n0.84\n0.74\n15329\nA\nG\n1.0000\n\n\nchr1\n609204\n1:544584\n-0.130\n0.12\n0.28\n120472\nT\nC\n0.0024"
  },
  {
    "objectID": "analysis/2024-07-25-plot-beta-beta-heatmap.html",
    "href": "analysis/2024-07-25-plot-beta-beta-heatmap.html",
    "title": "Plot heatmap of effect size correlation between eQTL and sQTL (updated new vs. old pseudo count)",
    "section": "",
    "text": "The goal is to compute the correlations between sQTL beta and eQTL beta for top p vs. u sQTL top SNPs in a heatmap. It effectively summarises the 49 beta vs. beta scatter plots.\ndata:\n\np vs. u sQTL top SNPs\nregression slope in sQTL mapping\nregression slope in eQTL mapping\n\ndo this for each of the 49 tissues. Result is a 2x49 matrix where\n\nrow labels: u or p sQTL (2)\ncol labels: tissue (49)\nvalues: correlation value of betas.\n\nplot heatmap:\n\nsplit heatmap into 5 sub heatmaps, each is 2x10 (9) matrix"
  },
  {
    "objectID": "analysis/2024-07-25-plot-beta-beta-heatmap.html#correlation-of-effect-sizes-eqtl-and-sqtl-updated-pseudo-count",
    "href": "analysis/2024-07-25-plot-beta-beta-heatmap.html#correlation-of-effect-sizes-eqtl-and-sqtl-updated-pseudo-count",
    "title": "Plot heatmap of effect size correlation between eQTL and sQTL (updated new vs. old pseudo count)",
    "section": "Correlation of effect sizes: eQTL and sQTL (updated pseudo count)",
    "text": "Correlation of effect sizes: eQTL and sQTL (updated pseudo count)\n\n\n\n\nTable 1: Correlation matrix of beta values between eQTL and sQTL\n\n\n\n\n\n\n\n\n\ntype\nCells-Culturedfibroblasts\nCells-EBV-transformedlymphocytes\nMuscle-Skeletal\nMinorSalivaryGland\nHeart-LeftVentricle\nAdrenalGland\nArtery-Tibial\nArtery-Aorta\nEsophagus-Mucosa\nPancreas\nEsophagus-Muscularis\nBreast-MammaryTissue\nArtery-Coronary\nStomach\nAdipose-Visceral_Omentum_\nColon-Transverse\nSkin-NotSunExposed_Suprapubic_\nAdipose-Subcutaneous\nSkin-SunExposed_Lowerleg_\nTestis\nEsophagus-GastroesophagealJunction\nBrain-Hypothalamus\nLung\nWholeBlood\nColon-Sigmoid\nHeart-AtrialAppendage\nBrain-Cerebellum\nUterus\nBrain-Nucleusaccumbens_basalganglia_\nNerve-Tibial\nSmallIntestine-TerminalIleum\nBrain-Anteriorcingulatecortex_BA24_\nBrain-FrontalCortex_BA9_\nBrain-Cortex\nProstate\nVagina\nBrain-Substantianigra\nThyroid\nOvary\nBrain-CerebellarHemisphere\nPituitary\nBrain-Putamen_basalganglia_\nBrain-Caudate_basalganglia_\nBrain-Hippocampus\nSpleen\nBrain-Amygdala\nBrain-Spinalcord_cervicalc-1_\nLiver\nKidney-Cortex\n\n\n\n\nUP\n−0.262\n−0.256\n−0.170\n−0.149\n−0.140\n−0.128\n−0.118\n−0.111\n−0.105\n−0.102\n−0.098\n−0.096\n−0.096\n−0.091\n−0.086\n−0.081\n−0.077\n−0.075\n−0.072\n−0.072\n−0.069\n−0.068\n−0.066\n−0.062\n−0.057\n−0.056\n−0.036\n−0.035\n−0.017\n−0.008\n−0.007\n−0.002\n−0.001\n0.002\n0.005\n0.007\n0.008\n0.010\n0.020\n0.020\n0.030\n0.032\n0.033\n0.041\n0.061\n0.061\n0.063\n0.066\n0.090\n\n\nPR\n0.049\n−0.006\n−0.013\n−0.003\n−0.005\n0.061\n0.043\n0.052\n−0.008\n0.038\n0.027\n−0.008\n0.036\n0.041\n0.002\n−0.033\n−0.021\n−0.018\n0.014\n0.031\n0.002\n0.040\n0.014\n−0.006\n0.000\n0.018\n0.114\n0.035\n0.059\n−0.022\n−0.026\n−0.022\n0.031\n−0.006\n0.079\n−0.035\n−0.010\n0.006\n−0.071\n0.040\n0.050\n−0.147\n−0.094\n0.004\n0.008\n−0.065\n−0.078\n−0.091\n0.007\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTable 2: Correlation pval matrix of beta values between eQTL and sQTL\n\n\n\n\n\n\n\n\n\ntype\nCells-Culturedfibroblasts\nCells-EBV-transformedlymphocytes\nMuscle-Skeletal\nMinorSalivaryGland\nHeart-LeftVentricle\nAdrenalGland\nArtery-Tibial\nArtery-Aorta\nEsophagus-Mucosa\nPancreas\nEsophagus-Muscularis\nBreast-MammaryTissue\nArtery-Coronary\nStomach\nAdipose-Visceral_Omentum_\nColon-Transverse\nSkin-NotSunExposed_Suprapubic_\nAdipose-Subcutaneous\nSkin-SunExposed_Lowerleg_\nTestis\nEsophagus-GastroesophagealJunction\nBrain-Hypothalamus\nLung\nWholeBlood\nColon-Sigmoid\nHeart-AtrialAppendage\nBrain-Cerebellum\nUterus\nBrain-Nucleusaccumbens_basalganglia_\nNerve-Tibial\nSmallIntestine-TerminalIleum\nBrain-Anteriorcingulatecortex_BA24_\nBrain-FrontalCortex_BA9_\nBrain-Cortex\nProstate\nVagina\nBrain-Substantianigra\nThyroid\nOvary\nBrain-CerebellarHemisphere\nPituitary\nBrain-Putamen_basalganglia_\nBrain-Caudate_basalganglia_\nBrain-Hippocampus\nSpleen\nBrain-Amygdala\nBrain-Spinalcord_cervicalc-1_\nLiver\nKidney-Cortex\n\n\n\n\nUP\n3.08 × 10−23\n1.91 × 10−11\n1.20 × 10−9\n3.89 × 10−4\n2.90 × 10−4\n4.23 × 10−4\n3.23 × 10−6\n2.92 × 10−4\n1.66 × 10−4\n5.60 × 10−3\n3.33 × 10−4\n5.20 × 10−4\n1.11 × 10−2\n6.37 × 10−3\n1.62 × 10−3\n5.72 × 10−3\n3.90 × 10−3\n2.20 × 10−3\n4.04 × 10−3\n1.05 × 10−3\n2.63 × 10−2\n1.54 × 10−1\n1.01 × 10−2\n4.79 × 10−2\n6.58 × 10−2\n8.22 × 10−2\n1.30 × 10−1\n4.27 × 10−1\n6.97 × 10−1\n7.42 × 10−1\n8.58 × 10−1\n9.58 × 10−1\n9.79 × 10−1\n9.52 × 10−1\n8.85 × 10−1\n8.33 × 10−1\n8.35 × 10−1\n5.41 × 10−1\n4.76 × 10−1\n4.23 × 10−1\n3.57 × 10−1\n3.12 × 10−1\n2.34 × 10−1\n2.19 × 10−1\n6.49 × 10−2\n1.02 × 10−1\n7.13 × 10−2\n3.81 × 10−2\n6.85 × 10−2\n\n\nPR\n3.35 × 10−3\n8.08 × 10−1\n4.68 × 10−1\n9.07 × 10−1\n8.52 × 10−1\n1.03 × 10−2\n1.31 × 10−2\n9.56 × 10−3\n6.69 × 10−1\n1.28 × 10−1\n1.51 × 10−1\n6.90 × 10−1\n1.69 × 10−1\n7.32 × 10−2\n8.99 × 10−1\n1.09 × 10−1\n2.45 × 10−1\n3.07 × 10−1\n4.06 × 10−1\n6.09 × 10−2\n9.11 × 10−1\n1.95 × 10−1\n4.32 × 10−1\n7.66 × 10−1\n9.98 × 10−1\n3.79 × 10−1\n7.52 × 10−4\n2.53 × 10−1\n3.41 × 10−2\n1.98 × 10−1\n3.48 × 10−1\n6.68 × 10−1\n2.88 × 10−1\n8.11 × 10−1\n1.63 × 10−3\n4.29 × 10−1\n8.78 × 10−1\n8.10 × 10−1\n6.42 × 10−2\n2.69 × 10−1\n2.97 × 10−2\n3.24 × 10−3\n2.95 × 10−2\n9.37 × 10−1\n7.48 × 10−1\n2.96 × 10−1\n1.57 × 10−1\n5.23 × 10−2\n9.26 × 10−1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: Heatmap of correlation between eQTL and sQTL beta values (new pseudo count method)"
  },
  {
    "objectID": "analysis/2024-07-25-plot-beta-beta-heatmap.html#correlation-of-effect-sizes-eqtl-and-sqtl-old-pseudo-count",
    "href": "analysis/2024-07-25-plot-beta-beta-heatmap.html#correlation-of-effect-sizes-eqtl-and-sqtl-old-pseudo-count",
    "title": "Plot heatmap of effect size correlation between eQTL and sQTL (updated new vs. old pseudo count)",
    "section": "Correlation of effect sizes: eQTL and sQTL (old pseudo count)",
    "text": "Correlation of effect sizes: eQTL and sQTL (old pseudo count)\n\n\n\n\nTable 3: Correlation matrix of beta values between eQTL and sQTL (old pseudo count)\n\n\n\n\n\n\n\n\n\ntype\nCells-Culturedfibroblasts\nCells-EBV-transformedlymphocytes\nMuscle-Skeletal\nMinorSalivaryGland\nHeart-LeftVentricle\nAdrenalGland\nArtery-Tibial\nArtery-Aorta\nEsophagus-Mucosa\nPancreas\nEsophagus-Muscularis\nBreast-MammaryTissue\nArtery-Coronary\nStomach\nAdipose-Visceral_Omentum_\nColon-Transverse\nSkin-NotSunExposed_Suprapubic_\nAdipose-Subcutaneous\nSkin-SunExposed_Lowerleg_\nTestis\nEsophagus-GastroesophagealJunction\nBrain-Hypothalamus\nLung\nWholeBlood\nColon-Sigmoid\nHeart-AtrialAppendage\nBrain-Cerebellum\nUterus\nBrain-Nucleusaccumbens_basalganglia_\nNerve-Tibial\nSmallIntestine-TerminalIleum\nBrain-Anteriorcingulatecortex_BA24_\nBrain-FrontalCortex_BA9_\nBrain-Cortex\nProstate\nVagina\nBrain-Substantianigra\nThyroid\nOvary\nBrain-CerebellarHemisphere\nPituitary\nBrain-Putamen_basalganglia_\nBrain-Caudate_basalganglia_\nBrain-Hippocampus\nSpleen\nBrain-Amygdala\nBrain-Spinalcord_cervicalc-1_\nLiver\nKidney-Cortex\n\n\n\n\nUP\n−0.262\n−0.256\n−0.170\n−0.149\n−0.140\n−0.128\n−0.118\n−0.111\n−0.105\n−0.102\n−0.098\n−0.096\n−0.096\n−0.091\n−0.086\n−0.081\n−0.077\n−0.075\n−0.072\n−0.072\n−0.069\n−0.068\n−0.066\n−0.062\n−0.057\n−0.056\n−0.036\n−0.035\n−0.017\n−0.008\n−0.007\n−0.002\n−0.001\n0.002\n0.005\n0.007\n0.008\n0.010\n0.020\n0.020\n0.030\n0.032\n0.033\n0.041\n0.061\n0.061\n0.063\n0.066\n0.090\n\n\nPR\n0.049\n−0.006\n−0.013\n−0.003\n−0.005\n0.061\n0.043\n0.052\n−0.008\n0.038\n0.027\n−0.008\n0.036\n0.041\n0.002\n−0.033\n−0.021\n−0.018\n0.014\n0.031\n0.002\n0.040\n0.014\n−0.006\n0.000\n0.018\n0.114\n0.035\n0.059\n−0.022\n−0.026\n−0.022\n0.031\n−0.006\n0.079\n−0.035\n−0.010\n0.006\n−0.071\n0.040\n0.050\n−0.147\n−0.094\n0.004\n0.008\n−0.065\n−0.078\n−0.091\n0.007\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTable 4: Correlation pval matrix of beta values between eQTL and sQTL (old pseudo count)\n\n\n\n\n\n\n\n\n\ntype\nCells-Culturedfibroblasts\nCells-EBV-transformedlymphocytes\nMuscle-Skeletal\nMinorSalivaryGland\nHeart-LeftVentricle\nAdrenalGland\nArtery-Tibial\nArtery-Aorta\nEsophagus-Mucosa\nPancreas\nEsophagus-Muscularis\nBreast-MammaryTissue\nArtery-Coronary\nStomach\nAdipose-Visceral_Omentum_\nColon-Transverse\nSkin-NotSunExposed_Suprapubic_\nAdipose-Subcutaneous\nSkin-SunExposed_Lowerleg_\nTestis\nEsophagus-GastroesophagealJunction\nBrain-Hypothalamus\nLung\nWholeBlood\nColon-Sigmoid\nHeart-AtrialAppendage\nBrain-Cerebellum\nUterus\nBrain-Nucleusaccumbens_basalganglia_\nNerve-Tibial\nSmallIntestine-TerminalIleum\nBrain-Anteriorcingulatecortex_BA24_\nBrain-FrontalCortex_BA9_\nBrain-Cortex\nProstate\nVagina\nBrain-Substantianigra\nThyroid\nOvary\nBrain-CerebellarHemisphere\nPituitary\nBrain-Putamen_basalganglia_\nBrain-Caudate_basalganglia_\nBrain-Hippocampus\nSpleen\nBrain-Amygdala\nBrain-Spinalcord_cervicalc-1_\nLiver\nKidney-Cortex\n\n\n\n\nUP\n3.08 × 10−23\n1.91 × 10−11\n1.20 × 10−9\n3.89 × 10−4\n2.90 × 10−4\n4.23 × 10−4\n3.23 × 10−6\n2.92 × 10−4\n1.66 × 10−4\n5.60 × 10−3\n3.33 × 10−4\n5.20 × 10−4\n1.11 × 10−2\n6.37 × 10−3\n1.62 × 10−3\n5.72 × 10−3\n3.90 × 10−3\n2.20 × 10−3\n4.04 × 10−3\n1.05 × 10−3\n2.63 × 10−2\n1.54 × 10−1\n1.01 × 10−2\n4.79 × 10−2\n6.58 × 10−2\n8.22 × 10−2\n1.30 × 10−1\n4.27 × 10−1\n6.97 × 10−1\n7.42 × 10−1\n8.58 × 10−1\n9.58 × 10−1\n9.79 × 10−1\n9.52 × 10−1\n8.85 × 10−1\n8.33 × 10−1\n8.35 × 10−1\n5.41 × 10−1\n4.76 × 10−1\n4.23 × 10−1\n3.57 × 10−1\n3.12 × 10−1\n2.34 × 10−1\n2.19 × 10−1\n6.49 × 10−2\n1.02 × 10−1\n7.13 × 10−2\n3.81 × 10−2\n6.85 × 10−2\n\n\nPR\n3.35 × 10−3\n8.08 × 10−1\n4.68 × 10−1\n9.07 × 10−1\n8.52 × 10−1\n1.03 × 10−2\n1.31 × 10−2\n9.56 × 10−3\n6.69 × 10−1\n1.28 × 10−1\n1.51 × 10−1\n6.90 × 10−1\n1.69 × 10−1\n7.32 × 10−2\n8.99 × 10−1\n1.09 × 10−1\n2.45 × 10−1\n3.07 × 10−1\n4.06 × 10−1\n6.09 × 10−2\n9.11 × 10−1\n1.95 × 10−1\n4.32 × 10−1\n7.66 × 10−1\n9.98 × 10−1\n3.79 × 10−1\n7.52 × 10−4\n2.53 × 10−1\n3.41 × 10−2\n1.98 × 10−1\n3.48 × 10−1\n6.68 × 10−1\n2.88 × 10−1\n8.11 × 10−1\n1.63 × 10−3\n4.29 × 10−1\n8.78 × 10−1\n8.10 × 10−1\n6.42 × 10−2\n2.69 × 10−1\n2.97 × 10−2\n3.24 × 10−3\n2.95 × 10−2\n9.37 × 10−1\n7.48 × 10−1\n2.96 × 10−1\n1.57 × 10−1\n5.23 × 10−2\n9.26 × 10−1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 2: Heatmap of correlation between eQTL and sQTL beta values (old pseudo count method)"
  },
  {
    "objectID": "analysis/2024-08-05-GTEx-sqtl-enrich.html",
    "href": "analysis/2024-08-05-GTEx-sqtl-enrich.html",
    "title": "GTEx sQTL enrichment (V4, different pseudocount)",
    "section": "",
    "text": "Note\n\n\n\nChanged pseducount count method in phenotype prep script\n\nfrom: \\[\\frac{num + 0.5 }{ denom + 0.5}\\]\nto : \\[\\frac{num + addon }{ denom + addon}\\], where addon = denom * .01 if denom &lt; 100 else 0.01. using different addon can make a noticeable difference in qtl results.\nliver/kidney plots used spearman correlation and new pseudo count\nother tissues used pearson correlation and close to old pseudo count\nThe underlying data for both the qqplot and the scatter plot are the from this procedure:\nThen for the qqplot, I plotted the pvalue of expression regression for each productive vs. unproductive sQTLs top SNP.\nFor the scatter plot, each top SNP is the top SNP of a productive or unprodutive sQTL. X axis is SNP’s regression slope for gene expression, and Y axis is the regression slope of splicing.\nNote each sQTL is either a productive or unproductive sQTLs, and represent a intron cluster. A productive sQTL is a cluster that only have productive introns. The strongest intron is chosen to represent the cluster (instead of aggregated of all the introns).\nAn unproductive sQTL is a cluster that has both productive intron and unproductive introns with permutation pass q value &lt; 0.1. The best intron (largest top SNP slope) is chosen to represent the cluster as unproductive sQTL. Note, comparing to previous version, here for u-sQTLs (ctype = PR,UP) select the best unproductive intron to represent the cluster."
  },
  {
    "objectID": "analysis/2024-08-05-GTEx-sqtl-enrich.html#with-new-pseudo-count",
    "href": "analysis/2024-08-05-GTEx-sqtl-enrich.html#with-new-pseudo-count",
    "title": "GTEx sQTL enrichment (V4, different pseudocount)",
    "section": "With new pseudo count",
    "text": "With new pseudo count\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 3: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 4: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 6: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 7: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 8: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 9: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 11: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 12: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 13: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 14: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 15: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 16: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 17: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 18: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 19: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 20: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 21: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 22: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 23: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 24: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 25: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 26: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 27: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 28: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 29: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 30: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 31: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 32: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 33: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 34: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 35: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 36: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 37: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 38: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 39: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 40: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 41: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 42: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 43: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 44: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 45: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 46: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 47: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 48: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 49: qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)"
  },
  {
    "objectID": "analysis/2024-08-05-GTEx-sqtl-enrich.html#with-old-pseudo",
    "href": "analysis/2024-08-05-GTEx-sqtl-enrich.html#with-old-pseudo",
    "title": "GTEx sQTL enrichment (V4, different pseudocount)",
    "section": "with old pseudo",
    "text": "with old pseudo\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 50: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 51: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 52: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 53: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 54: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 55: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 56: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 57: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 58: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 59: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 60: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 61: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 62: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 63: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 64: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 65: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 66: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 67: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 68: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 69: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 70: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 71: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 72: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 73: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 74: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 75: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 76: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 77: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 78: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 79: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 80: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 81: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 82: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 83: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 84: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 85: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 86: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 87: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 88: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 89: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 90: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 91: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 92: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 93: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 94: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 95: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 96: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 97: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 98: qqplot of eQTL pvalues of sQTL top SNPs (old pseudocount)"
  },
  {
    "objectID": "analysis/2024-08-05-GTEx-sqtl-enrich.html#with-new-pseudo-count-1",
    "href": "analysis/2024-08-05-GTEx-sqtl-enrich.html#with-new-pseudo-count-1",
    "title": "GTEx sQTL enrichment (V4, different pseudocount)",
    "section": "With new pseudo count",
    "text": "With new pseudo count\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 99: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 100: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 101: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 102: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 103: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 104: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 105: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 106: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 107: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 108: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 109: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 110: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 111: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 112: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 113: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 114: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 115: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 116: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 117: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 118: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 119: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 120: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 121: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 122: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 123: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 124: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 125: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 126: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 127: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 128: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 129: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 130: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 131: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 132: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 133: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 134: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 135: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 136: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 137: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 138: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 139: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 140: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 141: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 142: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 143: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 144: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 145: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\nFigure 146: comparison of sQTL and eQTL effect size (new pseudocount)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 147: comparison of sQTL and eQTL effect size (new pseudocount)"
  },
  {
    "objectID": "analysis/2024-08-05-GTEx-sqtl-enrich.html#with-old-pseudo-count",
    "href": "analysis/2024-08-05-GTEx-sqtl-enrich.html#with-old-pseudo-count",
    "title": "GTEx sQTL enrichment (V4, different pseudocount)",
    "section": "With old pseudo count",
    "text": "With old pseudo count\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 148: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 149: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 150: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 151: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 152: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 153: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 154: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 155: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 156: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 157: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 158: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 159: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 160: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 161: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 162: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 163: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 164: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 165: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 166: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 167: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 168: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 169: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 170: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 171: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 172: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 173: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 174: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 175: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 176: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 177: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 178: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 179: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 180: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 181: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 182: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 183: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 184: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 185: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 186: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 187: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 188: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 189: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 190: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 191: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 192: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 193: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 194: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\nFigure 195: comparison of sQTL and eQTL effect size (old)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 196: comparison of sQTL and eQTL effect size (old)"
  },
  {
    "objectID": "analysis/2024-08-05-GTEx-sqtl-enrich.html#with-new-pseudo-count-2",
    "href": "analysis/2024-08-05-GTEx-sqtl-enrich.html#with-new-pseudo-count-2",
    "title": "GTEx sQTL enrichment (V4, different pseudocount)",
    "section": "with new pseudo count",
    "text": "with new pseudo count\n\n\n$`Adipose-Subcutaneous`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 11659 0.789     PR\n2:  3051 0.206     UP\n3:    71 0.005     NE\n\n$`Adipose-Visceral_Omentum_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  9622 0.792     PR\n2:  2467 0.203     UP\n3:    55 0.005     NE\n\n$AdrenalGland\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  5322 0.798     PR\n2:  1307 0.196     UP\n3:    40 0.006     NE\n\n$`Artery-Aorta`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  8162 0.798     PR\n2:  2010 0.196     UP\n3:    59 0.006     NE\n\n$`Artery-Coronary`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  4675 0.795     PR\n2:  1180 0.201     UP\n3:    26 0.004     NE\n\n$`Artery-Tibial`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 11164 0.797     PR\n2:  2782 0.199     UP\n3:    67 0.005     NE\n\n$`Brain-Amygdala`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  1987 0.813     PR\n2:   450 0.184     UP\n3:     8 0.003     NE\n\n$`Brain-Anteriorcingulatecortex_BA24_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  2789 0.815     PR\n2:   621 0.181     UP\n3:    12 0.004     NE\n\n$`Brain-Caudate_basalganglia_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  3863 0.803     PR\n2:   925 0.192     UP\n3:    24 0.005     NE\n\n$`Brain-CerebellarHemisphere`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  4719 0.780     PR\n2:  1292 0.214     UP\n3:    36 0.006     NE\n\n$`Brain-Cerebellum`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  5528 0.786     PR\n2:  1467 0.209     UP\n3:    35 0.005     NE\n\n$`Brain-Cortex`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  4497 0.804     PR\n2:  1067 0.191     UP\n3:    26 0.005     NE\n\n$`Brain-FrontalCortex_BA9_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  3578 0.810     PR\n2:   820 0.186     UP\n3:    20 0.005     NE\n\n$`Brain-Hippocampus`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  2586 0.803     PR\n2:   619 0.192     UP\n3:    17 0.005     NE\n\n$`Brain-Hypothalamus`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  3180 0.801     PR\n2:   770 0.194     UP\n3:    18 0.005     NE\n\n$`Brain-Nucleusaccumbens_basalganglia_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  3910 0.798     PR\n2:   962 0.196     UP\n3:    25 0.005     NE\n\n$`Brain-Putamen_basalganglia_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  2982 0.810     PR\n2:   685 0.186     UP\n3:    15 0.004     NE\n\n$`Brain-Spinalcord_cervicalc-1_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  2453 0.803     PR\n2:   585 0.192     UP\n3:    16 0.005     NE\n\n$`Brain-Substantianigra`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  1746 0.817     PR\n2:   385 0.180     UP\n3:     6 0.003     NE\n\n$`Breast-MammaryTissue`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  8674 0.782     PR\n2:  2360 0.213     UP\n3:    59 0.005     NE\n\n$`Cells-Culturedfibroblasts`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 11372 0.815     PR\n2:  2531 0.181     UP\n3:    51 0.004     NE\n\n$`Cells-EBV-transformedlymphocytes`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  4732 0.807     PR\n2:  1104 0.188     UP\n3:    31 0.005     NE\n\n$`Colon-Sigmoid`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  7053 0.792     PR\n2:  1808 0.203     UP\n3:    48 0.005     NE\n\n$`Colon-Transverse`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  7702 0.788     PR\n2:  2015 0.206     UP\n3:    58 0.006     NE\n\n$`Esophagus-GastroesophagealJunction`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  7364 0.797     PR\n2:  1828 0.198     UP\n3:    46 0.005     NE\n\n$`Esophagus-Mucosa`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  9445 0.805     PR\n2:  2237 0.191     UP\n3:    51 0.004     NE\n\n$`Esophagus-Muscularis`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  9508 0.795     PR\n2:  2403 0.201     UP\n3:    49 0.004     NE\n\n$`Heart-AtrialAppendage`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  7091 0.800     PR\n2:  1737 0.196     UP\n3:    40 0.005     NE\n\n$`Heart-LeftVentricle`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  5492 0.812     PR\n2:  1243 0.184     UP\n3:    31 0.005     NE\n\n$`Kidney-Cortex`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  1115 0.808     PR\n2:   260 0.188     UP\n3:     5 0.004     NE\n\n$Liver\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  3118 0.784     PR\n2:   836 0.210     UP\n3:    24 0.006     NE\n\n$Lung\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 10787 0.787     PR\n2:  2852 0.208     UP\n3:    64 0.005     NE\n\n$MinorSalivaryGland\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  3537 0.791     PR\n2:   916 0.205     UP\n3:    20 0.004     NE\n\n$`Muscle-Skeletal`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 10232 0.810     PR\n2:  2338 0.185     UP\n3:    57 0.005     NE\n\n$`Nerve-Tibial`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 11891 0.781     PR\n2:  3255 0.214     UP\n3:    74 0.005     NE\n\n$Ovary\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  4033 0.769     PR\n2:  1185 0.226     UP\n3:    27 0.005     NE\n\n$Pancreas\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  4843 0.784     PR\n2:  1296 0.210     UP\n3:    35 0.006     NE\n\n$Pituitary\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  6154 0.778     PR\n2:  1719 0.217     UP\n3:    41 0.005     NE\n\n$Prostate\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  5118 0.773     PR\n2:  1464 0.221     UP\n3:    35 0.005     NE\n\n$`Skin-NotSunExposed_Suprapubic_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 10037 0.790     PR\n2:  2614 0.206     UP\n3:    52 0.004     NE\n\n$`Skin-SunExposed_Lowerleg_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 11473 0.792     PR\n2:  2948 0.204     UP\n3:    60 0.004     NE\n\n$`SmallIntestine-TerminalIleum`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  4108 0.780     PR\n2:  1130 0.215     UP\n3:    26 0.005     NE\n\n$Spleen\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  5539 0.780     PR\n2:  1526 0.215     UP\n3:    36 0.005     NE\n\n$Stomach\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  5886 0.786     PR\n2:  1564 0.209     UP\n3:    43 0.006     NE\n\n$Testis\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 13434 0.763     PR\n2:  4079 0.232     UP\n3:    92 0.005     NE\n\n$Thyroid\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 12614 0.785     PR\n2:  3384 0.211     UP\n3:    78 0.005     NE\n\n$Uterus\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  3205 0.781     PR\n2:   877 0.214     UP\n3:    22 0.005     NE\n\n$Vagina\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  3158 0.778     PR\n2:   878 0.216     UP\n3:    23 0.006     NE\n\n$WholeBlood\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  7443 0.795     PR\n2:  1869 0.200     UP\n3:    49 0.005     NE"
  },
  {
    "objectID": "analysis/2024-08-05-GTEx-sqtl-enrich.html#with-old-pseudo-count-1",
    "href": "analysis/2024-08-05-GTEx-sqtl-enrich.html#with-old-pseudo-count-1",
    "title": "GTEx sQTL enrichment (V4, different pseudocount)",
    "section": "with old pseudo count",
    "text": "with old pseudo count\n\n\n$`Adipose-Subcutaneous`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 12485 0.788     PR\n2:  3280 0.207     UP\n3:    82 0.005     NE\n\n$`Adipose-Visceral_Omentum_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 10207 0.785     PR\n2:  2733 0.210     UP\n3:    61 0.005     NE\n\n$AdrenalGland\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  5602 0.794     PR\n2:  1407 0.200     UP\n3:    43 0.006     NE\n\n$`Artery-Aorta`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  8650 0.790     PR\n2:  2242 0.205     UP\n3:    62 0.006     NE\n\n$`Artery-Coronary`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  4834 0.786     PR\n2:  1289 0.210     UP\n3:    26 0.004     NE\n\n$`Artery-Tibial`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 11907 0.792     PR\n2:  3054 0.203     UP\n3:    77 0.005     NE\n\n$`Brain-Amygdala`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  2020 0.806     PR\n2:   478 0.191     UP\n3:     9 0.004     NE\n\n$`Brain-Anteriorcingulatecortex_BA24_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  2861 0.812     PR\n2:   648 0.184     UP\n3:    15 0.004     NE\n\n$`Brain-Caudate_basalganglia_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  4027 0.801     PR\n2:   967 0.192     UP\n3:    31 0.006     NE\n\n$`Brain-CerebellarHemisphere`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  4893 0.772     PR\n2:  1403 0.222     UP\n3:    38 0.006     NE\n\n$`Brain-Cerebellum`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  5784 0.779     PR\n2:  1597 0.215     UP\n3:    41 0.006     NE\n\n$`Brain-Cortex`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  4617 0.793     PR\n2:  1178 0.202     UP\n3:    26 0.004     NE\n\n$`Brain-FrontalCortex_BA9_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  3734 0.802     PR\n2:   899 0.193     UP\n3:    24 0.005     NE\n\n$`Brain-Hippocampus`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  2681 0.804     PR\n2:   638 0.191     UP\n3:    17 0.005     NE\n\n$`Brain-Hypothalamus`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  3249 0.796     PR\n2:   815 0.200     UP\n3:    20 0.005     NE\n\n$`Brain-Nucleusaccumbens_basalganglia_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  4124 0.796     PR\n2:  1033 0.199     UP\n3:    27 0.005     NE\n\n$`Brain-Putamen_basalganglia_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  3047 0.801     PR\n2:   741 0.195     UP\n3:    15 0.004     NE\n\n$`Brain-Spinalcord_cervicalc-1_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  2490 0.796     PR\n2:   620 0.198     UP\n3:    17 0.005     NE\n\n$`Brain-Substantianigra`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  1748 0.816     PR\n2:   387 0.181     UP\n3:     8 0.004     NE\n\n$`Breast-MammaryTissue`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  9052 0.777     PR\n2:  2530 0.217     UP\n3:    64 0.005     NE\n\n$`Cells-Culturedfibroblasts`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 12077 0.812     PR\n2:  2738 0.184     UP\n3:    59 0.004     NE\n\n$`Cells-EBV-transformedlymphocytes`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  4981 0.802     PR\n2:  1198 0.193     UP\n3:    29 0.005     NE\n\n$`Colon-Sigmoid`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  7384 0.785     PR\n2:  1963 0.209     UP\n3:    55 0.006     NE\n\n$`Colon-Transverse`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  8148 0.787     PR\n2:  2146 0.207     UP\n3:    58 0.006     NE\n\n$`Esophagus-GastroesophagealJunction`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  7689 0.792     PR\n2:  1975 0.203     UP\n3:    49 0.005     NE\n\n$`Esophagus-Mucosa`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  9952 0.800     PR\n2:  2439 0.196     UP\n3:    56 0.004     NE\n\n$`Esophagus-Muscularis`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 10129 0.792     PR\n2:  2609 0.204     UP\n3:    56 0.004     NE\n\n$`Heart-AtrialAppendage`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  7492 0.797     PR\n2:  1865 0.198     UP\n3:    40 0.004     NE\n\n$`Heart-LeftVentricle`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  5859 0.811     PR\n2:  1329 0.184     UP\n3:    38 0.005     NE\n\n$`Kidney-Cortex`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  1122 0.805     PR\n2:   266 0.191     UP\n3:     5 0.004     NE\n\n$Liver\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  3322 0.775     PR\n2:   937 0.219     UP\n3:    25 0.006     NE\n\n$Lung\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 11526 0.784     PR\n2:  3099 0.211     UP\n3:    72 0.005     NE\n\n$MinorSalivaryGland\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  3561 0.785     PR\n2:   956 0.211     UP\n3:    22 0.005     NE\n\n$`Muscle-Skeletal`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 11118 0.804     PR\n2:  2649 0.192     UP\n3:    61 0.004     NE\n\n$`Nerve-Tibial`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 12537 0.778     PR\n2:  3499 0.217     UP\n3:    82 0.005     NE\n\n$Ovary\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  4162 0.767     PR\n2:  1236 0.228     UP\n3:    30 0.006     NE\n\n$Pancreas\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  5220 0.783     PR\n2:  1411 0.212     UP\n3:    37 0.006     NE\n\n$Pituitary\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  6512 0.777     PR\n2:  1823 0.218     UP\n3:    42 0.005     NE\n\n$Prostate\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  5323 0.770     PR\n2:  1558 0.225     UP\n3:    35 0.005     NE\n\n$`Skin-NotSunExposed_Suprapubic_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 10691 0.787     PR\n2:  2826 0.208     UP\n3:    60 0.004     NE\n\n$`Skin-SunExposed_Lowerleg_`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 12237 0.787     PR\n2:  3244 0.209     UP\n3:    60 0.004     NE\n\n$`SmallIntestine-TerminalIleum`\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  4268 0.778     PR\n2:  1187 0.216     UP\n3:    29 0.005     NE\n\n$Spleen\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  5797 0.777     PR\n2:  1625 0.218     UP\n3:    41 0.005     NE\n\n$Stomach\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  6175 0.784     PR\n2:  1648 0.209     UP\n3:    50 0.006     NE\n\n$Testis\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 14076 0.761     PR\n2:  4334 0.234     UP\n3:    88 0.005     NE\n\n$Thyroid\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1: 13370 0.778     PR\n2:  3727 0.217     UP\n3:    92 0.005     NE\n\n$Uterus\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  3308 0.780     PR\n2:   915 0.216     UP\n3:    19 0.004     NE\n\n$Vagina\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  3279 0.776     PR\n2:   923 0.219     UP\n3:    22 0.005     NE\n\n$WholeBlood\n       N     P  itype\n   &lt;int&gt; &lt;num&gt; &lt;char&gt;\n1:  8333 0.785     PR\n2:  2227 0.210     UP\n3:    54 0.005     NE"
  },
  {
    "objectID": "analysis/2024-08-05-GTEx-sqtl-enrich.html#intersection-of-sqtls-between-new-and-old-pseudo-count",
    "href": "analysis/2024-08-05-GTEx-sqtl-enrich.html#intersection-of-sqtls-between-new-and-old-pseudo-count",
    "title": "GTEx sQTL enrichment (V4, different pseudocount)",
    "section": "intersection of sQTLs between new and old pseudo count",
    "text": "intersection of sQTLs between new and old pseudo count\n\n\n$`Adipose-Subcutaneous`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:     13778      1003      2069\n\n$`Adipose-Visceral_Omentum_`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:     11334       810      1667\n\n$AdrenalGland\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      6178       491       874\n\n$`Artery-Aorta`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      9513       718      1441\n\n$`Artery-Coronary`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      5392       489       757\n\n$`Artery-Tibial`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:     13151       862      1887\n\n$`Brain-Amygdala`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      2164       281       343\n\n$`Brain-Anteriorcingulatecortex_BA24_`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      3081       341       443\n\n$`Brain-Caudate_basalganglia_`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      4406       406       619\n\n$`Brain-CerebellarHemisphere`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      5605       442       729\n\n$`Brain-Cerebellum`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      6593       437       829\n\n$`Brain-Cortex`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      5169       421       652\n\n$`Brain-FrontalCortex_BA9_`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      4039       379       618\n\n$`Brain-Hippocampus`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      2857       365       479\n\n$`Brain-Hypothalamus`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      3541       427       543\n\n$`Brain-Nucleusaccumbens_basalganglia_`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      4474       423       710\n\n$`Brain-Putamen_basalganglia_`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      3287       395       516\n\n$`Brain-Spinalcord_cervicalc-1_`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      2728       326       399\n\n$`Brain-Substantianigra`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      1889       248       254\n\n$`Breast-MammaryTissue`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:     10227       866      1419\n\n$`Cells-Culturedfibroblasts`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:     13169       785      1705\n\n$`Cells-EBV-transformedlymphocytes`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      5516       351       692\n\n$`Colon-Sigmoid`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      8280       629      1122\n\n$`Colon-Transverse`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      9019       756      1333\n\n$`Esophagus-GastroesophagealJunction`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      8598       640      1115\n\n$`Esophagus-Mucosa`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:     10878       855      1569\n\n$`Esophagus-Muscularis`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:     11119       841      1675\n\n$`Heart-AtrialAppendage`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      8211       657      1186\n\n$`Heart-LeftVentricle`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      6080       686      1146\n\n$`Kidney-Cortex`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      1238       142       155\n\n$Liver\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      3640       338       644\n\n$Lung\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:     12709       994      1988\n\n$MinorSalivaryGland\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      4116       357       423\n\n$`Muscle-Skeletal`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:     11747       880      2081\n\n$`Nerve-Tibial`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:     14257       963      1861\n\n$Ovary\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      4851       394       577\n\n$Pancreas\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      5705       469       963\n\n$Pituitary\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      7340       574      1037\n\n$Prostate\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      6080       537       836\n\n$`Skin-NotSunExposed_Suprapubic_`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:     11898       805      1679\n\n$`Skin-SunExposed_Lowerleg_`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:     13523       958      2018\n\n$`SmallIntestine-TerminalIleum`\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      4815       449       669\n\n$Spleen\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      6638       463       825\n\n$Stomach\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      6859       634      1014\n\n$Testis\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:     16739       866      1759\n\n$Thyroid\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:     15028      1048      2161\n\n$Uterus\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      3799       305       443\n\n$Vagina\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      3656       403       568\n\n$WholeBlood\n   intersect inNewOnly inOldOnly\n       &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n1:      8567       794      2047"
  },
  {
    "objectID": "gofig/plot-fig2-unprod-splicing-by-tissue.html",
    "href": "gofig/plot-fig2-unprod-splicing-by-tissue.html",
    "title": "Figure 2 - Unproductive splicing by tissue (GTEx)",
    "section": "",
    "text": "Unproductive splicing by tissue (GTEx)"
  },
  {
    "objectID": "gofig/plot-fig2-unprod-splicing-by-tissue.html#plot-box-plot-of-unproductive-splicing-by-tissue",
    "href": "gofig/plot-fig2-unprod-splicing-by-tissue.html#plot-box-plot-of-unproductive-splicing-by-tissue",
    "title": "Figure 2 - Unproductive splicing by tissue (GTEx)",
    "section": "Plot box plot of unproductive splicing by tissue",
    "text": "Plot box plot of unproductive splicing by tissue\n\n\n\n\n\n\n\n\nFigure 1: Unproductive splicing by tissue\n\n\n\n\n\n\n\n\n\nTable 1: Median unproductive splicing ratio by tissue\n\n\n\n\n\n\n\n\n\nV1\nV2\nV3\nV4\nV5\nV6\nV7\nV8\nV9\nV10\nV11\nV12\nV13\nV14\nV15\nV16\nV17\nV18\nV19\nV20\nV21\nV22\nV23\nV24\nV25\nV26\nV27\nV28\nV29\nV30\nV31\nV32\nV33\nV34\nV35\nV36\nV37\nV38\nV39\nV40\nV41\nV42\nV43\nV44\nV45\nV46\nV47\nV48\nV49\n\n\n\n\nTESTIS\nBRNCB\nBRNCBH\nTHYROID\nPRSTTE\nNERVET\nSPLEEN\nPTTARY\nOVARY\nLUNG\nSNTTRM\nBREAST\nUTERUS\nVAGINA\nSKINNS\nADPSBO\nSKINS\nKDNCTX\nCLNSGM\nBRNCT\nESPGEL\nADPVSC\nWHLBLD\nCLNTRN\nESPMSL\nBRNHPC\nARTTBL\nSLVRYG\nBRNCDB\nBRNNAB\nBRNHPT\nSTMACH\nARTCRN\nBRNFCT\nLIVER\nBRNATG\nBRNPBG\nBRNAGD\nARTAOT\nHRTAA\nBRNSNG\nADNGLD\nBRNSPC\nESPMCS\nPNCREAS\nLCL\nHRTLV\nMUSCLSK\nFIBRBLS\n\n\n1.58%\n1.43%\n1.29%\n1.09%\n1.06%\n1.03%\n0.96%\n0.93%\n0.91%\n0.91%\n0.91%\n0.88%\n0.87%\n0.86%\n0.86%\n0.85%\n0.84%\n0.84%\n0.82%\n0.81%\n0.79%\n0.78%\n0.78%\n0.75%\n0.75%\n0.74%\n0.73%\n0.73%\n0.72%\n0.72%\n0.72%\n0.71%\n0.71%\n0.70%\n0.70%\n0.69%\n0.69%\n0.68%\n0.68%\n0.65%\n0.64%\n0.61%\n0.61%\n0.59%\n0.58%\n0.55%\n0.53%\n0.50%\n0.40%\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTable 2: Tissue Code\n\n\n\n\n\n\n\n\n\nV1\nV2\nV3\nV4\nV5\nV6\nV7\nV8\nV9\nV10\nV11\nV12\nV13\nV14\nV15\nV16\nV17\nV18\nV19\nV20\nV21\nV22\nV23\nV24\nV25\nV26\nV27\nV28\nV29\nV30\nV31\nV32\nV33\nV34\nV35\nV36\nV37\nV38\nV39\nV40\nV41\nV42\nV43\nV44\nV45\nV46\nV47\nV48\nV49\n\n\n\n\nTESTIS\nBRNCB\nBRNCBH\nTHYROID\nPRSTTE\nNERVET\nSPLEEN\nPTTARY\nOVARY\nLUNG\nSNTTRM\nBREAST\nUTERUS\nVAGINA\nSKINNS\nADPSBO\nSKINS\nKDNCTX\nCLNSGM\nBRNCT\nESPGEL\nADPVSC\nWHLBLD\nCLNTRN\nESPMSL\nBRNHPC\nARTTBL\nSLVRYG\nBRNCDB\nBRNNAB\nBRNHPT\nSTMACH\nARTCRN\nBRNFCT\nLIVER\nBRNATG\nBRNPBG\nBRNAGD\nARTAOT\nHRTAA\nBRNSNG\nADNGLD\nBRNSPC\nESPMCS\nPNCREAS\nLCL\nHRTLV\nMUSCLSK\nFIBRBLS\n\n\nTestis\nBrain-Cerebellum\nBrain-CerebellarHemisphere\nThyroid\nProstate\nNerve-Tibial\nSpleen\nPituitary\nOvary\nLung\nSmallIntestine-TerminalIleum\nBreast-MammaryTissue\nUterus\nVagina\nSkin-NotSunExposed_Suprapubic_\nAdipose-Subcutaneous\nSkin-SunExposed_Lowerleg_\nKidney-Cortex\nColon-Sigmoid\nBrain-Cortex\nEsophagus-GastroesophagealJunction\nAdipose-Visceral_Omentum_\nWholeBlood\nColon-Transverse\nEsophagus-Muscularis\nBrain-Hippocampus\nArtery-Tibial\nMinorSalivaryGland\nBrain-Caudate_basalganglia_\nBrain-Nucleusaccumbens_basalganglia_\nBrain-Hypothalamus\nStomach\nArtery-Coronary\nBrain-FrontalCortex_BA9_\nLiver\nBrain-Anteriorcingulatecortex_BA24_\nBrain-Putamen_basalganglia_\nBrain-Amygdala\nArtery-Aorta\nHeart-AtrialAppendage\nBrain-Substantianigra\nAdrenalGland\nBrain-Spinalcord_cervicalc-1_\nEsophagus-Mucosa\nPancreas\nCells-EBV-transformedlymphocytes\nHeart-LeftVentricle\nMuscle-Skeletal\nCells-Culturedfibroblasts"
  },
  {
    "objectID": "gofig/plot-fig1-SRSF-sashimi-examples.html",
    "href": "gofig/plot-fig1-SRSF-sashimi-examples.html",
    "title": "Figure 1 - Annotation of Splicing (GenomeTracks)",
    "section": "",
    "text": "Overview\nPlots for Figure 1C\nPurpose: illustrate leafcutter2 can annotate productive and unproductive introns, without the need for gencode annotation. Particularly show concordance with annotations, and additional unproductive annotations.\nData:\n\nleafcutter 2 output\nGencode annotations\nSRSF genes are with gene names SRSF[1-12]\n\n\n\nSashimi annnotation plots\n\n\n[1] \"SRSF\"\n\n\n\n\n\n\n\n\nFigure 1\n\n\n\n\n\n\n\n\n\n\n\nFigure 2\n\n\n\n\n\n\n\n\n\n\n\nFigure 3\n\n\n\n\n\n\n\n\n\n\n\nFigure 4\n\n\n\n\n\n\n\n\n\n\n\nFigure 5\n\n\n\n\n\n\n\n\n\n\n\nFigure 6\n\n\n\n\n\n\n\n\n\n\n\nFigure 7"
  },
  {
    "objectID": "gofig/plot-fig2-ds-vs-dge.html",
    "href": "gofig/plot-fig2-ds-vs-dge.html",
    "title": "Figure 2 - Differential splicing vs. differential expression (GTEx)",
    "section": "",
    "text": "Differential splicing vs. differential expression in GTEx dataset\n\n\n\n\n\n\nNotes\n\n\n\n\nUse GTEx dataset\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: Correlation of differential splicing and differential gene expression\n\n\n\n\n\n\nPick 5 groups to plot correlation\n\n\n\n\n\n\n\n\nFigure 2: Correlation of differential splicing and differential gene expression for 5 selected contrasts"
  },
  {
    "objectID": "analysis/2024-08-07-GWAS-sQTL-coloc.html",
    "href": "analysis/2024-08-07-GWAS-sQTL-coloc.html",
    "title": "Coloc GWAS - sQTL - eQTL",
    "section": "",
    "text": "Data preparation\n\n\nGWAS summary stats\nsQTL summary stats\neQTL summary stats\n\n\n\nOn a high level, eQTL or sQTL summary states are generated using qtltools nominal pass. To simplify procedure, just run 1mb cis window for all genes. Then tabix output. To reduce file size, select only phenotypes that has QTLs before running nominal pass.\nI used 1.5mb cis window to run per tissue, eqtl and sqtl nominal pass on phenotypes that have sqtl or eqtl in the repsective tissue.\n\n\n\n\n\n\nFor each GWAS hit locus, collect gwas_name, snp_id, beta, se, and:\n\ntabix all SNPs in the loci, then collect\n\ngene_id, snp_id, beta, se for eqtl (possible to have multiple gene_ids)\nintron_id, snp_id, beta, se for sqtl (possible to have multiple intron_ids) (replace intron_id with concat of gene_id and intron_id)\n\nconstruct beta matrix, where columns are gwas trait, eqtl genes, sqtl introns\nsame for SE matrix\nrun hyprcoloc"
  },
  {
    "objectID": "analysis/2024-08-07-GWAS-sQTL-coloc.html#data-prep-for-eqtl-and-sqtl",
    "href": "analysis/2024-08-07-GWAS-sQTL-coloc.html#data-prep-for-eqtl-and-sqtl",
    "title": "Coloc GWAS - sQTL - eQTL",
    "section": "",
    "text": "On a high level, eQTL or sQTL summary states are generated using qtltools nominal pass. To simplify procedure, just run 1mb cis window for all genes. Then tabix output. To reduce file size, select only phenotypes that has QTLs before running nominal pass.\nI used 1.5mb cis window to run per tissue, eqtl and sqtl nominal pass on phenotypes that have sqtl or eqtl in the repsective tissue."
  },
  {
    "objectID": "analysis/2024-08-07-GWAS-sQTL-coloc.html#gwas-eqtl-sqtl-coloc",
    "href": "analysis/2024-08-07-GWAS-sQTL-coloc.html#gwas-eqtl-sqtl-coloc",
    "title": "Coloc GWAS - sQTL - eQTL",
    "section": "",
    "text": "For each GWAS hit locus, collect gwas_name, snp_id, beta, se, and:\n\ntabix all SNPs in the loci, then collect\n\ngene_id, snp_id, beta, se for eqtl (possible to have multiple gene_ids)\nintron_id, snp_id, beta, se for sqtl (possible to have multiple intron_ids) (replace intron_id with concat of gene_id and intron_id)\n\nconstruct beta matrix, where columns are gwas trait, eqtl genes, sqtl introns\nsame for SE matrix\nrun hyprcoloc"
  },
  {
    "objectID": "analysis/2024-09-05-list-of-ds-introns-for-ben.html",
    "href": "analysis/2024-09-05-list-of-ds-introns-for-ben.html",
    "title": "List of differentially spliced junctions",
    "section": "",
    "text": "im making good progress on re-analyzing that comprative rna-seq data leafcutter2 style… but after discussing a little with yang today, we have an idea for a figure panel that would involve identifying a nice example of a conserved unproductive splice event that is also present in your GTEx cross-tissue differential splicing analysis. Can you share a list of junctions that are differentially spliced any pair of GTEx tissues that you looked at. Like, ideal would be a text file of human junction coordinates, and the tissue pairs from which the differential splicing was done, and a beta (so I can see if the direction of the effect is same in other other species)."
  },
  {
    "objectID": "analysis/2024-09-05-list-of-ds-introns-for-ben.html#clusters-selected-for-plotting-heatmaps",
    "href": "analysis/2024-09-05-list-of-ds-introns-for-ben.html#clusters-selected-for-plotting-heatmaps",
    "title": "List of differentially spliced junctions",
    "section": "Clusters selected for plotting heatmaps",
    "text": "Clusters selected for plotting heatmaps\nThe Heatmap in Figure 2 is a common set of clusters across tissues. These clusters are selected because in at least some tissues (vs. others), they showed differential splicing and differential gene expression.\nHere’s a set of chosen clusters. If a cluster has multiple UP introns, only the best one is selected (largest deltaPSI). Introns are also selected if deltaPSI and expression L2FC has different signs.\n\n\n/project/yangili1/cdai/SpliFi/data/ds_v_dge/chosen_clusters_dpsi_0_2.rds"
  },
  {
    "objectID": "analysis/2024-06-25-pyfastx-1-or-0-base.html",
    "href": "analysis/2024-06-25-pyfastx-1-or-0-base.html",
    "title": "Should leafcutter 2 be using 1 or 0 based coordinates?",
    "section": "",
    "text": "Does pyfastx use 0 or 1 based coordinates?\nanswer: pyfastx does use 1 based coordiantes for the fa.fetch() method. In addition, how stop codon and and transcripts were constructed needs scrutiny in because of how base is handled.\n\n\nCode\nimport os\nimport pyfastx\n\n\n\n\nCode\nprint(os.getcwd())\n\n\n/project/yangili1/cdai/splice-pub/analysis\n\n\n\n\nCode\nfa_file = './test.fa'\n\n\n\n\nCode\nwith open(fa_file) as f:\n  fa_text = f.readlines()\n\n\n\n\nCode\n  fa_text\n\n\n['&gt;JZ822577.1 contig1 cDNA library of flower petals in tree peony by suppression subtractive hybridization Paeonia suffruticosa cDNA, mRNA sequence\\n',\n 'CTCTAGAGATTACTTCTTCACATTCCAGATCACTCAGGCTCTTTGTCATTTTAGTTTGACTAGGATATCG\\n',\n 'AGTATTCAAGCTCATCGCTTTTGGTAATCTTTGCGGTGCATGCCTTTGCATGCTGTATTGCTGCTTCATC\\n',\n 'ATCCCCTTTGACTTGTGTGGCGGTGGCAAGACATCCGAAGAGTTAAGCGATGCTTGTCTAGTCAATTTCC\\n',\n 'CCATGTACAGAATCATTGTTGTCAATTGGTTGTTTCCTTGATGGTGAAGGGGCTTCAATACATGAGTTCC\\n',\n 'AAACTAACATTTCTTGACTAACACTTGAGGAAGAAGGACAAGGGTCCCCATGT\\n',\n '&gt;JZ822578.1 contig2 cDNA library of flower petals in tree peony by suppression subtractive hybridization Paeonia suffruticosa cDNA, mRNA sequence\\n',\n 'TACATGGGGATGGCTCCCCAACTAAGCCATTTGCAGTTCCCAATACATGACAGTATAAAAAAGATTATAT\\n',\n 'AACACAAGAACTCCATGTGGTTGTTTTTGACCTGAAGTGGGCGAAATCTTGTAGCAATGGAGCCAAATGA\\n',\n 'TCAATCTTTTCTTTCACCTACTAGTAGTGATGAAAGGTTGGAAGTTGCTGGGGATCTTTTGGAAGAGTGC\\n',\n 'TGGTTCTTTGAAAACATACTTGATAGAAAAGCGAGGATGTTGAGATGTCATTCTGACCCTTGTCCTTCTT\\n',\n 'CCTCAAGTGTTAGTCAAGAAATGTTAGTTTGGAACTCATGTATTGAAGCCCCTTCACCATCAAGGAAACA\\n',\n 'ACCAATTGACAACAATGATTCTGTACAACCAAAAGAAAGCGAATCGACTCAATCATCATCTCGCCATGGT\\n',\n 'TTGCTTCGAGCACCGTCCTTACCACCTTGTATAGGGAGAAAAGGAAGTGAACCCAGGACGAGCAAATTGA\\n',\n 'CTAGACAAGCATCGCTTAACTCTTCGGATGTCTTGCCACCGCCACACAAGTCAAAGGGGATGATGAAGCA\\n',\n 'GCAATACAGCATGCAAAGGCATGCACCTCAAAGATTACCAAAAGCGATGAGCTTGAATACTCGATATCCT\\n',\n 'AGTCAAACTAAAATGACAAAGAGCCTGAGTGATCTGGAATGTGAAGAAGT\\n']\n\n\n\n\nCode\nfa = pyfastx.Fasta(fa_file)\n\n\n\n\nCode\nfor seq in fa:\n  print(seq.name)\n  print(seq.seq)\n  print(seq.description)\n  print('\\n\\n')\n\n\nJZ822577.1\nCTCTAGAGATTACTTCTTCACATTCCAGATCACTCAGGCTCTTTGTCATTTTAGTTTGACTAGGATATCGAGTATTCAAGCTCATCGCTTTTGGTAATCTTTGCGGTGCATGCCTTTGCATGCTGTATTGCTGCTTCATCATCCCCTTTGACTTGTGTGGCGGTGGCAAGACATCCGAAGAGTTAAGCGATGCTTGTCTAGTCAATTTCCCCATGTACAGAATCATTGTTGTCAATTGGTTGTTTCCTTGATGGTGAAGGGGCTTCAATACATGAGTTCCAAACTAACATTTCTTGACTAACACTTGAGGAAGAAGGACAAGGGTCCCCATGT\nJZ822577.1 contig1 cDNA library of flower petals in tree peony by suppression subtractive hybridization Paeonia suffruticosa cDNA, mRNA sequence\n\n\n\nJZ822578.1\nTACATGGGGATGGCTCCCCAACTAAGCCATTTGCAGTTCCCAATACATGACAGTATAAAAAAGATTATATAACACAAGAACTCCATGTGGTTGTTTTTGACCTGAAGTGGGCGAAATCTTGTAGCAATGGAGCCAAATGATCAATCTTTTCTTTCACCTACTAGTAGTGATGAAAGGTTGGAAGTTGCTGGGGATCTTTTGGAAGAGTGCTGGTTCTTTGAAAACATACTTGATAGAAAAGCGAGGATGTTGAGATGTCATTCTGACCCTTGTCCTTCTTCCTCAAGTGTTAGTCAAGAAATGTTAGTTTGGAACTCATGTATTGAAGCCCCTTCACCATCAAGGAAACAACCAATTGACAACAATGATTCTGTACAACCAAAAGAAAGCGAATCGACTCAATCATCATCTCGCCATGGTTTGCTTCGAGCACCGTCCTTACCACCTTGTATAGGGAGAAAAGGAAGTGAACCCAGGACGAGCAAATTGACTAGACAAGCATCGCTTAACTCTTCGGATGTCTTGCCACCGCCACACAAGTCAAAGGGGATGATGAAGCAGCAATACAGCATGCAAAGGCATGCACCTCAAAGATTACCAAAAGCGATGAGCTTGAATACTCGATATCCTAGTCAAACTAAAATGACAAAGAGCCTGAGTGATCTGGAATGTGAAGAAGT\nJZ822578.1 contig2 cDNA library of flower petals in tree peony by suppression subtractive hybridization Paeonia suffruticosa cDNA, mRNA sequence\n\n\n\n\n\n\n\nCode\nfa.fetch('JZ822577.1', (1,6))\n\n\n'CTCTAG'\n\n\n\n\nCode\nfa.fetch('JZ822577.1', (1,6), strand = '-')\n\n\n'CTAGAG'"
  },
  {
    "objectID": "analysis/2024-06-15-GTEx-sqtl-enrich.html",
    "href": "analysis/2024-06-15-GTEx-sqtl-enrich.html",
    "title": "GTEx sQTL enrichment",
    "section": "",
    "text": "The underlying data for both the qqplot and the scatter plot are the from this procedure:\n\nMap sQTLs using permutation pass with QTLtools against leafcutter2 output. Each phenotype is an intron.\nPermpass result report a top SNP for each intron. Use the collection of these top SNPs to subset genotype VCF file.\nRun nominal pass for eQTL with expression data and the subsetted genotype VCF file. This effectively run regression analysis of each top sQTL SNP against gene expression.\n\nThen for the qqplot, I plotted the pvalue of expression regression for each productive vs. unproductive sQTLs top SNP.\nFor the scatter plot, each top SNP is the top SNP of a productive or unprodutive sQTL. X axis is SNP’s regression slope for gene expression, and Y axis is the regression slope of splicing.\nNote each sQTL is either a productive or unproductive sQTLs, and represent a intron cluster. A productive sQTL is a cluster that only have productive introns. The strongest intron is chosen to represent the cluster (instead of aggregated of all the introns).\nAn unproductive sQTL is a cluster that has both productive intron and unproductive introns with permutation pass q value &lt; 0.1. The best intron (largest top SNP slope) is chosen to represent the cluster as unproductive sQTL. Note even though the cluster is labeld as unproductive sQTL, either a productive or an unproductive intron is chosen to represent the cluster. For this reason, it may be a bit confliciting in the correlation plot.\n\nEnrichment of sQTL in eQTL pvalues\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 1\n\n\n\n\n\n\n\n\n\n\n\nFigure 2\n\n\n\n\n\n\n\n\n\n\n\nFigure 3\n\n\n\n\n\n\n\n\n\n\n\nFigure 4\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5\n\n\n\n\n\n\n\n\n\n\n\nFigure 6\n\n\n\n\n\n\n\n\n\n\n\nFigure 7\n\n\n\n\n\n\n\n\n\n\n\nFigure 8\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 9\n\n\n\n\n\n\n\n\n\n\n\nFigure 10\n\n\n\n\n\n\n\n\n\n\n\nFigure 11\n\n\n\n\n\n\n\n\n\n\n\nFigure 12\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 13\n\n\n\n\n\n\n\n\n\n\n\nFigure 14\n\n\n\n\n\n\n\n\n\n\n\nFigure 15\n\n\n\n\n\n\n\n\n\n\n\nFigure 16\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 17\n\n\n\n\n\n\n\n\n\n\n\nFigure 18\n\n\n\n\n\n\n\n\n\n\n\nFigure 19\n\n\n\n\n\n\n\n\n\n\n\nFigure 20\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 21\n\n\n\n\n\n\n\n\n\n\n\nFigure 22\n\n\n\n\n\n\n\n\n\n\n\nFigure 23\n\n\n\n\n\n\n\n\n\n\n\nFigure 24\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 25\n\n\n\n\n\n\n\n\n\n\n\nFigure 26\n\n\n\n\n\n\n\n\n\n\n\nFigure 27\n\n\n\n\n\n\n\n\n\n\n\nFigure 28\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 29\n\n\n\n\n\n\n\n\n\n\n\nFigure 30\n\n\n\n\n\n\n\n\n\n\n\nFigure 31\n\n\n\n\n\n\n\n\n\n\n\nFigure 32\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 33\n\n\n\n\n\n\n\n\n\n\n\nFigure 34\n\n\n\n\n\n\n\n\n\n\n\nFigure 35\n\n\n\n\n\n\n\n\n\n\n\nFigure 36\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 37\n\n\n\n\n\n\n\n\n\n\n\nFigure 38\n\n\n\n\n\n\n\n\n\n\n\nFigure 39\n\n\n\n\n\n\n\n\n\n\n\nFigure 40\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 41\n\n\n\n\n\n\n\n\n\n\n\nFigure 42\n\n\n\n\n\n\n\n\n\n\n\nFigure 43\n\n\n\n\n\n\n\n\n\n\n\nFigure 44\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 45\n\n\n\n\n\n\n\n\n\n\n\nFigure 46\n\n\n\n\n\n\n\n\n\n\n\nFigure 47\n\n\n\n\n\n\n\n\n\n\n\nFigure 48\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 49\n\n\n\n\n\n\n\n\nComparison of sQTL (top SNP beta) and eQTL effect size (nominal beta of same top sQTL SNP)\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 50: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 51: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 52: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 53: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 54: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 55: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 56: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 57: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 58: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 59: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 60: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 61: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 62: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 63: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 64: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 65: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 66: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 67: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 68: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 69: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 70: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 71: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 72: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 73: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 74: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 75: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 76: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 77: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 78: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 79: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 80: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 81: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 82: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 83: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 84: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 85: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 86: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 87: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 88: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 89: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 90: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 91: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 92: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 93: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 94: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 95: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 96: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 97: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 98: comparison of sQTL and eQTL effect size"
  },
  {
    "objectID": "analysis/2024-07-15-torus-input-prep.html",
    "href": "analysis/2024-07-15-torus-input-prep.html",
    "title": "TORUS input prep",
    "section": "",
    "text": "Problem with runing TORUS\n\ngetting lots of nan values in the output\nunderflow errors\npossible infinite loop?\n\n\n\nHow I run TORUS\n\ninput data file\n\nGenes are actually intron ids. Results are from qtltools, where beta and p-value are direct output but t-stat are calculated from p-value.\n\nzcat ../data/torus/torus_Liver_p-sqtl.txt.gz| head\n\nchr1_1000731_C_T_b38    chr1:941306:942135:clu_8_+:PR   0.410522    4.529243463388074   1.00142e-05\nchr1_1079456_A_G_b38    chr1:1082987:1084352:clu_1808_-:PR  -0.362335   -5.202902246877481  4.7261800000000006e-07\nchr1_1091327_C_A_b38    chr1:1090428:1091471:clu_1810_-:PR  -0.444126   -5.672460184876813  4.72455e-08\nchr1_1091327_C_A_b38    chr1:1091374:1091471:clu_1810_-:PR  0.382368    4.477479420903548   1.25005e-05\nchr1_1217733_G_A_b38    chr1:1217688:1218457:clu_1814_-:PR  0.604832    5.049136688493565   9.74565e-07\nchr1_1217733_G_A_b38    chr1:1217804:1218457:clu_1814_-:PR  -0.615276   -5.082449530379815  8.34233e-07\nchr1_1609890_C_T_b38    chr1:1642001:1642346:clu_1843_-:PR  -0.540764   -4.9038885121917    1.90325e-06\nchr1_1609890_C_T_b38    chr1:1642508:1645125:clu_1844_-:PR  1.04555 inf 1.22099e-17\nchr1_1609890_C_T_b38    chr1:1645262:1649498:clu_1844_-:PR  -0.865793   -7.730643217161971  4.64391e-13\nchr1_1724661_CGATG_C_b38    chr1:1707584:1708179:clu_1851_-:PR  -0.472149   -5.24117373691248   3.93775e-07\n\ngzip: stdout: Broken pipe\n\n\n\nSNP and gene map files.\n\nGenes are actually intron ids.\n\nzcat ../data/torus/torus_Liver_snp_map.txt.gz | head\nzcat ../data/torus/torus_Liver_gene_map.txt.gz | head\n\nchr1_1000731_C_T_b38    chr1    1000731\nchr1_1079456_A_G_b38    chr1    1079456\nchr1_1091327_C_A_b38    chr1    1091327\nchr1_1217733_G_A_b38    chr1    1217733\nchr1_1453870_A_C_b38    chr1    1453870\nchr1_1609890_C_T_b38    chr1    1609890\nchr1_1680059_G_A_b38    chr1    1680059\nchr1_1724661_CGATG_C_b38    chr1    1724661\nchr1_1737789_T_C_b38    chr1    1737789\nchr1_1706027_G_A_b38    chr1    1706027\n\ngzip: stdout: Broken pipe\nchr1:941306:942135:clu_8_+:PR   chr1    941307  942135\nchr1:1082987:1084352:clu_1808_-:PR  chr1    1082988 1084352\nchr1:1090428:1091471:clu_1810_-:PR  chr1    1090429 1091471\nchr1:1091374:1091471:clu_1810_-:PR  chr1    1091375 1091471\nchr1:1217688:1218457:clu_1814_-:PR  chr1    1217689 1218457\nchr1:1217804:1218457:clu_1814_-:PR  chr1    1217805 1218457\nchr1:1389047:1390229:clu_1835_-:UP  chr1    1389048 1390229\nchr1:1642001:1642346:clu_1843_-:PR  chr1    1642002 1642346\nchr1:1642508:1645125:clu_1844_-:PR  chr1    1642509 1645125\nchr1:1642508:1649498:clu_1844_-:UP  chr1    1642509 1649498\n\ngzip: stdout: Broken pipe\n\n\n\nSNP annotation file\n\nDownloaded from GTEx protal\n\nzcat ../data/WGS_Feature_overlap_collapsed_VEP_short_4torus.MAF01.txt.gz | head | cut -f 1-5\n\nSNP enhancer_d  promoter_d  open_chromatin_region_d promoter_flanking_region_d\nchr1_13550_G_A_b38  1   0   0   0\nchr1_14671_G_C_b38  0   0   0   0\nchr1_14677_G_A_b38  0   0   0   0\nchr1_16841_G_T_b38  0   0   0   0\nchr1_16856_A_G_b38  0   0   0   0\nchr1_17005_A_G_b38  0   0   0   0\nchr1_17147_G_A_b38  0   0   0   0\nchr1_17407_G_A_b38  0   0   0   0\nchr1_17408_C_G_b38  0   0   0   0\n\ngzip: stdout: Broken pipe\n\n\n\nRun TORUS\n\n\ntorus -est \\\n  -d ../data/torus/torus_Liver_p-sqtl.txt.gz \\\n  -smap ../data/torus/torus_Liver_snp_map.txt.gz \\\n  -gmap ../data/torus/torus_Liver_gene_map.txt.gz \\\n  -annot ../data/WGS_Feature_overlap_collapsed_VEP_short_4torus.MAF01.txt.gz &gt; ../data/torus/Liver-p-enrichment.txt\ntorus -est \\\n  -d ../data/torus/torus_Liver_u-sqtl.txt.gz \\\n  -smap ../data/torus/torus_Liver_snp_map.txt.gz \\\n  -gmap ../data/torus/torus_Liver_gene_map.txt.gz \\\n  -annot ../data/WGS_Feature_overlap_collapsed_VEP_short_4torus.MAF01.txt.gz &gt; ../data/torus/Liver-u-enrichment.txt\n\n\nResults\n\nLots of nan values in stdout and the final output. Many seems to be in infinit loop?\n\ncat ../data/torus/torus_Spleen_enrichment_p-sqtl.txt\n\n\n                Intercept     25.061        24.360     25.761\n               enhancer.1      4.669     -64709.147  64718.485\n               promoter.1     -0.001       -19.319     19.316\n  open_chromatin_region.1     -0.001       -19.539     19.536\npromoter_flanking_region.1      0.015      -209.060    209.090\n      CTCF_binding_site.1     -0.002       -26.457     26.454\n        TF_binding_site.1      4.925     -68245.675  68255.525\n    3_prime_UTR_variant.1      2.918     -40441.404  40447.240\n    5_prime_UTR_variant.1      3.661     -50737.866  50745.188\n     frameshift_variant.1     10.619     -147161.543  147182.781\n         intron_variant.1      0.054      -745.464    745.571\n       missense_variant.1      2.755     -38174.010  38179.519\nnon_coding_transcript_exon_variant.1      1.781     -24679.474  24683.035\nsplice_acceptor_variant.1     10.076     -139633.278  139653.430\n   splice_donor_variant.1      6.575     -91115.245  91128.394\n  splice_region_variant.1      5.130     -71092.879  71103.139\n            stop_gained.1      8.484     -117570.204  117587.171\n     synonymous_variant.1      4.289     -59431.429  59440.006\n\n\n\n\nTORUS instructed data format\nFrom torus\n\ninput data file\n\nSNP gene    beta     t-stat p-value\n1_30923_G_T_b37 ENSG00000227232.4   0.00399184253633977 0.0232610959574911  0.981503781647425\n1_51479_T_A_b37 ENSG00000227232.4   -0.0264207753473278 -0.101592859539226  0.919350965625195\n1_55299_C_T_b37 ENSG00000227232.4   -0.224656599916996  -0.977243563498281  0.331590265844854\n\n\nSNP annotation file\n\nSNP   binding_d\nchr1.51479  0\nchr1.52058  2\nchr1.52238  1\n\nSNP and gene map files\n\nTo control for SNP distance to TSS, TORUS requires gene TSS information and SNP position files (i.e., gene map and SNP map).\nGene map file format:\nENSG00000237683  1  139379 139379\nENSG00000237491  1  714162 714162\nENSG00000230021  1  741274 741274\nsnps map\nchr1.51479  1  51479\nchr1.52058  1  52058\nchr1.52238  1  52238\n\n\nOutput from enrichment analysis\n\nThe first column represents the annotation name and its corresponding level (for a categorical variable). The second column is the point estimate (MLE) of the log odds ratio. Columns 3-4 represent the 95% confidence interval for the corresponding point estimate.\nbinding.1      0.623         0.226      1.021\nbinding.2      1.222         0.946      1.499\n\n\nMatrixEQTL format\nSNP map file format:\nsnp chr pos\nSnp_01  chr1    721289\nSnp_02  chr1    752565\nSnp_03  chr1    777121\nSnp_04  chr1    785988\nSnp_05  chr1    792479\nSnp_06  chr1    798958\nGENE map file format:\ngeneid  chr s1  s2\nGene_01 chr1    721289  731289\nGene_02 chr1    752565  762565\nGene_03 chr1    777121  787121\nGene_04 chr1    785988  795988\nGene_05 chr1    792479  802479\nGene_06 chr1    798958  808958\nGene_07 chr1    888658  898658"
  },
  {
    "objectID": "analysis/2024-08-05-eQTL-sQTL-coloc-tally.html",
    "href": "analysis/2024-08-05-eQTL-sQTL-coloc-tally.html",
    "title": "eQTL sQTL coloc with HyprColoc tally",
    "section": "",
    "text": "Intro\nColoc using HyprColoc. Detailed procedures in ../code/workflow/rules/coloc.smk. Briefly, first collect sQTL and eQTLs with FDR = 0.1. Then get intron/gene pairs. Run nominal pass to get betas and standard errors. Then run HyprColoc on shared SNPs on each pair.\n\n\ncode\n\n\nCode\nsuppressMessages(library(tidyverse))\nsuppressMessages(library(glue))\nsuppressMessages(library(data.table))\n\n\n\n\nCode\nbase_dir = '../code/results/coloc/sqtl-eqtl/GTEx'\ncoloc_result_pat = '.*coloc-res.txt'\ncoloc_res_files = list.files(base_dir, pattern = coloc_result_pat, full.names = TRUE, recursive = TRUE)\n\ntissues = str_split(coloc_res_files, '/', simplify = T) %&gt;% .[, 7] %&gt;% unique\nnames(tissues) = tissues\ncoloc_files = map(tissues, ~coloc_res_files[str_detect(coloc_res_files, .x)]) %&gt;% \n  map(~naturalsort::naturalsort(.x))\n\ncoloc_res = imap(\n  coloc_files,\n  \\(fl, t) {\n    map_dfr(fl, ~fread(.x) %&gt;% mutate(tissue = t))\n  }\n)\n\n\n\n\nCode\ncoloc_res = map(\n  coloc_res,\n  \\(dt) {\n    intron_gene = str_split(dt$id, '\\\\|', simplify = T)\n    dt = mutate(dt, intron = intron_gene[, 1], gene = intron_gene[, 2])\n    dt = mutate(dt, itype = str_extract(intron, 'PR|UP|NE'))\n    return(dt)\n  }\n)\n\n\ncoloc_res = map(\n  coloc_res,\n  \\(dt) dt[posterior_prob &gt; 0.7]\n)\n\n\nNumber of significant coloc results per tissue with posterior probability &gt; 0.7\n\n\nCode\ncoloc_res %&gt;% \n  map(\\(dt) dt[, .(N = uniqueN(id)), by = itype])\n\n\n$Liver\n    itype     N\n   &lt;char&gt; &lt;int&gt;\n1:     PR   379\n2:     UP   154\n\n$Lung\n    itype     N\n   &lt;char&gt; &lt;int&gt;\n1:     PR  1334\n2:     UP   408\n3:     NE     1\n\n$`Muscle-Skeletal`\n    itype     N\n   &lt;char&gt; &lt;int&gt;\n1:     PR  1452\n2:     UP   441\n3:     NE     1"
  },
  {
    "objectID": "analysis/2024-08-29-HyprColoc-input-data-explained.html",
    "href": "analysis/2024-08-29-HyprColoc-input-data-explained.html",
    "title": "Shared HyprColoc GTEx input data",
    "section": "",
    "text": "Introduction\nI shared the following data set under /share/forGaoLab/GTEx_eqtl_sqtl_input_for_hyprcoloc/. Box link sent separately.\nYou will find the following folders/files:\n\nWholeBlood\nBrain-Anteriorcingulatecortex_BA24_\nGenotype\nGWAS\nPhenotype_sqtl\nHyprColoc_gwas_eQTL_sQTL.R\n\n\n\nWholeBoold & Brain-Anteriorcingulatecortex_BA24_\nThe summary stats are these files, for each chromosome. They are indexed with snp chrom, start, end, so you can use tabix to extract by locus. There are also \\*coloc\\* that you can ignore. These are my coloc results.\n\n\n../code/results/coloc/sqtl-eqtl/GTEx/WholeBlood/chr22.eqtl_nominal.txt.gz\n../code/results/coloc/sqtl-eqtl/GTEx/WholeBlood/chr22.eqtl_nominal.txt.gz.tbi\n../code/results/coloc/sqtl-eqtl/GTEx/WholeBlood/chr22.sqtl_nominal.txt.gz\n../code/results/coloc/sqtl-eqtl/GTEx/WholeBlood/chr22.sqtl_nominal.txt.gz.tbi\n\n\n\n\nGenotype\nI had extracted Genotype vcfs for each tissue. So in this folder you will find GTEx genotype vcf files for each tissue separetely. They are subset from a larger VCF file, containing only GT info for relevant samples. I must have uploaded the original VCF file to /share/forGaoLab/GTEx_Genotype/ previously. So you can use either the subset smaller VCFs or the large one.\nI also included my Rscript on how I run the coloc for your reference. Mainly, I a list of eqtl-sqtl (Gene - intronID) to subset molecular traits first. Then extract summary stats for correponding locus.\nRscript workflow/scripts/HyprColoc_gwas_eQTL_sQTL.R \\\n    resources/GWAS/hg38/AD_hitloci_1en5.bed \\\n    resources/GWAS/hg38/AD.tsv.gz  \\\n    /project/yangili1/cdai/annotations/hg38/gencode.v26.GRCh38.genes.csv \\\n    results/coloc/sqtl-eqtl/GTEx/WholeBlood \\\n    results/coloc/gwas-eqtl-sqtl/GTEx/AD/WholeBlood\n\n\n\nGWAS\nThe hg38 includes lifted and cleaned up GWAS summary stats for 4 GWAS, AD, PD, Height, and Type2 diabetes, link.\n\n*tsv.gz files are lifted and cleaned full summary stats. Indexed, so can retrieve by locus with tabix.\n*hitloci_1en5.bed are constructed 1Mb (or I may have used 1.5Mb) region flanking lead SNP. Lead snps are all &lt; 1e-5 pval.\n\n\n\nPhenotype_sqtl\nThis folder house qqnormalized files. I just copied everything from my directory. So there are files you don’t need. The ones you need are like these files:\n\n\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr10.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr11.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr12.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr13.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr14.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr15.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr16.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr17.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr18.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr19.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr1.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr20.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr21.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr22.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr2.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr3.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr4.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr5.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr6.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr7.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr8.gz\n../code/results/pheno/noisy/GTEx/WholeBlood/separateNoise/leafcutter.qqnorm_chr9.gz"
  },
  {
    "objectID": "analysis/2024-06-10-GenomeTracks.html",
    "href": "analysis/2024-06-10-GenomeTracks.html",
    "title": "Genome Tracks",
    "section": "",
    "text": "Intro"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Unproductive Splicing",
    "section": "",
    "text": "Order By\n       Default\n         \n          Date - Oldest\n        \n         \n          Date - Newest\n        \n         \n          Title\n        \n         \n          Author\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\nDate\n\n\nTitle\n\n\nAuthor\n\n\n\n\n\n\nSep 21, 2024\n\n\nFigure 2 - Heatmap of unprodoctive splicing by tissues\n\n\n \n\n\n\n\nSep 20, 2024\n\n\nFigure 1 - Unproductive splicing and gene features\n\n\n \n\n\n\n\nSep 20, 2024\n\n\nFigure 2 - Differential splicing vs. differential expression (GTEx)\n\n\n \n\n\n\n\nSep 20, 2024\n\n\nFigure 2 - Unproductive splicing by tissue (GTEx)\n\n\n \n\n\n\n\nSep 5, 2024\n\n\nList of differentially spliced junctions\n\n\n \n\n\n\n\nSep 5, 2024\n\n\nFigure 1 - Annotation of Splicing (GenomeTracks)\n\n\n \n\n\n\n\nSep 5, 2024\n\n\nFigure 1 - Annotation of Splicing (GenomeTracks)\n\n\n \n\n\n\n\nSep 2, 2024\n\n\nCheck rerun of leafcutter2 on select GTEx tissues and Geuvadis\n\n\n \n\n\n\n\nAug 29, 2024\n\n\nShared HyprColoc GTEx input data\n\n\n \n\n\n\n\nAug 21, 2024\n\n\nFigure 3 - sQTL tally, correlation heatmap\n\n\n \n\n\n\n\nAug 15, 2024\n\n\nGTEx sQTL enrichment (V4, different pseudocount)\n\n\n \n\n\n\n\nAug 15, 2024\n\n\nSummarise coloc for GWAS eQTL sQTL\n\n\n \n\n\n\n\nAug 11, 2024\n\n\nPlot heatmap of effect size correlation between eQTL and sQTL (updated new vs. old pseudo count)\n\n\n \n\n\n\n\nAug 7, 2024\n\n\nColoc GWAS - sQTL - eQTL\n\n\n \n\n\n\n\nAug 6, 2024\n\n\nProcess GWAS summary stats\n\n\n \n\n\n\n\nAug 5, 2024\n\n\neQTL sQTL coloc with HyprColoc tally\n\n\n \n\n\n\n\nJul 16, 2024\n\n\nCheck sqtl beta beta corr plot - LCL\n\n\n \n\n\n\n\nJul 16, 2024\n\n\nCheck sqtl beta beta corr plot - Liver\n\n\n \n\n\n\n\nJul 16, 2024\n\n\nCheck sqtl beta beta corr plot\n\n\n \n\n\n\n\nJul 16, 2024\n\n\nsQTL procedure\n\n\n \n\n\n\n\nJul 15, 2024\n\n\nTORUS input prep\n\n\n \n\n\n\n\nJul 11, 2024\n\n\nGTEx sQTL enrichment - updated (V4)\n\n\n \n\n\n\n\nJul 10, 2024\n\n\nGTEx sQTL enrichment - updated (V3)\n\n\n \n\n\n\n\nJun 28, 2024\n\n\noff by 1 bug\n\n\n \n\n\n\n\nJun 25, 2024\n\n\nShould leafcutter 2 be using 1 or 0 based coordinates?\n\n\n \n\n\n\n\nJun 22, 2024\n\n\nGTEx sQTL enrichment - updated (V2)\n\n\n \n\n\n\n\nJun 20, 2024\n\n\nDifferential splicing vs differential gene expression in Selected Tissue pairs\n\n\n \n\n\n\n\nJun 18, 2024\n\n\nDifferential splicing vs differential gene expression in GTEx\n\n\n \n\n\n\n\nJun 17, 2024\n\n\nUnproductive splicing ratio in GTEx across tissues\n\n\n \n\n\n\n\nJun 15, 2024\n\n\nGTEx sQTL enrichment\n\n\n \n\n\n\n\nJun 15, 2024\n\n\nGWAS list\n\n\n \n\n\n\n\nJun 10, 2024\n\n\nGenome Tracks\n\n\n \n\n\n\n\nJun 10, 2024\n\n\nQTL tally\n\n\n \n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Analysis. Data path in SpliFi/code"
  },
  {
    "objectID": "analysis/2024-06-25-bug-fix.html",
    "href": "analysis/2024-06-25-bug-fix.html",
    "title": "off by 1 bug",
    "section": "",
    "text": "All leafcutter2’s other functions are BED like coordinates like [0, 100). However, the solve_NMD function uses 3rd party packages that actually use GTF like 1 based coordinates like [1, 100].\nFor example, fetching of fasta sequence github permlink is using 1 based, even though the coordinates supplied is going to be 0 based due to input data being 0 based.\nseq = Seq(fa.fetch(chrom, (exon_coord[0],exon_coord[1])))+leftover\nOther relevant lines of codes will also need to change, like here, due to difference of [ ] vs [ ).\nfor c in stop_codons:\n        if strand == \"+\":\n            seed.append([c[1]])\n        else:\n            seed.append([c[0]])\nalso here\nhere"
  },
  {
    "objectID": "analysis/2024-06-25-bug-fix.html#solution",
    "href": "analysis/2024-06-25-bug-fix.html#solution",
    "title": "off by 1 bug",
    "section": "Solution",
    "text": "Solution\nThe solution is either change within the function, so all operations of solve_NMD are using 0-based index; or first convert all input (juncs, start, stop codons) to 1 based [], then revert back to 0 based [) for the returned juncs."
  },
  {
    "objectID": "analysis/2024-07-16-sQTL-procedure.html",
    "href": "analysis/2024-07-16-sQTL-procedure.html",
    "title": "sQTL procedure",
    "section": "",
    "text": "bed: phenotype bed file\ncov: covariate file\nvcf: genotype vcf file\n\n\n\nUsed a python script to prepare phenotype for QTLtools.\n\nintrons with missing PSI ratios from over 40% of samples are removed.\nintrons with less than 0.005 std are also removed.\nPSI values from leafcutter output are added with pseudo count of 0.5.\n\n\ncount = (float(num) + 0.5) / ((float(denom)) + 0.5)\n\n\nPSI values are quantile normalized\n\n\ndef qqnorm(x):\n    n = len(x)\n    a = 3.0 / 8.0 if n &lt;= 10 else 0.5\n    return norm.ppf((rankdata(x) - a) / (n + 1.0 - 2.0 * a))\n\n# qqnorms on the columns\nmatrix = np.array(valRows)\nfor i in range(len(matrix[0, :])):\n    matrix[:, i] = qqnorm(matrix[:, i])"
  },
  {
    "objectID": "analysis/2024-07-16-sQTL-procedure.html#phenotype-bed-file",
    "href": "analysis/2024-07-16-sQTL-procedure.html#phenotype-bed-file",
    "title": "sQTL procedure",
    "section": "",
    "text": "Used a python script to prepare phenotype for QTLtools.\n\nintrons with missing PSI ratios from over 40% of samples are removed.\nintrons with less than 0.005 std are also removed.\nPSI values from leafcutter output are added with pseudo count of 0.5.\n\n\ncount = (float(num) + 0.5) / ((float(denom)) + 0.5)\n\n\nPSI values are quantile normalized\n\n\ndef qqnorm(x):\n    n = len(x)\n    a = 3.0 / 8.0 if n &lt;= 10 else 0.5\n    return norm.ppf((rankdata(x) - a) / (n + 1.0 - 2.0 * a))\n\n# qqnorms on the columns\nmatrix = np.array(valRows)\nfor i in range(len(matrix[0, :])):\n    matrix[:, i] = qqnorm(matrix[:, i])"
  },
  {
    "objectID": "analysis/2024-06-15-GWAS-list.html",
    "href": "analysis/2024-06-15-GWAS-list.html",
    "title": "GWAS list",
    "section": "",
    "text": "Code\ngwas_path1 &lt;- \"/project/yangili1/zpmu/GWAS_loci/trait_summary.txt\"\ngwas_summ1 &lt;- fread(gwas_path1)\n\n\nUsed 54 from the following path:\n\"/project/yangili1/zpmu/GWAS_loci\"\n\n\nCode\ngwas_summ1 %&gt;% gt::gt()\n\n\n\n\n\n\n\n\nTrait\nLabel\nPMID\n\n\n\n\nAllergy and eczema\nAE\n29892013\n\n\nMultiple sclerosis\nMS\n31604244\n\n\nRheumatoid arthritis\nRA\n24390342\n\n\nAllergic disases\nAllergy\n29083406\n\n\nAdult-onset Asthma\nAsthma\n30929738\n\n\nAptopic dermatitis\nApD\n26482879\n\n\nCrohns' disease\nIIBDGC - CD\n26192919\n\n\nInflammaroty bowel disease\nIIBDGC - IBD\n26192919\n\n\nUlcerative colitis\nIIBDGC - UC\n26192919\n\n\nSystemic lupus erythematosus\nSLE\n27399966\n\n\nAsthma\nTAGC - Asthma\n29273806\n\n\nCrohns' disease\nCD\n28067908\n\n\nInflammaroty bowel disease\nIBD\n28067908\n\n\nUlcerative colitis\nUC\n28067908\n\n\nBasophil count\nBASO#\n27863252\n\n\nBasophil percentage of white cells\nBASO%\n27863252\n\n\nBasophil percentage of granulocytes\nBASO%GRAN\n27863252\n\n\nSum basophil neutrophil count\n(BASO+NEUT)#\n27863252\n\n\nSum eosinophil basophil count\n(EO+BASO)#\n27863252\n\n\nEosinophil count\nEO#\n27863252\n\n\nEosinophil percentage of white cells\nEO%\n27863252\n\n\nEosinophil percentage of granulocytes\nEO%GRAN\n27863252\n\n\nGranulocyte count\nGRAN#\n27863252\n\n\nGranulocyte percentage of myeloid white cells\nGRAN%MYELOID\n27863252\n\n\nHematocrit\nHCT\n27863252\n\n\nHemoglobin concentration\nHGB\n27863252\n\n\nHigh light scatter percentage of red cells\nHLSR%\n27863252\n\n\nHigh light scatter reticulocyte count\nHLSR#\n27863252\n\n\nImmature fraction of reticulocytes\nIRF\n27863252\n\n\nLymphocyte count\nLYMPH#\n27863252\n\n\nLymphocyte percentage of white cells\nLYMPH%\n27863252\n\n\nMean corpuscular hemoglobin concentration\nMCHC\n27863252\n\n\nMean corpuscular hemoglobin\nMCH\n27863252\n\n\nMean corpuscular volume\nMCV\n27863252\n\n\nMonocyte count\nMONO#\n27863252\n\n\nMonocyte percentage of white cells\nMONO%\n27863252\n\n\nMean platelet volume\nMPV\n27863252\n\n\nMyeloid white cell count\nMYELOID#\n27863252\n\n\nSum neutrophil eosinophil count\n(NEUT+EO)#\n27863252\n\n\nNeutrophil percentage of granulocytes\nNEUT%GRAN\n27863252\n\n\nNeutrophil count\nNEUT#\n27863252\n\n\nNeutrophil percentage of white cells\nNEUT%\n27863252\n\n\nPlateletcrit\nPCT\n27863252\n\n\nPlatelet distribution width\nPDW\n27863252\n\n\nPlatelet count\nPLT#\n27863252\n\n\nRed blood cell count\nRBC#\n27863252\n\n\nRed cell distribution width\nRDW\n27863252\n\n\nReticulocyte count\nRET#\n27863252\n\n\nReticulocyte fraction of red cells\nRET%\n27863252\n\n\nWhite blood cell count\nWBC#\n27863252\n\n\nEstimated glomerular filtration rate\neGFR\n31152163\n\n\nType 2 diabetes\nT2D\n29632382\n\n\nParkinson's disease\nPD\n31701892\n\n\nAlzheimer's disease\nAD\n30617256"
  },
  {
    "objectID": "analysis/2024-06-15-GWAS-list.html#gwas-from-phenoix",
    "href": "analysis/2024-06-15-GWAS-list.html#gwas-from-phenoix",
    "title": "GWAS list",
    "section": "",
    "text": "Code\ngwas_path1 &lt;- \"/project/yangili1/zpmu/GWAS_loci/trait_summary.txt\"\ngwas_summ1 &lt;- fread(gwas_path1)\n\n\nUsed 54 from the following path:\n\"/project/yangili1/zpmu/GWAS_loci\"\n\n\nCode\ngwas_summ1 %&gt;% gt::gt()\n\n\n\n\n\n\n\n\nTrait\nLabel\nPMID\n\n\n\n\nAllergy and eczema\nAE\n29892013\n\n\nMultiple sclerosis\nMS\n31604244\n\n\nRheumatoid arthritis\nRA\n24390342\n\n\nAllergic disases\nAllergy\n29083406\n\n\nAdult-onset Asthma\nAsthma\n30929738\n\n\nAptopic dermatitis\nApD\n26482879\n\n\nCrohns' disease\nIIBDGC - CD\n26192919\n\n\nInflammaroty bowel disease\nIIBDGC - IBD\n26192919\n\n\nUlcerative colitis\nIIBDGC - UC\n26192919\n\n\nSystemic lupus erythematosus\nSLE\n27399966\n\n\nAsthma\nTAGC - Asthma\n29273806\n\n\nCrohns' disease\nCD\n28067908\n\n\nInflammaroty bowel disease\nIBD\n28067908\n\n\nUlcerative colitis\nUC\n28067908\n\n\nBasophil count\nBASO#\n27863252\n\n\nBasophil percentage of white cells\nBASO%\n27863252\n\n\nBasophil percentage of granulocytes\nBASO%GRAN\n27863252\n\n\nSum basophil neutrophil count\n(BASO+NEUT)#\n27863252\n\n\nSum eosinophil basophil count\n(EO+BASO)#\n27863252\n\n\nEosinophil count\nEO#\n27863252\n\n\nEosinophil percentage of white cells\nEO%\n27863252\n\n\nEosinophil percentage of granulocytes\nEO%GRAN\n27863252\n\n\nGranulocyte count\nGRAN#\n27863252\n\n\nGranulocyte percentage of myeloid white cells\nGRAN%MYELOID\n27863252\n\n\nHematocrit\nHCT\n27863252\n\n\nHemoglobin concentration\nHGB\n27863252\n\n\nHigh light scatter percentage of red cells\nHLSR%\n27863252\n\n\nHigh light scatter reticulocyte count\nHLSR#\n27863252\n\n\nImmature fraction of reticulocytes\nIRF\n27863252\n\n\nLymphocyte count\nLYMPH#\n27863252\n\n\nLymphocyte percentage of white cells\nLYMPH%\n27863252\n\n\nMean corpuscular hemoglobin concentration\nMCHC\n27863252\n\n\nMean corpuscular hemoglobin\nMCH\n27863252\n\n\nMean corpuscular volume\nMCV\n27863252\n\n\nMonocyte count\nMONO#\n27863252\n\n\nMonocyte percentage of white cells\nMONO%\n27863252\n\n\nMean platelet volume\nMPV\n27863252\n\n\nMyeloid white cell count\nMYELOID#\n27863252\n\n\nSum neutrophil eosinophil count\n(NEUT+EO)#\n27863252\n\n\nNeutrophil percentage of granulocytes\nNEUT%GRAN\n27863252\n\n\nNeutrophil count\nNEUT#\n27863252\n\n\nNeutrophil percentage of white cells\nNEUT%\n27863252\n\n\nPlateletcrit\nPCT\n27863252\n\n\nPlatelet distribution width\nPDW\n27863252\n\n\nPlatelet count\nPLT#\n27863252\n\n\nRed blood cell count\nRBC#\n27863252\n\n\nRed cell distribution width\nRDW\n27863252\n\n\nReticulocyte count\nRET#\n27863252\n\n\nReticulocyte fraction of red cells\nRET%\n27863252\n\n\nWhite blood cell count\nWBC#\n27863252\n\n\nEstimated glomerular filtration rate\neGFR\n31152163\n\n\nType 2 diabetes\nT2D\n29632382\n\n\nParkinson's disease\nPD\n31701892\n\n\nAlzheimer's disease\nAD\n30617256"
  },
  {
    "objectID": "gofig/plot-fig3-pval-enrich-beta-beta.html",
    "href": "gofig/plot-fig3-pval-enrich-beta-beta.html",
    "title": "Figure 3 - sQTL tally, correlation heatmap",
    "section": "",
    "text": "Note\n\n\n\n\nsQTL top SNPs enrichment in eQTL are plotted on this page\nsQTL top SNPs eQTL beta vs. sQTL beta per tissue comparison are also on this page\nsQTL top SNPs eQTL beta vs. sQTL beta summarised heatmap is on this page"
  },
  {
    "objectID": "gofig/plot-fig3-pval-enrich-beta-beta.html#sqtl-tally-gtex",
    "href": "gofig/plot-fig3-pval-enrich-beta-beta.html#sqtl-tally-gtex",
    "title": "Figure 3 - sQTL tally, correlation heatmap",
    "section": "sQTL tally (GTEx)",
    "text": "sQTL tally (GTEx)\n\n\n\n\n\nGTEx sQTL tally"
  },
  {
    "objectID": "gofig/plot-fig3-pval-enrich-beta-beta.html#heatmap-of-eqtl-sqtl-beta-correlation",
    "href": "gofig/plot-fig3-pval-enrich-beta-beta.html#heatmap-of-eqtl-sqtl-beta-correlation",
    "title": "Figure 3 - sQTL tally, correlation heatmap",
    "section": "Heatmap of eQTL sQTL beta correlation",
    "text": "Heatmap of eQTL sQTL beta correlation\n\n\n\n\n\nHeatmap of eQTL sQTL beta correlation"
  },
  {
    "objectID": "gofig/plot-fig3-pval-enrich-beta-beta.html#sqtl-pvalue-enrichment-in-eqtl-selected-tissues",
    "href": "gofig/plot-fig3-pval-enrich-beta-beta.html#sqtl-pvalue-enrichment-in-eqtl-selected-tissues",
    "title": "Figure 3 - sQTL tally, correlation heatmap",
    "section": "sQTL pvalue enrichment in eQTL (selected tissues)",
    "text": "sQTL pvalue enrichment in eQTL (selected tissues)"
  },
  {
    "objectID": "analysis/2024-06-22-GTEx-sqtl-enrich.html",
    "href": "analysis/2024-06-22-GTEx-sqtl-enrich.html",
    "title": "GTEx sQTL enrichment - updated (V2)",
    "section": "",
    "text": "The underlying data for both the qqplot and the scatter plot are the from this procedure:\n\nMap sQTLs using permutation pass with QTLtools against leafcutter2 output. Each phenotype is an intron.\nPermpass result report a top SNP for each intron. Use the collection of these top SNPs to subset genotype VCF file.\nRun nominal pass for eQTL with expression data and the subsetted genotype VCF file. This effectively run regression analysis of each top sQTL SNP against gene expression.\n\nThen for the qqplot, I plotted the pvalue of expression regression for each productive vs. unproductive sQTLs top SNP.\nFor the scatter plot, each top SNP is the top SNP of a productive or unprodutive sQTL. X axis is SNP’s regression slope for gene expression, and Y axis is the regression slope of splicing.\nNote each sQTL is either a productive or unproductive sQTLs, and represent a intron cluster. A productive sQTL is a cluster that only have productive introns. The strongest intron is chosen to represent the cluster (instead of aggregated of all the introns).\nAn unproductive sQTL is a cluster that has both productive intron and unproductive introns with permutation pass q value &lt; 0.1. The best intron (largest top SNP slope) is chosen to represent the cluster as unproductive sQTL. Note, comparing to previous version, here for u-sQTLs (ctype = PR,UP) select the best unproductive intron to represent the cluster.\n\nEnrichment of sQTL in eQTL pvalues\n\n\n\n\n\n\nNote\n\n\n\nY axis is flipped for eqtls with negative beta.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 1\n\n\n\n\n\n\n\n\n\n\n\nFigure 2\n\n\n\n\n\n\n\n\n\n\n\nFigure 3\n\n\n\n\n\n\n\n\n\n\n\nFigure 4\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5\n\n\n\n\n\n\n\n\n\n\n\nFigure 6\n\n\n\n\n\n\n\n\n\n\n\nFigure 7\n\n\n\n\n\n\n\n\n\n\n\nFigure 8\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 9\n\n\n\n\n\n\n\n\n\n\n\nFigure 10\n\n\n\n\n\n\n\n\n\n\n\nFigure 11\n\n\n\n\n\n\n\n\n\n\n\nFigure 12\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 13\n\n\n\n\n\n\n\n\n\n\n\nFigure 14\n\n\n\n\n\n\n\n\n\n\n\nFigure 15\n\n\n\n\n\n\n\n\n\n\n\nFigure 16\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 17\n\n\n\n\n\n\n\n\n\n\n\nFigure 18\n\n\n\n\n\n\n\n\n\n\n\nFigure 19\n\n\n\n\n\n\n\n\n\n\n\nFigure 20\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 21\n\n\n\n\n\n\n\n\n\n\n\nFigure 22\n\n\n\n\n\n\n\n\n\n\n\nFigure 23\n\n\n\n\n\n\n\n\n\n\n\nFigure 24\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 25\n\n\n\n\n\n\n\n\n\n\n\nFigure 26\n\n\n\n\n\n\n\n\n\n\n\nFigure 27\n\n\n\n\n\n\n\n\n\n\n\nFigure 28\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 29\n\n\n\n\n\n\n\n\n\n\n\nFigure 30\n\n\n\n\n\n\n\n\n\n\n\nFigure 31\n\n\n\n\n\n\n\n\n\n\n\nFigure 32\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 33\n\n\n\n\n\n\n\n\n\n\n\nFigure 34\n\n\n\n\n\n\n\n\n\n\n\nFigure 35\n\n\n\n\n\n\n\n\n\n\n\nFigure 36\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 37\n\n\n\n\n\n\n\n\n\n\n\nFigure 38\n\n\n\n\n\n\n\n\n\n\n\nFigure 39\n\n\n\n\n\n\n\n\n\n\n\nFigure 40\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 41\n\n\n\n\n\n\n\n\n\n\n\nFigure 42\n\n\n\n\n\n\n\n\n\n\n\nFigure 43\n\n\n\n\n\n\n\n\n\n\n\nFigure 44\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 45\n\n\n\n\n\n\n\n\n\n\n\nFigure 46\n\n\n\n\n\n\n\n\n\n\n\nFigure 47\n\n\n\n\n\n\n\n\n\n\n\nFigure 48\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 49\n\n\n\n\n\n\n\n\nComparison of sQTL (top SNP beta) and eQTL effect size (nominal beta of same top sQTL SNP)\n\n\n\n\n\n\nNote\n\n\n\nused pearson correlation.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 50: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 51: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 52: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 53: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 54: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 55: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 56: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 57: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 58: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 59: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 60: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 61: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 62: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 63: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 64: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 65: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 66: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 67: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 68: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 69: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 70: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 71: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 72: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 73: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 74: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 75: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 76: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 77: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 78: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 79: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 80: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 81: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 82: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 83: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 84: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 85: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 86: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 87: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 88: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 89: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 90: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 91: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 92: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 93: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 94: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 95: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 96: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 97: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 98: comparison of sQTL and eQTL effect size"
  },
  {
    "objectID": "analysis/2024-07-10-GTEx-sqtl-enrich.html",
    "href": "analysis/2024-07-10-GTEx-sqtl-enrich.html",
    "title": "GTEx sQTL enrichment - updated (V3)",
    "section": "",
    "text": "The underlying data for both the qqplot and the scatter plot are the from this procedure:\n\nMap sQTLs using permutation pass with QTLtools against leafcutter2 output. Each phenotype is an intron.\nPermpass result report a top SNP for each intron. Use the collection of these top SNPs to subset genotype VCF file.\nRun nominal pass for eQTL with expression data and the subsetted genotype VCF file. This effectively run regression analysis of each top sQTL SNP against gene expression.\n\nThen for the qqplot, I plotted the pvalue of expression regression for each productive vs. unproductive sQTLs top SNP.\nFor the scatter plot, each top SNP is the top SNP of a productive or unprodutive sQTL. X axis is SNP’s regression slope for gene expression, and Y axis is the regression slope of splicing.\nNote each sQTL is either a productive or unproductive sQTLs, and represent a intron cluster. A productive sQTL is a cluster that only have productive introns. The strongest intron is chosen to represent the cluster (instead of aggregated of all the introns).\nAn unproductive sQTL is a cluster that has both productive intron and unproductive introns with permutation pass q value &lt; 0.1. The best intron (largest top SNP slope) is chosen to represent the cluster as unproductive sQTL. Note, comparing to previous version, here for u-sQTLs (ctype = PR,UP) select the best unproductive intron to represent the cluster.\n\n\n\n\n\n\nNote\n\n\n\nThis update removed the following categories of SNPs from the GTEx VEP annotation file: - enhancer_d - promoter_d - promoter_flanking_region_d For qqplot, eQTL slope + vs. - snps are separated.\n\n\n\nEnrichment of sQTL in eQTL pvalues\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 1\n\n\n\n\n\n\n\n\n\n\n\nFigure 2\n\n\n\n\n\n\n\n\n\n\n\nFigure 3\n\n\n\n\n\n\n\n\n\n\n\nFigure 4\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5\n\n\n\n\n\n\n\n\n\n\n\nFigure 6\n\n\n\n\n\n\n\n\n\n\n\nFigure 7\n\n\n\n\n\n\n\n\n\n\n\nFigure 8\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 9\n\n\n\n\n\n\n\n\n\n\n\nFigure 10\n\n\n\n\n\n\n\n\n\n\n\nFigure 11\n\n\n\n\n\n\n\n\n\n\n\nFigure 12\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 13\n\n\n\n\n\n\n\n\n\n\n\nFigure 14\n\n\n\n\n\n\n\n\n\n\n\nFigure 15\n\n\n\n\n\n\n\n\n\n\n\nFigure 16\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 17\n\n\n\n\n\n\n\n\n\n\n\nFigure 18\n\n\n\n\n\n\n\n\n\n\n\nFigure 19\n\n\n\n\n\n\n\n\n\n\n\nFigure 20\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 21\n\n\n\n\n\n\n\n\n\n\n\nFigure 22\n\n\n\n\n\n\n\n\n\n\n\nFigure 23\n\n\n\n\n\n\n\n\n\n\n\nFigure 24\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 25\n\n\n\n\n\n\n\n\n\n\n\nFigure 26\n\n\n\n\n\n\n\n\n\n\n\nFigure 27\n\n\n\n\n\n\n\n\n\n\n\nFigure 28\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 29\n\n\n\n\n\n\n\n\n\n\n\nFigure 30\n\n\n\n\n\n\n\n\n\n\n\nFigure 31\n\n\n\n\n\n\n\n\n\n\n\nFigure 32\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 33\n\n\n\n\n\n\n\n\n\n\n\nFigure 34\n\n\n\n\n\n\n\n\n\n\n\nFigure 35\n\n\n\n\n\n\n\n\n\n\n\nFigure 36\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 37\n\n\n\n\n\n\n\n\n\n\n\nFigure 38\n\n\n\n\n\n\n\n\n\n\n\nFigure 39\n\n\n\n\n\n\n\n\n\n\n\nFigure 40\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 41\n\n\n\n\n\n\n\n\n\n\n\nFigure 42\n\n\n\n\n\n\n\n\n\n\n\nFigure 43\n\n\n\n\n\n\n\n\n\n\n\nFigure 44\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 45\n\n\n\n\n\n\n\n\n\n\n\nFigure 46\n\n\n\n\n\n\n\n\n\n\n\nFigure 47\n\n\n\n\n\n\n\n\n\n\n\nFigure 48\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 49\n\n\n\n\n\n\n\n\nComparison of sQTL (top SNP beta) and eQTL effect size (nominal beta of same top sQTL SNP)\n\n\n\n\n\n\nWarning\n\n\n\n\ncorrelation is actually computed with x being eqtl and y being sqtl, though the plot is labeled the other way around.\nused pearson correlation\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 50: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 51: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 52: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 53: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 54: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 55: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 56: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 57: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 58: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 59: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 60: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 61: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 62: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 63: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 64: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 65: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 66: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 67: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 68: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 69: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 70: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 71: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 72: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 73: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 74: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 75: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 76: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 77: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 78: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 79: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 80: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 81: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 82: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 83: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 84: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 85: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 86: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 87: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 88: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 89: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 90: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 91: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 92: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 93: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 94: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 95: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 96: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 97: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 98: comparison of sQTL and eQTL effect size"
  },
  {
    "objectID": "analysis/2024-07-11-GTEx-sqtl-enrich.html",
    "href": "analysis/2024-07-11-GTEx-sqtl-enrich.html",
    "title": "GTEx sQTL enrichment - updated (V4)",
    "section": "",
    "text": "The underlying data for both the qqplot and the scatter plot are the from this procedure:\n\nMap sQTLs using permutation pass with QTLtools against leafcutter2 output. Each phenotype is an intron.\nPermpass result report a top SNP for each intron. Use the collection of these top SNPs to subset genotype VCF file.\nRun nominal pass for eQTL with expression data and the subsetted genotype VCF file. This effectively run regression analysis of each top sQTL SNP against gene expression.\n\nThen for the qqplot, I plotted the pvalue of expression regression for each productive vs. unproductive sQTLs top SNP.\nFor the scatter plot, each top SNP is the top SNP of a productive or unprodutive sQTL. X axis is SNP’s regression slope for gene expression, and Y axis is the regression slope of splicing.\nNote each sQTL is either a productive or unproductive sQTLs, and represent a intron cluster. A productive sQTL is a cluster that only have productive introns. The strongest intron is chosen to represent the cluster (instead of aggregated of all the introns).\nAn unproductive sQTL is a cluster that has both productive intron and unproductive introns with permutation pass q value &lt; 0.1. The best intron (largest top SNP slope) is chosen to represent the cluster as unproductive sQTL. Note, comparing to previous version, here for u-sQTLs (ctype = PR,UP) select the best unproductive intron to represent the cluster.\n\n\n\n\n\n\nNote\n\n\n\nThis update removed the following categories of SNPs from the GTEx VEP annotation file:\n\nenhancer_d\npromoter_d\npromoter_flanking_region_d\n\nqqplot Y axis is flipped if sQTL slope and eQTL slope are in opposite direction.\n\n\n\nEnrichment of sQTL in eQTL pvalues\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 1\n\n\n\n\n\n\n\n\n\n\n\nFigure 2\n\n\n\n\n\n\n\n\n\n\n\nFigure 3\n\n\n\n\n\n\n\n\n\n\n\nFigure 4\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5\n\n\n\n\n\n\n\n\n\n\n\nFigure 6\n\n\n\n\n\n\n\n\n\n\n\nFigure 7\n\n\n\n\n\n\n\n\n\n\n\nFigure 8\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 9\n\n\n\n\n\n\n\n\n\n\n\nFigure 10\n\n\n\n\n\n\n\n\n\n\n\nFigure 11\n\n\n\n\n\n\n\n\n\n\n\nFigure 12\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 13\n\n\n\n\n\n\n\n\n\n\n\nFigure 14\n\n\n\n\n\n\n\n\n\n\n\nFigure 15\n\n\n\n\n\n\n\n\n\n\n\nFigure 16\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 17\n\n\n\n\n\n\n\n\n\n\n\nFigure 18\n\n\n\n\n\n\n\n\n\n\n\nFigure 19\n\n\n\n\n\n\n\n\n\n\n\nFigure 20\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 21\n\n\n\n\n\n\n\n\n\n\n\nFigure 22\n\n\n\n\n\n\n\n\n\n\n\nFigure 23\n\n\n\n\n\n\n\n\n\n\n\nFigure 24\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 25\n\n\n\n\n\n\n\n\n\n\n\nFigure 26\n\n\n\n\n\n\n\n\n\n\n\nFigure 27\n\n\n\n\n\n\n\n\n\n\n\nFigure 28\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 29\n\n\n\n\n\n\n\n\n\n\n\nFigure 30\n\n\n\n\n\n\n\n\n\n\n\nFigure 31\n\n\n\n\n\n\n\n\n\n\n\nFigure 32\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 33\n\n\n\n\n\n\n\n\n\n\n\nFigure 34\n\n\n\n\n\n\n\n\n\n\n\nFigure 35\n\n\n\n\n\n\n\n\n\n\n\nFigure 36\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 37\n\n\n\n\n\n\n\n\n\n\n\nFigure 38\n\n\n\n\n\n\n\n\n\n\n\nFigure 39\n\n\n\n\n\n\n\n\n\n\n\nFigure 40\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 41\n\n\n\n\n\n\n\n\n\n\n\nFigure 42\n\n\n\n\n\n\n\n\n\n\n\nFigure 43\n\n\n\n\n\n\n\n\n\n\n\nFigure 44\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 45\n\n\n\n\n\n\n\n\n\n\n\nFigure 46\n\n\n\n\n\n\n\n\n\n\n\nFigure 47\n\n\n\n\n\n\n\n\n\n\n\nFigure 48\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 49\n\n\n\n\n\n\n\n\nComparison of sQTL (top SNP beta) and eQTL effect size (nominal beta of same top sQTL SNP)\n\n\n\n\n\n\nNote\n\n\n\n\ncor.test used pearson correlation\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 50: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 51: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 52: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 53: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 54: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 55: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 56: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 57: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 58: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 59: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 60: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 61: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 62: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 63: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 64: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 65: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 66: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 67: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 68: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 69: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 70: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 71: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 72: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 73: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 74: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 75: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 76: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 77: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 78: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 79: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 80: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 81: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 82: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 83: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 84: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 85: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 86: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 87: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 88: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 89: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 90: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 91: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 92: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 93: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 94: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 95: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 96: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 97: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 98: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\nqqplot where both same direction and different direction of sQTL and eQTL effect size are shown\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 99\n\n\n\n\n\n\n\n\n\n\n\nFigure 100\n\n\n\n\n\n\n\n\n\n\n\nFigure 101\n\n\n\n\n\n\n\n\n\n\n\nFigure 102\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 103\n\n\n\n\n\n\n\n\n\n\n\nFigure 104\n\n\n\n\n\n\n\n\n\n\n\nFigure 105\n\n\n\n\n\n\n\n\n\n\n\nFigure 106\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 107\n\n\n\n\n\n\n\n\n\n\n\nFigure 108\n\n\n\n\n\n\n\n\n\n\n\nFigure 109\n\n\n\n\n\n\n\n\n\n\n\nFigure 110\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 111\n\n\n\n\n\n\n\n\n\n\n\nFigure 112\n\n\n\n\n\n\n\n\n\n\n\nFigure 113\n\n\n\n\n\n\n\n\n\n\n\nFigure 114\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 115\n\n\n\n\n\n\n\n\n\n\n\nFigure 116\n\n\n\n\n\n\n\n\n\n\n\nFigure 117\n\n\n\n\n\n\n\n\n\n\n\nFigure 118\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 119\n\n\n\n\n\n\n\n\n\n\n\nFigure 120\n\n\n\n\n\n\n\n\n\n\n\nFigure 121\n\n\n\n\n\n\n\n\n\n\n\nFigure 122\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 123\n\n\n\n\n\n\n\n\n\n\n\nFigure 124\n\n\n\n\n\n\n\n\n\n\n\nFigure 125\n\n\n\n\n\n\n\n\n\n\n\nFigure 126\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 127\n\n\n\n\n\n\n\n\n\n\n\nFigure 128\n\n\n\n\n\n\n\n\n\n\n\nFigure 129\n\n\n\n\n\n\n\n\n\n\n\nFigure 130\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 131\n\n\n\n\n\n\n\n\n\n\n\nFigure 132\n\n\n\n\n\n\n\n\n\n\n\nFigure 133\n\n\n\n\n\n\n\n\n\n\n\nFigure 134\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 135\n\n\n\n\n\n\n\n\n\n\n\nFigure 136\n\n\n\n\n\n\n\n\n\n\n\nFigure 137\n\n\n\n\n\n\n\n\n\n\n\nFigure 138\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 139\n\n\n\n\n\n\n\n\n\n\n\nFigure 140\n\n\n\n\n\n\n\n\n\n\n\nFigure 141\n\n\n\n\n\n\n\n\n\n\n\nFigure 142\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 143\n\n\n\n\n\n\n\n\n\n\n\nFigure 144\n\n\n\n\n\n\n\n\n\n\n\nFigure 145\n\n\n\n\n\n\n\n\n\n\n\nFigure 146\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 147"
  },
  {
    "objectID": "gofig/plot-fig2-sashimi-plots.html",
    "href": "gofig/plot-fig2-sashimi-plots.html",
    "title": "Figure 1 - Annotation of Splicing (GenomeTracks)",
    "section": "",
    "text": "Overview\nPlot Figure 2E\nPlot 4-5 genes to choose from. Each gene should include:\n\ncoverage tracks for each tissue (plan for 4 tissues)\narcs on top/bottom of coverage tracks for each tissue, different colors for PR vs. UP junctions\nannotation by transcript like in Figure 1\n\nData:\n\nselect which genes to plot (strong opposite effect of ds vs. dge)\nbigwig files for each tissue (for coverage)\nlink files (for arcs)\nlink files - annotation (as triangles)\ntranscript gtf\n\n\n\nSashimi annnotation plots"
  },
  {
    "objectID": "analysis/2024-06-17-unprod-splicing-ratio-GTEx.html",
    "href": "analysis/2024-06-17-unprod-splicing-ratio-GTEx.html",
    "title": "Unproductive splicing ratio in GTEx across tissues",
    "section": "",
    "text": "Code\ntissues &lt;- dir(\"/project/yangili1/cdai/SpliFi/code/results/pheno/noisy/GTEx\")\ntissues &lt;- tissues[!str_detect(tissues, \"Bladder\")]\n\n\n\n\nCode\ncomputeUnprodRatio &lt;- function(tissue_rds) {\n\n    introns &lt;- readRDS(tissue_rds)\n    datacols &lt;- names(introns)[5:ncol(introns)]\n    # remove clu_type == N, clusters with only unproductive introns\n    introns  &lt;- introns[str_detect(clu_type, 'PR')]\n    # total reads (by sample)\n    totals &lt;- colSums(introns[, ..datacols])\n    # unproudctive reads (by sample)\n    unprod &lt;- introns[intron_type == 'UP', ..datacols] %&gt;% colSums\n    # unproductive reads / total reads\n    if (all(names(totals) == names(unprod))) {\n        unprod_ratio &lt;- round(unprod / totals, 5)\n    } else {\n        stop('samples of totals and unprod are not the same')\n    }\n\n    return(unprod_ratio)\n\n}\n\n\npoint_scale &lt;- function(x, newmin, newmax) {\n  newmax  &lt;- max(newmax)\n  newmin  &lt;- min(newmin)\n  new_range &lt;- abs(newmax - newmin) \n  old_range &lt;- abs(max(x) - min(x))\n\n  # Normalize the values between 0 and 1\n  normalized_x &lt;- (x - min(x)) / old_range\n\n  # Scale the normalized values to the new range and offset by 0.5\n  scaled_x &lt;- normalized_x * new_range + newmin\n\n  return(scaled_x)\n}\n\n\n\n\nCode\ntissues_rds &lt;- glue(\"/project/yangili1/cdai/SpliFi/data/ExtractFractions/GTEx/{tissues}.numerators_constcounts.noise_by_intron.rds\")\nnames(tissues_rds) &lt;- tissues\n\n\n\n\nCode\nratios &lt;- map(tissues_rds, computeUnprodRatio)\n\n\n\n\nCode\nratios &lt;- imap_dfr(\n    ratios,\n    \\(x, y) enframe(x, \"sample\", \"unprodRatio\") %&gt;% add_column(tissue = y)\n)\nratios  &lt;- as.data.table(ratios) %&gt;%\n    .[, .(sample, unprodRatio, nsample = uniqueN(sample)), by = tissue]\n\n\n\n\nCode\nratios[, .(median_prod_ratio = median(unprodRatio)), by = tissue][order(-median_prod_ratio)]\n\n\n                                  tissue median_prod_ratio\n 1:                               Testis          0.009140\n 2:                     Brain-Cerebellum          0.007230\n 3:           Brain-CerebellarHemisphere          0.006740\n 4:        Brain-Spinalcord_cervicalc-1_          0.006150\n 5:                              Thyroid          0.005650\n 6:                             Prostate          0.005630\n 7:                         Nerve-Tibial          0.005360\n 8:                               Spleen          0.005230\n 9:                            Pituitary          0.004970\n10:                Brain-Substantianigra          0.004820\n11:                                Ovary          0.004780\n12:                                 Lung          0.004705\n13:                        Kidney-Cortex          0.004650\n14:                    Brain-Hippocampus          0.004630\n15:         SmallIntestine-TerminalIleum          0.004630\n16:                 Breast-MammaryTissue          0.004540\n17:                               Uterus          0.004515\n18:                   Brain-Hypothalamus          0.004450\n19:       Skin-NotSunExposed_Suprapubic_          0.004310\n20:                         Brain-Cortex          0.004290\n21:                               Vagina          0.004290\n22:                 Adipose-Subcutaneous          0.004220\n23:                       Brain-Amygdala          0.004160\n24:          Brain-Putamen_basalganglia_          0.004150\n25:            Skin-SunExposed_Lowerleg_          0.004140\n26:                        Colon-Sigmoid          0.004110\n27:          Brain-Caudate_basalganglia_          0.004070\n28: Brain-Nucleusaccumbens_basalganglia_          0.004065\n29:            Adipose-Visceral_Omentum_          0.004010\n30:                     Colon-Transverse          0.003955\n31:   Esophagus-GastroesophagealJunction          0.003910\n32:  Brain-Anteriorcingulatecortex_BA24_          0.003890\n33:             Brain-FrontalCortex_BA9_          0.003820\n34:                           WholeBlood          0.003730\n35:                   MinorSalivaryGland          0.003705\n36:                 Esophagus-Muscularis          0.003690\n37:                        Artery-Tibial          0.003570\n38:                      Artery-Coronary          0.003520\n39:                              Stomach          0.003450\n40:                         Artery-Aorta          0.003440\n41:                         AdrenalGland          0.003435\n42:                Heart-AtrialAppendage          0.003400\n43:                                Liver          0.003160\n44:     Cells-EBV-transformedlymphocytes          0.003110\n45:                     Esophagus-Mucosa          0.002960\n46:                  Heart-LeftVentricle          0.002650\n47:                             Pancreas          0.002460\n48:                      Muscle-Skeletal          0.002450\n49:            Cells-Culturedfibroblasts          0.001860\n                                  tissue median_prod_ratio\n\n\nCode\nmedian_unprod_ratio_all_gtex &lt;- ratios[tissue != \"EUR\", .(median_prod_ratio = median(unprodRatio)), by = tissue\n    ][order(-median_prod_ratio)] %&gt;% \n    pull(median_prod_ratio) %&gt;% median\n\n\n\n\nCode\ntissue.labels &lt;- fread(\"/project/yangili1/cdai/splice-pub/analysis/gtex-tissue-code.csv\",\n                       header = F, col.names = c(\"tissue\", \"label\"))\n\n\n\n\nCode\ndf &lt;- ratios[, .(sample, unprodRatio, nsample, med = median(unprodRatio),rk=rank(unprodRatio, ties.method = \"first\")), by = tissue\n        ][, .(sample, unprodRatio, nsample, med, tissue = forcats::fct_reorder(tissue, -med), rk)\n        ][, .(sample, tissue, unprodRatio, nsample, med, tissuei = as.integer(tissue), rk)\n        ][, .(sample, unprodRatio, nsample, med, tissuei, rk, pointx = point_scale(rk, (tissuei - .5), tissuei+.5)), by = tissue\n        ][order(tissuei, rk)] %&gt;% \n    left_join(y = tissue.labels, by = \"tissue\")\n\n\n\n\nCode\nlabels  &lt;- df[, .(tissue, label, tissuei, nsample)] %&gt;% unique\nlabels\n\n\n                                  tissue   label tissuei nsample\n 1:                               Testis  TESTIS       1     361\n 2:                     Brain-Cerebellum   BRNCB       2     241\n 3:           Brain-CerebellarHemisphere  BRNCBH       3     215\n 4:        Brain-Spinalcord_cervicalc-1_  BRNSPC       4     159\n 5:                              Thyroid THYROID       5     653\n 6:                             Prostate  PRSTTE       6     245\n 7:                         Nerve-Tibial  NERVET       7     619\n 8:                               Spleen  SPLEEN       8     241\n 9:                            Pituitary  PTTARY       9     283\n10:                Brain-Substantianigra  BRNSNG      10     139\n11:                                Ovary   OVARY      11     180\n12:                                 Lung    LUNG      12     578\n13:                        Kidney-Cortex  KDNCTX      13      85\n14:                    Brain-Hippocampus  BRNHPC      14     197\n15:         SmallIntestine-TerminalIleum  SNTTRM      15     187\n16:                 Breast-MammaryTissue  BREAST      16     459\n17:                               Uterus  UTERUS      17     142\n18:                   Brain-Hypothalamus  BRNHPT      18     202\n19:       Skin-NotSunExposed_Suprapubic_  SKINNS      19     604\n20:                         Brain-Cortex   BRNCT      20     255\n21:                               Vagina  VAGINA      21     156\n22:                 Adipose-Subcutaneous  ADPSBO      22     663\n23:                       Brain-Amygdala  BRNAGD      23     152\n24:          Brain-Putamen_basalganglia_  BRNPBG      24     205\n25:            Skin-SunExposed_Lowerleg_   SKINS      25     701\n26:                        Colon-Sigmoid  CLNSGM      26     373\n27:          Brain-Caudate_basalganglia_  BRNCDB      27     246\n28: Brain-Nucleusaccumbens_basalganglia_  BRNNAB      28     246\n29:            Adipose-Visceral_Omentum_  ADPVSC      29     541\n30:                     Colon-Transverse  CLNTRN      30     406\n31:   Esophagus-GastroesophagealJunction  ESPGEL      31     375\n32:  Brain-Anteriorcingulatecortex_BA24_  BRNATG      32     176\n33:             Brain-FrontalCortex_BA9_  BRNFCT      33     209\n34:                           WholeBlood  WHLBLD      34     755\n35:                   MinorSalivaryGland  SLVRYG      35     162\n36:                 Esophagus-Muscularis  ESPMSL      36     515\n37:                        Artery-Tibial  ARTTBL      37     663\n38:                      Artery-Coronary  ARTCRN      38     240\n39:                              Stomach  STMACH      39     359\n40:                         Artery-Aorta  ARTAOT      40     432\n41:                         AdrenalGland  ADNGLD      41     258\n42:                Heart-AtrialAppendage   HRTAA      42     429\n43:                                Liver   LIVER      43     226\n44:     Cells-EBV-transformedlymphocytes     LCL      44     174\n45:                     Esophagus-Mucosa  ESPMCS      45     555\n46:                  Heart-LeftVentricle   HRTLV      46     432\n47:                             Pancreas PNCREAS      47     328\n48:                      Muscle-Skeletal MUSCLSK      48     803\n49:            Cells-Culturedfibroblasts FIBRBLS      49     504\n                                  tissue   label tissuei nsample\n\n\n\n\n\nCode\nlabel_x1 &lt;- function(ids) {\n    labels[tissuei == ids, label]\n}\n\nlabel_x2 &lt;- function(ids) {\n    labels[tissuei == ids, nsample] \n}\n\n\ndf %&gt;% left_join(y = tissue.labels, by = \"tissue\") %&gt;%\n      ggplot() +\n        geom_point(aes(x = pointx, y = unprodRatio), color = 'midnightblue', alpha = .1) +\n        geom_tile(aes(x = tissuei, y = med), color = 'firebrick', fill= 'firebrick', height = 5e-5, width = .9) +\n        scale_x_continuous(\n            breaks = unique(df$tissuei), \n            labels = unique(df$label),\n            expand = c(0, .5),\n            guide = guide_axis(angle = 90),\n            sec.axis = sec_axis(~., \n                                breaks = unique(df$tissuei),\n                                labels = label_x2,  \n                                guide = guide_axis(angle = 90)\n                               )\n            ) +\n        scale_y_continuous(labels = scales::percent_format(accuracy = .1)) +\n        labs(x = \"Tissue / Number of Samples\",\n            y = \"Fraction of unproductive reads\"\n            )\n\n\n\n\n\n\n\n\nFigure 1: Unproductive splicing ratio in GTEx across tissues"
  },
  {
    "objectID": "analysis/2024-06-20-GTEx-DGE-vs-DS-TissueExample.html",
    "href": "analysis/2024-06-20-GTEx-DGE-vs-DS-TissueExample.html",
    "title": "Differential splicing vs differential gene expression in Selected Tissue pairs",
    "section": "",
    "text": "This notebook produces the comparison of differential splicing and differential gene expression. Pre-processed data are under ../../SpliFi/data/ds_v_dge/{tissue2}_v_{tissue1}_data.rds\n\n\nHere, I try to compare the correlation between unproductive splicing and gene expression across all GTEx tissue pairs.\n\n\n\n\nCode\nread_contrast &lt;- function(rds, contrast, PSI = 0.1, FDR = 1e-5, selection = 'all') {\n  #' @params rds: path to rds file'\n  #' @params contrast: contrast name'\n  #' @params FDR: FDR threshold'\n  #' @params selection: 'all', 'maxClu', 'maxGene'.\n  #'                    Select all introns, max deltaPSI per cluster, or max deltaPSI per gene'\n\n\n\n  data &lt;- readRDS(rds)\n  ds &lt;- data$ds\n  dge &lt;- data$dge\n  dge_dsc &lt;- data$dge_dsc\n\n  joined_dt &lt;- inner_join(\n    x = ds[abs(deltapsi) &gt; PSI & `p.adjust` &lt; FDR & ctype %in% c('PR', 'PR,UP'), \n          .(gene_id, gene_name, intron, cluster, itype, ctype, deltapsi)],\n    y = dge[, .(gene_id, g_l2fc = log2FoldChange, g_z = stat, g_l2fcSE = lfcSE)],\n    by = 'gene_id'\n  )\n\n  if (selection == 'maxClu') {\n    # select the max deltaPSI per cluster, stratified by UP and PR.\n    joined_dt  &lt;- joined_dt[\n      , .(intron, \n          deltapsi, \n          g_l2fc,\n          g_z,\n          g_l2fcSE,\n          rk = rank(-abs(deltapsi), ties.method = \"first\")\n         ), \n      by = .(gene_id, gene_name, cluster, ctype, itype)\n    ][rk == 1, -c('rk')]\n  } else if (selection == 'maxGene') {\n    # select the max deltaPSI per gene, stratified by UP and PR.\n    joined_dt &lt;- joined_dt[\n      , .(intron,\n          deltapsi,\n          g_l2fc,\n          g_z,\n          g_l2fcSE,\n          rk = rank(-abs(deltapsi), ties.method = \"first\")\n         ), \n      by = .(gene_id, gene_name, itype)\n    ][rk == 1, -c('rk')]\n  }\n\n  # run cor.test\n  cor_res &lt;- joined_dt %&gt;% \n    split(by = 'itype') %&gt;% \n    map(~cor.test(x = .x$g_z, y = .x$deltapsi, method = 'pearson')) %&gt;% \n    imap_dfr(\n      \\(x, y) {\n        data.table(\n          cor = x$estimate,\n          p = x$`p.value`,\n          itype = y,\n          contrast = contrast)\n      }\n    )\n\n    # plot scatter plot\n    p  &lt;- joined_dt %&gt;% \n      ggplot() + \n        geom_pointdensity(aes(g_z, deltapsi), size = .5, alpha = .5) +\n        scale_color_viridis_c() + \n        geom_smooth(aes(g_z, deltapsi), method = \"lm\", formula = y~x, se = FALSE, color = 'blue', lwd = 1) +\n        geom_text(aes(x = 0,\n                      y = 0.1, \n                      label = paste(\"cor: \", round(cor, 3), \", \",\n                                    \"p. val: \", format(p, digits = 3, scientific = T), \n                                    sep = \"\")\n                      ),\n                  data = cor_res, color = 'blue', size = 4, vjust = 1) +\n        labs(x = \"DGE: Z-score\",\n             y = \"DS: deltaPSI\",\n             color = \"Num. points\", \n             title = str_wrap(str_replace_all(contrast, '_', ' '), width = 40),\n             caption = glue(\"N: {nrow(joined_dt)}, \",\n                             \"FDR: {FDR}, \",\n                             \"min |PSI|: {PSI}, \")\n            ) +\n        facet_wrap(~itype)\n\n    return(list(cor_res = cor_res, gg = p, joineddf = joined_dt))\n\n}\n\n\nLoad contrast ds, dge data.\nrds file and contrast name example:\n\n\nCode\nrds_list &lt;- dir('/project/yangili1/cdai/SpliFi/data/ds_v_dge', full.names = T, pattern = '*.rds')\nrds_list &lt;- rds_list[str_detect(rds_list, \".+ds_v_dge.+_v_.+data.rds\")]\ncontrast_list &lt;- str_split(rds_list, \"/\") %&gt;% map(., last) %&gt;% unlist %&gt;% str_remove_all('_data\\\\.rds')\n\nselected_tissue_pairs &lt;- c(\n  \"Brain-Cortex_v_Muscle-Skeletal\",\n  \"Brain-Cortex_v_Liver\",\n  \"Brain-Cortex_v_WholeBlood\"\n)\n\ncontrast_list &lt;- map_chr(selected_tissue_pairs,\n    ~contrast_list[str_detect(contrast_list, .x)])\nrds_list &lt;- map_chr(selected_tissue_pairs,\n    ~rds_list[str_detect(rds_list, .x)])\n\ncontrast_list\n\n\n[1] \"Brain-Cortex_v_Muscle-Skeletal\" \"Brain-Cortex_v_Liver\"          \n[3] \"Brain-Cortex_v_WholeBlood\"     \n\n\nCode\nrds_list\n\n\n[1] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Brain-Cortex_v_Muscle-Skeletal_data.rds\"\n[2] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Brain-Cortex_v_Liver_data.rds\"          \n[3] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Brain-Cortex_v_WholeBlood_data.rds\"     \n\n\n\n\nCode\nFDR &lt;- params$fdr\nminPSI &lt;- params$psi\n\n\nProcess all the contrast data using FDR=1e-5:\n\n\nCode\nres1 &lt;- map2(rds_list, contrast_list, read_contrast, PSI = minPSI, FDR = FDR, selection = 'maxClu')\ndf1 &lt;- map_dfr(res1, ~.x$cor_res)\n\n\n\n\nCode\nres2 &lt;- map2(rds_list, contrast_list, read_contrast, PSI = minPSI, FDR = FDR, selection = 'maxGene')\ndf2 &lt;- map_dfr(res2, ~.x$cor_res)\n\n\n\n\nCode\nres3 &lt;- map2(rds_list, contrast_list, read_contrast, PSI = minPSI, FDR = FDR, selection = 'all')\ndf3 &lt;- map_dfr(res3, ~.x$cor_res)\n\n\n\n\nCode\nggs1 &lt;- map(res1, ~.x$gg)\n\nggs1[[1]] + ggs1[[2]] + ggs1[[3]] + plot_layout(ncol = 3, guides = 'collect')\n\n\n\n\n\n\n\n\nFigure 1: Select 1 best intron per cluster\n\n\n\n\n\n\n\nCode\nggs2 &lt;- map(res2, ~.x$gg)\n\nggs2[[1]] + ggs2[[2]] + ggs2[[3]] + plot_layout(ncol = 3, guides = 'collect')\n\n\n\n\n\n\n\n\nFigure 2: Select 1 best intron per gene\n\n\n\n\n\n\n\nCode\nggs3 &lt;- map(res3, ~.x$gg)\n\nggs3[[1]] + ggs3[[2]] + ggs3[[3]] + plot_layout(ncol = 3, guides = 'collect')\n\n\n\n\n\n\n\n\nFigure 3: Select all introns in cluster\n\n\n\n\n\n\n\nCode\nres3[[1]]$joineddf %&gt;% DT::datatable()\n\n\n\n\nTable 1: joined data for selecting 1 best intron per cluster"
  },
  {
    "objectID": "analysis/2024-06-20-GTEx-DGE-vs-DS-TissueExample.html#unproductive-splicing-vs.-expression-for-all-gtex-tissue-pairs",
    "href": "analysis/2024-06-20-GTEx-DGE-vs-DS-TissueExample.html#unproductive-splicing-vs.-expression-for-all-gtex-tissue-pairs",
    "title": "Differential splicing vs differential gene expression in Selected Tissue pairs",
    "section": "",
    "text": "Here, I try to compare the correlation between unproductive splicing and gene expression across all GTEx tissue pairs.\n\n\n\n\nCode\nread_contrast &lt;- function(rds, contrast, PSI = 0.1, FDR = 1e-5, selection = 'all') {\n  #' @params rds: path to rds file'\n  #' @params contrast: contrast name'\n  #' @params FDR: FDR threshold'\n  #' @params selection: 'all', 'maxClu', 'maxGene'.\n  #'                    Select all introns, max deltaPSI per cluster, or max deltaPSI per gene'\n\n\n\n  data &lt;- readRDS(rds)\n  ds &lt;- data$ds\n  dge &lt;- data$dge\n  dge_dsc &lt;- data$dge_dsc\n\n  joined_dt &lt;- inner_join(\n    x = ds[abs(deltapsi) &gt; PSI & `p.adjust` &lt; FDR & ctype %in% c('PR', 'PR,UP'), \n          .(gene_id, gene_name, intron, cluster, itype, ctype, deltapsi)],\n    y = dge[, .(gene_id, g_l2fc = log2FoldChange, g_z = stat, g_l2fcSE = lfcSE)],\n    by = 'gene_id'\n  )\n\n  if (selection == 'maxClu') {\n    # select the max deltaPSI per cluster, stratified by UP and PR.\n    joined_dt  &lt;- joined_dt[\n      , .(intron, \n          deltapsi, \n          g_l2fc,\n          g_z,\n          g_l2fcSE,\n          rk = rank(-abs(deltapsi), ties.method = \"first\")\n         ), \n      by = .(gene_id, gene_name, cluster, ctype, itype)\n    ][rk == 1, -c('rk')]\n  } else if (selection == 'maxGene') {\n    # select the max deltaPSI per gene, stratified by UP and PR.\n    joined_dt &lt;- joined_dt[\n      , .(intron,\n          deltapsi,\n          g_l2fc,\n          g_z,\n          g_l2fcSE,\n          rk = rank(-abs(deltapsi), ties.method = \"first\")\n         ), \n      by = .(gene_id, gene_name, itype)\n    ][rk == 1, -c('rk')]\n  }\n\n  # run cor.test\n  cor_res &lt;- joined_dt %&gt;% \n    split(by = 'itype') %&gt;% \n    map(~cor.test(x = .x$g_z, y = .x$deltapsi, method = 'pearson')) %&gt;% \n    imap_dfr(\n      \\(x, y) {\n        data.table(\n          cor = x$estimate,\n          p = x$`p.value`,\n          itype = y,\n          contrast = contrast)\n      }\n    )\n\n    # plot scatter plot\n    p  &lt;- joined_dt %&gt;% \n      ggplot() + \n        geom_pointdensity(aes(g_z, deltapsi), size = .5, alpha = .5) +\n        scale_color_viridis_c() + \n        geom_smooth(aes(g_z, deltapsi), method = \"lm\", formula = y~x, se = FALSE, color = 'blue', lwd = 1) +\n        geom_text(aes(x = 0,\n                      y = 0.1, \n                      label = paste(\"cor: \", round(cor, 3), \", \",\n                                    \"p. val: \", format(p, digits = 3, scientific = T), \n                                    sep = \"\")\n                      ),\n                  data = cor_res, color = 'blue', size = 4, vjust = 1) +\n        labs(x = \"DGE: Z-score\",\n             y = \"DS: deltaPSI\",\n             color = \"Num. points\", \n             title = str_wrap(str_replace_all(contrast, '_', ' '), width = 40),\n             caption = glue(\"N: {nrow(joined_dt)}, \",\n                             \"FDR: {FDR}, \",\n                             \"min |PSI|: {PSI}, \")\n            ) +\n        facet_wrap(~itype)\n\n    return(list(cor_res = cor_res, gg = p, joineddf = joined_dt))\n\n}\n\n\nLoad contrast ds, dge data.\nrds file and contrast name example:\n\n\nCode\nrds_list &lt;- dir('/project/yangili1/cdai/SpliFi/data/ds_v_dge', full.names = T, pattern = '*.rds')\nrds_list &lt;- rds_list[str_detect(rds_list, \".+ds_v_dge.+_v_.+data.rds\")]\ncontrast_list &lt;- str_split(rds_list, \"/\") %&gt;% map(., last) %&gt;% unlist %&gt;% str_remove_all('_data\\\\.rds')\n\nselected_tissue_pairs &lt;- c(\n  \"Brain-Cortex_v_Muscle-Skeletal\",\n  \"Brain-Cortex_v_Liver\",\n  \"Brain-Cortex_v_WholeBlood\"\n)\n\ncontrast_list &lt;- map_chr(selected_tissue_pairs,\n    ~contrast_list[str_detect(contrast_list, .x)])\nrds_list &lt;- map_chr(selected_tissue_pairs,\n    ~rds_list[str_detect(rds_list, .x)])\n\ncontrast_list\n\n\n[1] \"Brain-Cortex_v_Muscle-Skeletal\" \"Brain-Cortex_v_Liver\"          \n[3] \"Brain-Cortex_v_WholeBlood\"     \n\n\nCode\nrds_list\n\n\n[1] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Brain-Cortex_v_Muscle-Skeletal_data.rds\"\n[2] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Brain-Cortex_v_Liver_data.rds\"          \n[3] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Brain-Cortex_v_WholeBlood_data.rds\"     \n\n\n\n\nCode\nFDR &lt;- params$fdr\nminPSI &lt;- params$psi\n\n\nProcess all the contrast data using FDR=1e-5:\n\n\nCode\nres1 &lt;- map2(rds_list, contrast_list, read_contrast, PSI = minPSI, FDR = FDR, selection = 'maxClu')\ndf1 &lt;- map_dfr(res1, ~.x$cor_res)\n\n\n\n\nCode\nres2 &lt;- map2(rds_list, contrast_list, read_contrast, PSI = minPSI, FDR = FDR, selection = 'maxGene')\ndf2 &lt;- map_dfr(res2, ~.x$cor_res)\n\n\n\n\nCode\nres3 &lt;- map2(rds_list, contrast_list, read_contrast, PSI = minPSI, FDR = FDR, selection = 'all')\ndf3 &lt;- map_dfr(res3, ~.x$cor_res)\n\n\n\n\nCode\nggs1 &lt;- map(res1, ~.x$gg)\n\nggs1[[1]] + ggs1[[2]] + ggs1[[3]] + plot_layout(ncol = 3, guides = 'collect')\n\n\n\n\n\n\n\n\nFigure 1: Select 1 best intron per cluster\n\n\n\n\n\n\n\nCode\nggs2 &lt;- map(res2, ~.x$gg)\n\nggs2[[1]] + ggs2[[2]] + ggs2[[3]] + plot_layout(ncol = 3, guides = 'collect')\n\n\n\n\n\n\n\n\nFigure 2: Select 1 best intron per gene\n\n\n\n\n\n\n\nCode\nggs3 &lt;- map(res3, ~.x$gg)\n\nggs3[[1]] + ggs3[[2]] + ggs3[[3]] + plot_layout(ncol = 3, guides = 'collect')\n\n\n\n\n\n\n\n\nFigure 3: Select all introns in cluster\n\n\n\n\n\n\n\nCode\nres3[[1]]$joineddf %&gt;% DT::datatable()\n\n\n\n\nTable 1: joined data for selecting 1 best intron per cluster"
  },
  {
    "objectID": "gofig/plot-fig1-unprod-splicing-vs-features.html",
    "href": "gofig/plot-fig1-unprod-splicing-vs-features.html",
    "title": "Figure 1 - Unproductive splicing and gene features",
    "section": "",
    "text": "Notes\n\n\n\n\nUse Geuvadis dataset\nPlot cluster and gene level\nUse all protein coding transcripts, instead fo only APPRIS transcripts\n\n\n\n\n\nCorrelation test of cluster level unprodctive splicing vs. most used productive intron length\n\n\n\n    Spearman's rank correlation rho\n\ndata:  up_plot_dt$intron_len and up_plot_dt$ratio\nS = 6.3321e+11, p-value &lt; 2.2e-16\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n      rho \n0.1600612 \n\n\nIntron length takes the best productive intron of a cluster.\n\n\n\n\n\n\n\n\nFigure 1: Correlation of cluster unproductive reads vs. length most used productive intron\n\n\n\n\n\n\n\n\n\n\n\n    Spearman's rank correlation rho\n\ndata:  up_plot_dt.gene$rpkm and up_plot_dt.gene$ratio\nS = 2.0103e+11, p-value &lt; 2.2e-16\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n       rho \n-0.5755929 \n\n\n\n\n\n\n\n\n\n\nFigure 2: Correlation of unproductive splicing vs. gene expression level"
  },
  {
    "objectID": "gofig/plot-fig1-unprod-splicing-vs-features.html#correlation-between-cluster-level-unproductive-splicing-vs-best-productive-intron-length",
    "href": "gofig/plot-fig1-unprod-splicing-vs-features.html#correlation-between-cluster-level-unproductive-splicing-vs-best-productive-intron-length",
    "title": "Figure 1 - Unproductive splicing and gene features",
    "section": "",
    "text": "Correlation test of cluster level unprodctive splicing vs. most used productive intron length\n\n\n\n    Spearman's rank correlation rho\n\ndata:  up_plot_dt$intron_len and up_plot_dt$ratio\nS = 6.3321e+11, p-value &lt; 2.2e-16\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n      rho \n0.1600612 \n\n\nIntron length takes the best productive intron of a cluster.\n\n\n\n\n\n\n\n\nFigure 1: Correlation of cluster unproductive reads vs. length most used productive intron"
  },
  {
    "objectID": "gofig/plot-fig1-unprod-splicing-vs-features.html#correlation-between-gene-level-unproductive-splicing-vs-gene-expression",
    "href": "gofig/plot-fig1-unprod-splicing-vs-features.html#correlation-between-gene-level-unproductive-splicing-vs-gene-expression",
    "title": "Figure 1 - Unproductive splicing and gene features",
    "section": "",
    "text": "Spearman's rank correlation rho\n\ndata:  up_plot_dt.gene$rpkm and up_plot_dt.gene$ratio\nS = 2.0103e+11, p-value &lt; 2.2e-16\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n       rho \n-0.5755929 \n\n\n\n\n\n\n\n\n\n\nFigure 2: Correlation of unproductive splicing vs. gene expression level"
  },
  {
    "objectID": "analysis/2024-09-02-Rerun-leafcutter2-on-GTEx.html",
    "href": "analysis/2024-09-02-Rerun-leafcutter2-on-GTEx.html",
    "title": "Check rerun of leafcutter2 on select GTEx tissues and Geuvadis",
    "section": "",
    "text": "A quick check of the leafcutter2 rerun on select GTEx tissues and Geuvadis.\nWhat’s being compared:\n\nleafcutter output\nmapped sqtls\n\nGTEx: Kidney-Cortex, about 90 smaples. Geuvadis, EUR 300-400 samples."
  },
  {
    "objectID": "analysis/2024-09-02-Rerun-leafcutter2-on-GTEx.html#geuvadis",
    "href": "analysis/2024-09-02-Rerun-leafcutter2-on-GTEx.html#geuvadis",
    "title": "Check rerun of leafcutter2 on select GTEx tissues and Geuvadis",
    "section": "Geuvadis",
    "text": "Geuvadis\n\n\n      chr  start    end    clu  itype strand          m\n   &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt;      &lt;num&gt;\n1:   chr1 779092 803918  clu_1     IN      +  0.3833780\n2:   chr1 804222 804775  clu_2     IN      +  0.6890080\n3:   chr1 804222 807216  clu_2     IN      +  0.4262735\n4:   chr1 807323 809657  clu_3     IN      +  0.5871314\n5:   chr1 827775 829002  clu_4     IN      + 16.0160858\n6:   chr1 827849 829002  clu_4     IN      +  0.8605898\n\n\n[1] 151119      7\n\n\n\n\n      chr  start    end    clu  itype strand          m\n   &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt;      &lt;num&gt;\n1:   chr1 779092 803918  clu_1     IN      +  0.3833780\n2:   chr1 804222 804775  clu_2     IN      +  0.6890080\n3:   chr1 804222 807216  clu_2     IN      +  0.4262735\n4:   chr1 807323 809657  clu_3     IN      +  0.5871314\n5:   chr1 827775 829002  clu_4     IN      + 16.0160858\n6:   chr1 827849 829002  clu_4     IN      +  0.8605898\n\n\n[1] 151119      7\n\n\nDoes the mean reads match for each intron?\n\n\n   Match_m      N\n    &lt;lgcl&gt;  &lt;int&gt;\n1:    TRUE 151119\n\n\nDoes the itypes match for each intron?\n\n\n    Match_itype itype.new itype.old     N     P\n         &lt;lgcl&gt;    &lt;char&gt;    &lt;char&gt; &lt;int&gt; &lt;num&gt;\n 1:       FALSE        PR        UP  8955 0.059\n 2:       FALSE        NE        UP  2826 0.019\n 3:       FALSE        UP        PR  2664 0.018\n 4:       FALSE        UP        NE  2171 0.014\n 5:       FALSE        PR        NE   979 0.006\n 6:       FALSE        NE        PR    13 0.000\n 7:        TRUE        PR        PR 92666 0.613\n 8:        TRUE        UP        UP 21224 0.140\n 9:        TRUE        IN        IN 15691 0.104\n10:        TRUE        NE        NE  3930 0.026"
  },
  {
    "objectID": "analysis/2024-09-02-Rerun-leafcutter2-on-GTEx.html#gtex",
    "href": "analysis/2024-09-02-Rerun-leafcutter2-on-GTEx.html#gtex",
    "title": "Check rerun of leafcutter2 on select GTEx tissues and Geuvadis",
    "section": "GTEx",
    "text": "GTEx\n\n\n      chr  start    end    clu  itype strand         m\n   &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt;     &lt;num&gt;\n1:   chr1 804222 804775  clu_1     IN      + 0.7882353\n2:   chr1 804222 807216  clu_1     IN      + 0.1529412\n3:   chr1 804966 807216  clu_1     IN      + 0.1764706\n4:   chr1 829104 841199  clu_2     IN      + 1.8117647\n5:   chr1 829104 847653  clu_2     IN      + 6.6352941\n6:   chr1 829104 851926  clu_2     IN      + 6.7058824\n\n\n[1] 101166      7\n\n\n\n\n      chr  start    end    clu  itype strand         m\n   &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt;     &lt;num&gt;\n1:   chr1 804222 804775  clu_1     IN      + 0.7882353\n2:   chr1 804222 807216  clu_1     IN      + 0.1529412\n3:   chr1 804966 807216  clu_1     IN      + 0.1764706\n4:   chr1 829104 841199  clu_2     IN      + 1.8117647\n5:   chr1 829104 847653  clu_2     IN      + 6.6352941\n6:   chr1 829104 851926  clu_2     IN      + 6.7058824\n\n\n[1] 101166      7\n\n\nDoes the mean reads match for each intron?\n\n\n   Match_m      N\n    &lt;lgcl&gt;  &lt;int&gt;\n1:    TRUE 101166\n\n\nDoes the itypes match for each intron?\n\n\n    Match_itype itype.new itype.old     N     P\n         &lt;lgcl&gt;    &lt;char&gt;    &lt;char&gt; &lt;int&gt; &lt;num&gt;\n 1:       FALSE        PR        UP  2834 0.028\n 2:       FALSE        UP        PR  2615 0.026\n 3:       FALSE        NE        UP   370 0.004\n 4:       FALSE        UP        NE    28 0.000\n 5:       FALSE        PR        NE    11 0.000\n 6:       FALSE        NE        PR     1 0.000\n 7:        TRUE        PR        PR 75361 0.745\n 8:        TRUE        UP        UP 13420 0.133\n 9:        TRUE        IN        IN  6275 0.062\n10:        TRUE        NE        NE   251 0.002"
  },
  {
    "objectID": "analysis/2024-09-02-Rerun-leafcutter2-on-GTEx.html#geuvadis-1",
    "href": "analysis/2024-09-02-Rerun-leafcutter2-on-GTEx.html#geuvadis-1",
    "title": "Check rerun of leafcutter2 on select GTEx tissues and Geuvadis",
    "section": "Geuvadis",
    "text": "Geuvadis\n\n\n    itype     N     P\n   &lt;char&gt; &lt;int&gt; &lt;num&gt;\n1:     IN 11660 0.092\n2:     NE  5312 0.042\n3:     PR 88233 0.694\n4:     UP 21848 0.172\n\n\n    itype     N     P\n   &lt;char&gt; &lt;int&gt; &lt;num&gt;\n1:     IN 11756 0.090\n2:     NE  5953 0.045\n3:     PR 83826 0.639\n4:     UP 29665 0.226"
  },
  {
    "objectID": "analysis/2024-09-02-Rerun-leafcutter2-on-GTEx.html#gtex-1",
    "href": "analysis/2024-09-02-Rerun-leafcutter2-on-GTEx.html#gtex-1",
    "title": "Check rerun of leafcutter2 on select GTEx tissues and Geuvadis",
    "section": "GTEx",
    "text": "GTEx\n\n\n    itype     N     P\n   &lt;char&gt; &lt;int&gt; &lt;num&gt;\n1:     IN  5056 0.057\n2:     NE   501 0.006\n3:     PR 69169 0.778\n4:     UP 14177 0.159\n\n\n    itype     N     P\n   &lt;char&gt; &lt;int&gt; &lt;num&gt;\n1:     IN  5056 0.057\n2:     NE   221 0.002\n3:     PR 68989 0.776\n4:     UP 14637 0.165"
  },
  {
    "objectID": "gofig/plot-fig2-heatmap.html",
    "href": "gofig/plot-fig2-heatmap.html",
    "title": "Figure 2 - Heatmap of unprodoctive splicing by tissues",
    "section": "",
    "text": "Heatmap of PSI of unproductive splicing for introns that are commonly differentially spliced across tissues."
  },
  {
    "objectID": "analysis/2024-06-18-GTEx-DGE-vs-DS.html",
    "href": "analysis/2024-06-18-GTEx-DGE-vs-DS.html",
    "title": "Differential splicing vs differential gene expression in GTEx",
    "section": "",
    "text": "This notebook produces the comparison of differential splicing and differential gene expression. Pre-processed data are under ../../SpliFi/data/ds_v_dge/{tissue2}_v_{tissue1}_data.rds\n\n\n\n\nSaved RDS file is a list of 3 objects: - ds : differential splicing results - dge : differential gene expression results - dge_dsc : metadata for dge results\n\n\nCode\ncontrast &lt;- \"Brain-Cortex_v_Muscle-Skeletal\"\ndata &lt;- readRDS(glue('/project/yangili1/cdai/SpliFi/data/ds_v_dge/{contrast}_data.rds'))\n\nds &lt;- data$ds\ndge &lt;- data$dge\n\n\nds:\n\n\nCode\nhead(ds) %&gt;% gt::gt()\n\n\n\n\n\n\n\n\nintron\ncluster\nitype\nctype\ngene_name\ngene_id\nlogef\nMuscle-Skeletal\nBrain-Cortex\ndeltapsi\nstatus\nloglr\ndf\np\np.adjust\n\n\n\n\nchr1:930336:931038:clu_11_+\nchr1:clu_11_+\nPR\nPR\nSAMD11\nENSG00000187634.11\n0.001370763\n0.5276685\n0.5283518\n0.0006832305\nSuccess\n0.0001028596\n1\n0.9885564\n0.9923067\n\n\nchr1:931089:935771:clu_11_+\nchr1:clu_11_+\nPR\nPR\nSAMD11\nENSG00000187634.11\n-0.001370763\n0.4723315\n0.4716482\n-0.0006832305\nSuccess\n0.0001028596\n1\n0.9885564\n0.9923067\n\n\nchr1:939129:939271:clu_12_+\nchr1:clu_12_+\nPR\nPR\nSAMD11\nENSG00000187634.11\n0.033612392\n0.3507898\n0.3662486\n0.0154587644\nSuccess\n0.0288890045\n1\n0.8100430\n0.8467780\n\n\nchr1:939129:939274:clu_12_+\nchr1:clu_12_+\nPR\nPR\nSAMD11\nENSG00000187634.11\n-0.033612392\n0.6492102\n0.6337514\n-0.0154587644\nSuccess\n0.0288890045\n1\n0.8100430\n0.8467780\n\n\nchr1:939412:941143:clu_13_+\nchr1:clu_13_+\nPR\nPR\nSAMD11\nENSG00000187634.11\n-0.022419411\n0.2376936\n0.2324409\n-0.0052526823\nSuccess\n1.3652655309\n2\n0.2553129\n0.3191507\n\n\nchr1:941306:942135:clu_13_+\nchr1:clu_13_+\nPR\nPR\nSAMD11\nENSG00000187634.11\n-0.165432662\n0.4241880\n0.3595370\n-0.0646509809\nSuccess\n1.3652655309\n2\n0.2553129\n0.3191507\n\n\n\n\n\n\n\ndge:\n\n\nCode\nhead(dge) %&gt;% gt::gt()\n\n\n\n\n\n\n\n\ngene_id\nbaseMean\nlog2FoldChange\nlfcSE\nstat\npvalue\npadj\n\n\n\n\nENSG00000109061.9\n264709.904\n-13.54712\n0.2173014\n-62.34253\n0\n0\n\n\nENSG00000168530.15\n109266.143\n-13.36231\n0.1923248\n-69.47785\n0\n0\n\n\nENSG00000125414.18\n209656.455\n-13.35553\n0.2288908\n-58.34893\n0\n0\n\n\nENSG00000250978.5\n1478.281\n-13.28802\n0.3241620\n-40.99192\n0\n0\n\n\nENSG00000116748.21\n14974.113\n-13.21024\n0.2008433\n-65.77385\n0\n0\n\n\nENSG00000159173.18\n145207.909\n-13.10009\n0.2499607\n-52.40861\n0\n0\n\n\n\n\n\n\n\nCode\nprint(data$dge_dsc)\n\n\n[1] \"mean of normalized counts for all samples\"                     \n[2] \"log2 fold change (MLE): tissue Brain.Cortex vs Muscle.Skeletal\"\n[3] \"standard error: tissue Brain.Cortex vs Muscle.Skeletal\"        \n[4] \"Wald statistic: tissue Brain.Cortex vs Muscle.Skeletal\"        \n[5] \"Wald test p-value: tissue Brain.Cortex vs Muscle.Skeletal\"     \n[6] \"BH adjusted p-values\"                                          \n\n\n\n\n\nMainly to join ds and dge dataset on gene_id.\nIntrons from ds tables are selected using: - abs(deltapsi) &gt; .1 : to filter out introns with small deltaPSI - p.adjust &lt; FDR : to filter out introns with high FDR - ctype %in% c('PR', 'PR,UP') : introns are either productive or unproductive\n\n\nCode\ntissues &lt;- str_split(contrast, \"_v_\") %&gt;% unlist # follow tissue2_v_tissue1\n\n# confirm ds contrast\nconfirm_level_ds &lt;- all(names(data$ds)[c(9, 8)] == tissues)\n\n# confirm dge contrast\nconfirm_level_dge &lt;- str_detect(str_split(data$dge_dsc[2], \"tissue \")[[1]][[2]] %&gt;% str_replace_all(\"\\\\.\", \"-\"),\n                                glue(\"{tissues[1]} vs {tissues[2]}\")\n                                )\n\nif (confirm_level_dge & confirm_level_ds) {\n  message(\"Confirmed tissue order\")\n} else {\n  stop(\"Tissue order not confirmed\")\n}\n\n\nConfirmed tissue order\n\n\n\n\nCode\nFDR &lt;- params$fdr\n\nds[`p.adjust` &lt; FDR & ctype %in% c('PR', 'PR,UP')\n  ][,.(intron, deltapsi, itype)] %&gt;% unique %&gt;% \n  ggplot() + stat_ecdf(aes(x=abs(deltapsi), color=itype)) +\n    scale_color_brewer(type = \"qual\", palette = 2, direction = -1, label = c(PR=\"Productive\", UP=\"Unproductive\"), name = NULL) +\n    labs(title = glue(\"{contrast}\")) +\n    scale_x_sqrt(name = \"abs(deltaPSI)\")\n\n\n\n\n\n\n\n\nFigure 1: Distribution of deltaPSI in Brain-Cortex vs Muscle-Skeletal\n\n\n\n\n\nJoined ds and dge tables on gene_id.\n\n\nCode\njoined_dt &lt;- inner_join(\n  x = ds[abs(deltapsi) &gt; .1 & `p.adjust` &lt; FDR & ctype %in% c('PR', 'PR,UP'), \n        .(gene_id, gene_name, intron, cluster, itype, ctype, deltapsi)],\n  y = dge[, .(gene_id, g_l2fc = log2FoldChange, g_z = stat, g_l2fcSE = lfcSE)],\n  by = 'gene_id'\n  )\n\n\nQuick look of the joined table\n\n\nCode\njoined_dt %&gt;% head %&gt;% gt::gt()\n\n\n\n\n\n\n\n\ngene_id\ngene_name\nintron\ncluster\nitype\nctype\ndeltapsi\ng_l2fc\ng_z\ng_l2fcSE\n\n\n\n\nENSG00000188157.14\nAGRN\nchr1:1051815:1051992:clu_22_+\nchr1:clu_22_+\nPR\nPR\n0.4048714\n3.570754\n45.75627\n0.07803857\n\n\nENSG00000188157.14\nAGRN\nchr1:1051815:1053752:clu_22_+\nchr1:clu_22_+\nPR\nPR\n-0.3365948\n3.570754\n45.75627\n0.07803857\n\n\nENSG00000158286.12\nRNF207\nchr1:6212733:6213065:clu_111_+\nchr1:clu_111_+\nPR\nPR,UP\n-0.7185528\n1.907734\n16.39761\n0.11634224\n\n\nENSG00000158286.12\nRNF207\nchr1:6212903:6213065:clu_111_+\nchr1:clu_111_+\nUP\nPR,UP\n0.7185528\n1.907734\n16.39761\n0.11634224\n\n\nENSG00000171735.18\nCAMTA1\nchr1:7747781:7749770:clu_131_+\nchr1:clu_131_+\nPR\nPR\n0.3256170\n1.330244\n21.12208\n0.06297885\n\n\nENSG00000171735.18\nCAMTA1\nchr1:7747781:7751198:clu_131_+\nchr1:clu_131_+\nPR\nPR\n-0.6950003\n1.330244\n21.12208\n0.06297885\n\n\n\n\n\n\n\nCode\ndim(joined_dt)\n\n\n[1] 3603   10\n\n\nCode\njoined_dt[, .(Ngene = uniqueN(gene_id), Nintron = uniqueN(intron))]\n\n\n   Ngene Nintron\n1:  1650    3603\n\n\n\n\n\nCompute correlation between intron’s deltaPSI and gene’s log2FC\nNote for some reason quarto does not refresh the output of this cell, result is not correct!\n\n\nCode\ncor_res &lt;- joined_dt %&gt;% \n  split(by = 'itype') %&gt;% \n  map(~cor.test(x = .x$g_z, y = .x$deltapsi, method = 'p')) %&gt;% \n  imap_dfr(\n    \\(x, y) {\n      data.table(\n        cor = x$estimate,\n        p = x$`p.value`,\n        itype = y)\n    }\n  )\n\ncor_res \n\n\n           cor          p itype\n1:  0.02569642 0.14315331    PR\n2: -0.13544088 0.01062843    UP\n\n\n\n\n\n\n\nCode\njoined_dt %&gt;% \n  ggplot() +\n    geom_pointdensity(aes(g_z, deltapsi), size = .5, ) +\n    scale_color_viridis_c() + \n    geom_smooth(aes(g_z, deltapsi), method = \"lm\", formula = y~x, se = FALSE) +\n    labs(title = glue(\"{title}\", title = str_replace(contrast, \"_v_\", \" vs \")), \n         x = \"DGE: Log2FC (z)\",\n         y = \"deltaPSI\") +\n    facet_wrap(~itype, scales = \"free\")\n\n\n\n\n\n\n\n\nFigure 2: Correlation between deltaPSI and log2FC in Brain-Cortex vs Muscle-Skeletal\n\n\n\n\n\n\n\n\n\nHere, I try to compare the correlation between unproductive splicing and gene expression across all GTEx tissue pairs.\n\n\n\n\nCode\nread_contrast &lt;- function(rds, contrast, FDR = 1e-5, selection = 'all') {\n  #' @params rds: path to rds file'\n  #' @params contrast: contrast name'\n  #' @params FDR: FDR threshold'\n  #' @params selection: 'all', 'maxClu', 'maxGene'.\n  #'                    Select all introns, max deltaPSI per cluster, or max deltaPSI per gene'\n\n\n\n  data &lt;- readRDS(rds)\n  ds &lt;- data$ds\n  dge &lt;- data$dge\n  dge_dsc &lt;- data$dge_dsc\n\n  joined_dt &lt;- inner_join(\n    x = ds[abs(deltapsi) &gt; .1 & `p.adjust` &lt; FDR & ctype %in% c('PR', 'PR,UP'), \n          .(gene_id, gene_name, intron, cluster, itype, ctype, deltapsi)],\n    y = dge[, .(gene_id, g_l2fc = log2FoldChange, g_z = stat, g_l2fcSE = lfcSE)],\n    by = 'gene_id'\n  )\n\n  if (selection == 'maxClu') {\n    joined_dt  &lt;- joined_dt[\n      , .(intron, deltapsi, g_l2fc, g_z, g_l2fcSE, rk = rank(-abs(deltapsi), ties.method = \"random\")), \n      by = .(gene_id, gene_name, cluster, itype, ctype)\n      ][rk == 1, -c('rk')]\n  } else if (selection == 'maxGene') {\n    joined_dt &lt;- joined_dt[\n      , .(intron, deltapsi, g_l2fc, g_z, g_l2fcSE, rk = rank(-abs(deltapsi), ties.method = \"random\")), \n      by = .(gene_id, gene_name, itype)\n      ][rk == 1, -c('rk')]\n  }\n\n  # run cor.test\n  cor_res &lt;- joined_dt %&gt;% \n    split(by = 'itype') %&gt;% \n    map(~cor.test(x = .x$g_z, y = .x$deltapsi, method = 'pearson')) %&gt;% \n    imap_dfr(\n      \\(x, y) {\n        data.table(\n          cor = x$estimate,\n          p = x$`p.value`,\n          itype = y,\n          contrast = contrast)\n      }\n    )\n\n    # plot scatter plot\n    p  &lt;- joined_dt %&gt;% \n      ggplot() + \n        geom_pointdensity(aes(g_z, deltapsi), size = .5, alpha = .5) +\n        scale_color_viridis_c() + \n        geom_smooth(aes(g_z, deltapsi), method = \"lm\", formula = y~x, se = FALSE, color = 'blue', lwd = 1) +\n        geom_text(aes(x = 0,\n                      y = 0.1, \n                      label = paste(\"cor: \", round(cor, 3), \", \",\n                                    \"p. val: \", format(p, digits = 3, scientific = T), \n                                    sep = \"\")\n                      ),\n                  data = cor_res, color = 'blue', size = 4, vjust = 1) +\n        labs(x = \"DGE: Z-score\", y = \"DS: deltaPSI\", color = \"Num. points\", \n             title = str_wrap(str_replace_all(contrast, '_', ' '), width = 40)) +\n        facet_wrap(~itype)\n\n    return(list(cor_res = cor_res, gg = p, joineddf = joined_dt))\n\n}\n\n\nLoad contrast ds, dge data.\nrds file and contrast name example:\n\n\nCode\nrds_list &lt;- dir('/project/yangili1/cdai/SpliFi/data/ds_v_dge', full.names = T, pattern = '*.rds')\nrds_list &lt;- rds_list[str_detect(rds_list, \".+ds_v_dge.+_v_.+data.rds\")]\ncontrast_list &lt;- str_split(rds_list, \"/\") %&gt;% map(., last) %&gt;% unlist %&gt;% str_remove_all('_data\\\\.rds')\n\n\nhead(rds_list)\n\n\n[1] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_AdrenalGland_data.rds\"                       \n[2] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Artery-Coronary_data.rds\"                    \n[3] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-Amygdala_data.rds\"                     \n[4] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-Anteriorcingulatecortex_BA24__data.rds\"\n[5] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-Caudate_basalganglia__data.rds\"        \n[6] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-CerebellarHemisphere_data.rds\"         \n\n\nCode\nhead(contrast_list)\n\n\n[1] \"Adipose-Visceral_Omentum__v_AdrenalGland\"                       \n[2] \"Adipose-Visceral_Omentum__v_Artery-Coronary\"                    \n[3] \"Adipose-Visceral_Omentum__v_Brain-Amygdala\"                     \n[4] \"Adipose-Visceral_Omentum__v_Brain-Anteriorcingulatecortex_BA24_\"\n[5] \"Adipose-Visceral_Omentum__v_Brain-Caudate_basalganglia_\"        \n[6] \"Adipose-Visceral_Omentum__v_Brain-CerebellarHemisphere\"         \n\n\n\n\nCode\nFDR &lt;- params$fdr\n\n\nProcess all the contrast data using FDR=1e-5:\n\n\nCode\nres &lt;- map2(rds_list, contrast_list, read_contrast, FDR = 1e-5, selection = 'maxClu')\ndf &lt;- map_dfr(res, ~.x$cor_res)\n\n\n\n\nCode\nres3 &lt;- map2(rds_list, contrast_list, read_contrast, FDR = 1e-5, selection = 'all')\ndf3 &lt;- map_dfr(res3, ~.x[['cor_res']])\n\n\n\n\n\n\n\nCode\ngg3 &lt;- df3 %&gt;% \n  ggplot() + geom_pointdensity(aes(cor, -log10(p), color = itype), size = .5, alpha = .9) +\n  scale_color_brewer(type = \"qual\", \n                     palette = 1,\n                     direction = 1,\n                     label = c(PR=\"Productive\", UP=\"Unproductive\"),\n                     name = NULL) +\n  lims(x = c(-.5, .2), y = c(0, 30)) +\n  geom_hline(yintercept = -log10(0.001), linetype = 2) +\n    labs(title = 'Correlation between differential gene\\nexpression and diffferential splicing',\n         x = 'Correlation',\n         y = '-log10(p-value)'\n         )\ngg3\n\n\nWarning: Removed 3 rows containing non-finite values (`stat_pointdensity()`).\n\n\n\n\n\n\n\n\nFigure 3: Correlation between deltaPSI and expression log2FC for all GTEx tissue pairs\n\n\n\n\n\n\n\n\n\n\nCode\nid_to_plot &lt;- map_chr(res, ~.x$cor_res[, contrast] %&gt;% unique) %&gt;% \n  str_detect(., \"Brain-Cortex_v_Muscle-Skeletal\") %&gt;% \n  which\ngg &lt;- pluck(res, id_to_plot) %&gt;% pluck('gg')\ngg\n\n\n\n\n\n\n\n\nFigure 4: Correlation between deltaPSI and expression log2FC in Brain-Cortex vs Muscle-Skeletal"
  },
  {
    "objectID": "analysis/2024-06-18-GTEx-DGE-vs-DS.html#brain-cortex_v_muscle-skeletal",
    "href": "analysis/2024-06-18-GTEx-DGE-vs-DS.html#brain-cortex_v_muscle-skeletal",
    "title": "Differential splicing vs differential gene expression in GTEx",
    "section": "",
    "text": "Saved RDS file is a list of 3 objects: - ds : differential splicing results - dge : differential gene expression results - dge_dsc : metadata for dge results\n\n\nCode\ncontrast &lt;- \"Brain-Cortex_v_Muscle-Skeletal\"\ndata &lt;- readRDS(glue('/project/yangili1/cdai/SpliFi/data/ds_v_dge/{contrast}_data.rds'))\n\nds &lt;- data$ds\ndge &lt;- data$dge\n\n\nds:\n\n\nCode\nhead(ds) %&gt;% gt::gt()\n\n\n\n\n\n\n\n\nintron\ncluster\nitype\nctype\ngene_name\ngene_id\nlogef\nMuscle-Skeletal\nBrain-Cortex\ndeltapsi\nstatus\nloglr\ndf\np\np.adjust\n\n\n\n\nchr1:930336:931038:clu_11_+\nchr1:clu_11_+\nPR\nPR\nSAMD11\nENSG00000187634.11\n0.001370763\n0.5276685\n0.5283518\n0.0006832305\nSuccess\n0.0001028596\n1\n0.9885564\n0.9923067\n\n\nchr1:931089:935771:clu_11_+\nchr1:clu_11_+\nPR\nPR\nSAMD11\nENSG00000187634.11\n-0.001370763\n0.4723315\n0.4716482\n-0.0006832305\nSuccess\n0.0001028596\n1\n0.9885564\n0.9923067\n\n\nchr1:939129:939271:clu_12_+\nchr1:clu_12_+\nPR\nPR\nSAMD11\nENSG00000187634.11\n0.033612392\n0.3507898\n0.3662486\n0.0154587644\nSuccess\n0.0288890045\n1\n0.8100430\n0.8467780\n\n\nchr1:939129:939274:clu_12_+\nchr1:clu_12_+\nPR\nPR\nSAMD11\nENSG00000187634.11\n-0.033612392\n0.6492102\n0.6337514\n-0.0154587644\nSuccess\n0.0288890045\n1\n0.8100430\n0.8467780\n\n\nchr1:939412:941143:clu_13_+\nchr1:clu_13_+\nPR\nPR\nSAMD11\nENSG00000187634.11\n-0.022419411\n0.2376936\n0.2324409\n-0.0052526823\nSuccess\n1.3652655309\n2\n0.2553129\n0.3191507\n\n\nchr1:941306:942135:clu_13_+\nchr1:clu_13_+\nPR\nPR\nSAMD11\nENSG00000187634.11\n-0.165432662\n0.4241880\n0.3595370\n-0.0646509809\nSuccess\n1.3652655309\n2\n0.2553129\n0.3191507\n\n\n\n\n\n\n\ndge:\n\n\nCode\nhead(dge) %&gt;% gt::gt()\n\n\n\n\n\n\n\n\ngene_id\nbaseMean\nlog2FoldChange\nlfcSE\nstat\npvalue\npadj\n\n\n\n\nENSG00000109061.9\n264709.904\n-13.54712\n0.2173014\n-62.34253\n0\n0\n\n\nENSG00000168530.15\n109266.143\n-13.36231\n0.1923248\n-69.47785\n0\n0\n\n\nENSG00000125414.18\n209656.455\n-13.35553\n0.2288908\n-58.34893\n0\n0\n\n\nENSG00000250978.5\n1478.281\n-13.28802\n0.3241620\n-40.99192\n0\n0\n\n\nENSG00000116748.21\n14974.113\n-13.21024\n0.2008433\n-65.77385\n0\n0\n\n\nENSG00000159173.18\n145207.909\n-13.10009\n0.2499607\n-52.40861\n0\n0\n\n\n\n\n\n\n\nCode\nprint(data$dge_dsc)\n\n\n[1] \"mean of normalized counts for all samples\"                     \n[2] \"log2 fold change (MLE): tissue Brain.Cortex vs Muscle.Skeletal\"\n[3] \"standard error: tissue Brain.Cortex vs Muscle.Skeletal\"        \n[4] \"Wald statistic: tissue Brain.Cortex vs Muscle.Skeletal\"        \n[5] \"Wald test p-value: tissue Brain.Cortex vs Muscle.Skeletal\"     \n[6] \"BH adjusted p-values\"                                          \n\n\n\n\n\nMainly to join ds and dge dataset on gene_id.\nIntrons from ds tables are selected using: - abs(deltapsi) &gt; .1 : to filter out introns with small deltaPSI - p.adjust &lt; FDR : to filter out introns with high FDR - ctype %in% c('PR', 'PR,UP') : introns are either productive or unproductive\n\n\nCode\ntissues &lt;- str_split(contrast, \"_v_\") %&gt;% unlist # follow tissue2_v_tissue1\n\n# confirm ds contrast\nconfirm_level_ds &lt;- all(names(data$ds)[c(9, 8)] == tissues)\n\n# confirm dge contrast\nconfirm_level_dge &lt;- str_detect(str_split(data$dge_dsc[2], \"tissue \")[[1]][[2]] %&gt;% str_replace_all(\"\\\\.\", \"-\"),\n                                glue(\"{tissues[1]} vs {tissues[2]}\")\n                                )\n\nif (confirm_level_dge & confirm_level_ds) {\n  message(\"Confirmed tissue order\")\n} else {\n  stop(\"Tissue order not confirmed\")\n}\n\n\nConfirmed tissue order\n\n\n\n\nCode\nFDR &lt;- params$fdr\n\nds[`p.adjust` &lt; FDR & ctype %in% c('PR', 'PR,UP')\n  ][,.(intron, deltapsi, itype)] %&gt;% unique %&gt;% \n  ggplot() + stat_ecdf(aes(x=abs(deltapsi), color=itype)) +\n    scale_color_brewer(type = \"qual\", palette = 2, direction = -1, label = c(PR=\"Productive\", UP=\"Unproductive\"), name = NULL) +\n    labs(title = glue(\"{contrast}\")) +\n    scale_x_sqrt(name = \"abs(deltaPSI)\")\n\n\n\n\n\n\n\n\nFigure 1: Distribution of deltaPSI in Brain-Cortex vs Muscle-Skeletal\n\n\n\n\n\nJoined ds and dge tables on gene_id.\n\n\nCode\njoined_dt &lt;- inner_join(\n  x = ds[abs(deltapsi) &gt; .1 & `p.adjust` &lt; FDR & ctype %in% c('PR', 'PR,UP'), \n        .(gene_id, gene_name, intron, cluster, itype, ctype, deltapsi)],\n  y = dge[, .(gene_id, g_l2fc = log2FoldChange, g_z = stat, g_l2fcSE = lfcSE)],\n  by = 'gene_id'\n  )\n\n\nQuick look of the joined table\n\n\nCode\njoined_dt %&gt;% head %&gt;% gt::gt()\n\n\n\n\n\n\n\n\ngene_id\ngene_name\nintron\ncluster\nitype\nctype\ndeltapsi\ng_l2fc\ng_z\ng_l2fcSE\n\n\n\n\nENSG00000188157.14\nAGRN\nchr1:1051815:1051992:clu_22_+\nchr1:clu_22_+\nPR\nPR\n0.4048714\n3.570754\n45.75627\n0.07803857\n\n\nENSG00000188157.14\nAGRN\nchr1:1051815:1053752:clu_22_+\nchr1:clu_22_+\nPR\nPR\n-0.3365948\n3.570754\n45.75627\n0.07803857\n\n\nENSG00000158286.12\nRNF207\nchr1:6212733:6213065:clu_111_+\nchr1:clu_111_+\nPR\nPR,UP\n-0.7185528\n1.907734\n16.39761\n0.11634224\n\n\nENSG00000158286.12\nRNF207\nchr1:6212903:6213065:clu_111_+\nchr1:clu_111_+\nUP\nPR,UP\n0.7185528\n1.907734\n16.39761\n0.11634224\n\n\nENSG00000171735.18\nCAMTA1\nchr1:7747781:7749770:clu_131_+\nchr1:clu_131_+\nPR\nPR\n0.3256170\n1.330244\n21.12208\n0.06297885\n\n\nENSG00000171735.18\nCAMTA1\nchr1:7747781:7751198:clu_131_+\nchr1:clu_131_+\nPR\nPR\n-0.6950003\n1.330244\n21.12208\n0.06297885\n\n\n\n\n\n\n\nCode\ndim(joined_dt)\n\n\n[1] 3603   10\n\n\nCode\njoined_dt[, .(Ngene = uniqueN(gene_id), Nintron = uniqueN(intron))]\n\n\n   Ngene Nintron\n1:  1650    3603\n\n\n\n\n\nCompute correlation between intron’s deltaPSI and gene’s log2FC\nNote for some reason quarto does not refresh the output of this cell, result is not correct!\n\n\nCode\ncor_res &lt;- joined_dt %&gt;% \n  split(by = 'itype') %&gt;% \n  map(~cor.test(x = .x$g_z, y = .x$deltapsi, method = 'p')) %&gt;% \n  imap_dfr(\n    \\(x, y) {\n      data.table(\n        cor = x$estimate,\n        p = x$`p.value`,\n        itype = y)\n    }\n  )\n\ncor_res \n\n\n           cor          p itype\n1:  0.02569642 0.14315331    PR\n2: -0.13544088 0.01062843    UP\n\n\n\n\n\n\n\nCode\njoined_dt %&gt;% \n  ggplot() +\n    geom_pointdensity(aes(g_z, deltapsi), size = .5, ) +\n    scale_color_viridis_c() + \n    geom_smooth(aes(g_z, deltapsi), method = \"lm\", formula = y~x, se = FALSE) +\n    labs(title = glue(\"{title}\", title = str_replace(contrast, \"_v_\", \" vs \")), \n         x = \"DGE: Log2FC (z)\",\n         y = \"deltaPSI\") +\n    facet_wrap(~itype, scales = \"free\")\n\n\n\n\n\n\n\n\nFigure 2: Correlation between deltaPSI and log2FC in Brain-Cortex vs Muscle-Skeletal"
  },
  {
    "objectID": "analysis/2024-06-18-GTEx-DGE-vs-DS.html#unproductive-splicing-vs.-expression-for-all-gtex-tissue-pairs",
    "href": "analysis/2024-06-18-GTEx-DGE-vs-DS.html#unproductive-splicing-vs.-expression-for-all-gtex-tissue-pairs",
    "title": "Differential splicing vs differential gene expression in GTEx",
    "section": "",
    "text": "Here, I try to compare the correlation between unproductive splicing and gene expression across all GTEx tissue pairs.\n\n\n\n\nCode\nread_contrast &lt;- function(rds, contrast, FDR = 1e-5, selection = 'all') {\n  #' @params rds: path to rds file'\n  #' @params contrast: contrast name'\n  #' @params FDR: FDR threshold'\n  #' @params selection: 'all', 'maxClu', 'maxGene'.\n  #'                    Select all introns, max deltaPSI per cluster, or max deltaPSI per gene'\n\n\n\n  data &lt;- readRDS(rds)\n  ds &lt;- data$ds\n  dge &lt;- data$dge\n  dge_dsc &lt;- data$dge_dsc\n\n  joined_dt &lt;- inner_join(\n    x = ds[abs(deltapsi) &gt; .1 & `p.adjust` &lt; FDR & ctype %in% c('PR', 'PR,UP'), \n          .(gene_id, gene_name, intron, cluster, itype, ctype, deltapsi)],\n    y = dge[, .(gene_id, g_l2fc = log2FoldChange, g_z = stat, g_l2fcSE = lfcSE)],\n    by = 'gene_id'\n  )\n\n  if (selection == 'maxClu') {\n    joined_dt  &lt;- joined_dt[\n      , .(intron, deltapsi, g_l2fc, g_z, g_l2fcSE, rk = rank(-abs(deltapsi), ties.method = \"random\")), \n      by = .(gene_id, gene_name, cluster, itype, ctype)\n      ][rk == 1, -c('rk')]\n  } else if (selection == 'maxGene') {\n    joined_dt &lt;- joined_dt[\n      , .(intron, deltapsi, g_l2fc, g_z, g_l2fcSE, rk = rank(-abs(deltapsi), ties.method = \"random\")), \n      by = .(gene_id, gene_name, itype)\n      ][rk == 1, -c('rk')]\n  }\n\n  # run cor.test\n  cor_res &lt;- joined_dt %&gt;% \n    split(by = 'itype') %&gt;% \n    map(~cor.test(x = .x$g_z, y = .x$deltapsi, method = 'pearson')) %&gt;% \n    imap_dfr(\n      \\(x, y) {\n        data.table(\n          cor = x$estimate,\n          p = x$`p.value`,\n          itype = y,\n          contrast = contrast)\n      }\n    )\n\n    # plot scatter plot\n    p  &lt;- joined_dt %&gt;% \n      ggplot() + \n        geom_pointdensity(aes(g_z, deltapsi), size = .5, alpha = .5) +\n        scale_color_viridis_c() + \n        geom_smooth(aes(g_z, deltapsi), method = \"lm\", formula = y~x, se = FALSE, color = 'blue', lwd = 1) +\n        geom_text(aes(x = 0,\n                      y = 0.1, \n                      label = paste(\"cor: \", round(cor, 3), \", \",\n                                    \"p. val: \", format(p, digits = 3, scientific = T), \n                                    sep = \"\")\n                      ),\n                  data = cor_res, color = 'blue', size = 4, vjust = 1) +\n        labs(x = \"DGE: Z-score\", y = \"DS: deltaPSI\", color = \"Num. points\", \n             title = str_wrap(str_replace_all(contrast, '_', ' '), width = 40)) +\n        facet_wrap(~itype)\n\n    return(list(cor_res = cor_res, gg = p, joineddf = joined_dt))\n\n}\n\n\nLoad contrast ds, dge data.\nrds file and contrast name example:\n\n\nCode\nrds_list &lt;- dir('/project/yangili1/cdai/SpliFi/data/ds_v_dge', full.names = T, pattern = '*.rds')\nrds_list &lt;- rds_list[str_detect(rds_list, \".+ds_v_dge.+_v_.+data.rds\")]\ncontrast_list &lt;- str_split(rds_list, \"/\") %&gt;% map(., last) %&gt;% unlist %&gt;% str_remove_all('_data\\\\.rds')\n\n\nhead(rds_list)\n\n\n[1] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_AdrenalGland_data.rds\"                       \n[2] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Artery-Coronary_data.rds\"                    \n[3] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-Amygdala_data.rds\"                     \n[4] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-Anteriorcingulatecortex_BA24__data.rds\"\n[5] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-Caudate_basalganglia__data.rds\"        \n[6] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-CerebellarHemisphere_data.rds\"         \n\n\nCode\nhead(contrast_list)\n\n\n[1] \"Adipose-Visceral_Omentum__v_AdrenalGland\"                       \n[2] \"Adipose-Visceral_Omentum__v_Artery-Coronary\"                    \n[3] \"Adipose-Visceral_Omentum__v_Brain-Amygdala\"                     \n[4] \"Adipose-Visceral_Omentum__v_Brain-Anteriorcingulatecortex_BA24_\"\n[5] \"Adipose-Visceral_Omentum__v_Brain-Caudate_basalganglia_\"        \n[6] \"Adipose-Visceral_Omentum__v_Brain-CerebellarHemisphere\"         \n\n\n\n\nCode\nFDR &lt;- params$fdr\n\n\nProcess all the contrast data using FDR=1e-5:\n\n\nCode\nres &lt;- map2(rds_list, contrast_list, read_contrast, FDR = 1e-5, selection = 'maxClu')\ndf &lt;- map_dfr(res, ~.x$cor_res)\n\n\n\n\nCode\nres3 &lt;- map2(rds_list, contrast_list, read_contrast, FDR = 1e-5, selection = 'all')\ndf3 &lt;- map_dfr(res3, ~.x[['cor_res']])\n\n\n\n\n\n\n\nCode\ngg3 &lt;- df3 %&gt;% \n  ggplot() + geom_pointdensity(aes(cor, -log10(p), color = itype), size = .5, alpha = .9) +\n  scale_color_brewer(type = \"qual\", \n                     palette = 1,\n                     direction = 1,\n                     label = c(PR=\"Productive\", UP=\"Unproductive\"),\n                     name = NULL) +\n  lims(x = c(-.5, .2), y = c(0, 30)) +\n  geom_hline(yintercept = -log10(0.001), linetype = 2) +\n    labs(title = 'Correlation between differential gene\\nexpression and diffferential splicing',\n         x = 'Correlation',\n         y = '-log10(p-value)'\n         )\ngg3\n\n\nWarning: Removed 3 rows containing non-finite values (`stat_pointdensity()`).\n\n\n\n\n\n\n\n\nFigure 3: Correlation between deltaPSI and expression log2FC for all GTEx tissue pairs\n\n\n\n\n\n\n\n\n\n\nCode\nid_to_plot &lt;- map_chr(res, ~.x$cor_res[, contrast] %&gt;% unique) %&gt;% \n  str_detect(., \"Brain-Cortex_v_Muscle-Skeletal\") %&gt;% \n  which\ngg &lt;- pluck(res, id_to_plot) %&gt;% pluck('gg')\ngg\n\n\n\n\n\n\n\n\nFigure 4: Correlation between deltaPSI and expression log2FC in Brain-Cortex vs Muscle-Skeletal"
  },
  {
    "objectID": "analysis/2024-07-16-sQTL-beta-beta-plot-check-LCL.html",
    "href": "analysis/2024-07-16-sQTL-beta-beta-plot-check-LCL.html",
    "title": "Check sqtl beta beta corr plot - LCL",
    "section": "",
    "text": "Check sqtl beta beta corr plot\n\n\n[1] \"../smk-plots/gtex-sqtl-enrichment-v4/Cells-EBV-transformedlymphocytes-scatter.png\"\n[2] \"../smk-plots/gtex-sqtl-enrichment-v4/Liver-scatter.png\"                           \n[3] \"../smk-plots/gtex-sqtl-enrichment-v4/WholeBlood-scatter.png\"                      \n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 2: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 3: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\nTake a closer look at whole blood\nConsider selecting random intron for PR also try random selection for UP\n\n\nRemoved 105 transcriptional snps\n\n\n\n\nWarning: Transformation introduced infinite values in continuous x-axis\n\n\nWarning: Removed 327 rows containing non-finite values (`stat_ecdf()`).\n\n\n\n\n\n\n\n\n\nRemove introns with low read counts (less than 10 reads).\n\n\n[1] \"Number of sQTLs removed due to low read counts:\"\n\n\n   ctype    N\n1: PR,UP  174\n2:    PR 1078\n\n\n[1] \"Number of sQTLs remaining:\"\n\n\n   ctype   N\n1:    PR 786\n2: PR,UP 653\n\n\nCorrelation test for Cells-EBV-transformedlymphocytes:\nOriginal:\n\n\n          ctype         pval   estimate xpos ypos\nPR   Productive 1.022677e-05 -0.1551985    0    0\nUP Unproductive 1.278154e-17 -0.3239933    0    0\n\n\nsplit by intron bins:\n\n\n    ctype binsbyMean   N\n 1:    PR      (0,1] 168\n 2:    PR      (1,2] 130\n 3:    PR      (2,5] 255\n 4:    PR     (5,10] 248\n 5:    PR    (10,20] 238\n 6:    PR    (20,50] 309\n 7:    PR   (50,100] 205\n 8:    PR  (100,Inf] 338\n 9: PR,UP      (0,1] 151\n10: PR,UP      (1,2] 126\n11: PR,UP      (2,5] 237\n12: PR,UP     (5,10] 147\n13: PR,UP    (10,20]  98\n14: PR,UP    (20,50]  58\n15: PR,UP   (50,100]  12\n16: PR,UP  (100,Inf]   6\n\n\n\n\n\n\n\n\n\n\n\nbefore removing low reads\n\n\n\n\n\n\n\n\n\nafter removing low reads\n\n\n\n\n\n\n\nFigure 4: Beta beta correlation plot for Cells-EBV-transformedlymphocytes:\n\n\n\n\n\n$`(0,1]`\n          ctype         pval   estimate xpos ypos\nPR   Productive 1.254156e-07 -0.3940962    0    0\nUP Unproductive 1.159352e-06 -0.3836414    0    0\n\n$`(1,2]`\n          ctype       pval     estimate xpos ypos\nUP Unproductive 0.02402581 -0.200991146    0    0\nPR   Productive 0.92858376 -0.007937331    0    0\n\n$`(10,20]`\n          ctype       pval     estimate xpos ypos\nUP Unproductive 0.01042595 -0.257659300    0    0\nPR   Productive 0.92471101  0.006157967    0    0\n\n$`(100,Inf]`\n          ctype       pval   estimate xpos ypos\nPR   Productive 0.39343452 0.04656646    0    0\nUP Unproductive 0.08579947 0.75021041    0    0\n\n$`(2,5]`\n          ctype         pval   estimate xpos ypos\nPR   Productive 9.594439e-04 -0.2055858    0    0\nUP Unproductive 1.568447e-08 -0.3569761    0    0\n\n$`(20,50]`\n          ctype       pval    estimate xpos ypos\nPR   Productive 0.67153749  0.02421734    0    0\nUP Unproductive 0.02685682 -0.29067908    0    0\n\n$`(5,10]`\n          ctype         pval   estimate xpos ypos\nPR   Productive 0.8150535088  0.0149280    0    0\nUP Unproductive 0.0002438611 -0.2982141    0    0\n\n$`(50,100]`\n          ctype      pval    estimate xpos ypos\nPR   Productive 0.2844609  0.07511026    0    0\nUP Unproductive 0.8289487 -0.06996110    0    0"
  },
  {
    "objectID": "analysis/2024-07-16-sQTL-beta-beta-plot-check-WholeBlood.html",
    "href": "analysis/2024-07-16-sQTL-beta-beta-plot-check-WholeBlood.html",
    "title": "Check sqtl beta beta corr plot",
    "section": "",
    "text": "Check sqtl beta beta corr plot\n\n\n[1] \"../smk-plots/gtex-sqtl-enrichment-v4/Cells-EBV-transformedlymphocytes-scatter.png\"\n[2] \"../smk-plots/gtex-sqtl-enrichment-v4/Liver-scatter.png\"                           \n[3] \"../smk-plots/gtex-sqtl-enrichment-v4/WholeBlood-scatter.png\"                      \n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 2: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\n\n\n\nFigure 3: comparison of sQTL and eQTL effect size\n\n\n\n\n\n\n\n\nTake a closer look at whole blood\nConsider selecting random intron for PR also try random selection for UP\n\n\nRemoved 208 transcriptional snps\n\n\n\n\nWarning: Transformation introduced infinite values in continuous x-axis\n\n\nWarning: Removed 1430 rows containing non-finite values (`stat_ecdf()`).\n\n\n\n\n\n\n\n\n\nRemove introns with low read counts (less than 10 reads).\n\n\n[1] \"Number of sQTLs removed due to low read counts:\"\n\n\n   ctype    N\n1:    PR 1162\n2: PR,UP  174\n\n\n[1] \"Number of sQTLs remaining:\"\n\n\n   ctype    N\n1: PR,UP 1291\n2:    PR 1763\n\n\nCorrelation test for WholeBlood:\nOriginal:\n\n\n          ctype         pval  estimate xpos ypos\nUP Unproductive 6.552652e-21 -0.255785    0    0\nPR   Productive 8.060112e-32 -0.272386    0    0\n\n\nsplit by intron bins:\n\n\n    ctype binsbyMean   N\n 1:    PR      (0,1] 710\n 2:    PR      (1,2] 300\n 3:    PR      (2,5] 444\n 4:    PR     (5,10] 336\n 5:    PR    (10,20] 291\n 6:    PR    (20,50] 388\n 7:    PR   (50,100] 183\n 8:    PR  (100,Inf] 313\n 9: PR,UP      (0,1] 621\n10: PR,UP      (1,2] 277\n11: PR,UP      (2,5] 287\n12: PR,UP     (5,10] 118\n13: PR,UP    (10,20]  86\n14: PR,UP    (20,50]  59\n15: PR,UP   (50,100]  14\n16: PR,UP  (100,Inf]  16\n\n\n\n\n\n\n\n\n\n\n\nbefore removing low reads\n\n\n\n\n\n\n\n\n\nafter removing low reads\n\n\n\n\n\n\n\nFigure 4: Beta beta correlation plot for WholeBlood:\n\n\n\n\n\n$`(0,1]`\n          ctype         pval   estimate xpos ypos\nPR   Productive 9.439602e-28 -0.3937742    0    0\nUP Unproductive 3.360361e-18 -0.3393361    0    0\n\n$`(1,2]`\n          ctype         pval   estimate xpos ypos\nPR   Productive 0.0004428076 -0.2015878    0    0\nUP Unproductive 0.0448751320 -0.1206233    0    0\n\n$`(10,20]`\n          ctype      pval   estimate xpos ypos\nPR   Productive 0.0189258 -0.1375205    0    0\nUP Unproductive 0.3205614  0.1083808    0    0\n\n$`(100,Inf]`\n          ctype       pval  estimate xpos ypos\nPR   Productive 0.04477046 0.1135186    0    0\nUP Unproductive 0.12066092 0.4040155    0    0\n\n$`(2,5]`\n          ctype         pval   estimate xpos ypos\nUP Unproductive 6.826288e-06 -0.2620576    0    0\nPR   Productive 4.277786e-07 -0.2371908    0    0\n\n$`(20,50]`\n          ctype       pval     estimate xpos ypos\nPR   Productive 0.09007917 -0.086167490    0    0\nUP Unproductive 0.95834860  0.006947826    0    0\n\n$`(5,10]`\n          ctype       pval     estimate xpos ypos\nPR   Productive 0.03117262 -0.117587458    0    0\nUP Unproductive 0.92852704  0.008346092    0    0\n\n$`(50,100]`\n          ctype      pval   estimate xpos ypos\nUP Unproductive 0.1687407 0.38941135    0    0\nPR   Productive 0.7548967 0.02323378    0    0"
  },
  {
    "objectID": "gofig/plot-fig2-heatmap.html#enrichment-test-using-heatmap-genes-as-background",
    "href": "gofig/plot-fig2-heatmap.html#enrichment-test-using-heatmap-genes-as-background",
    "title": "Figure 2 - Heatmap of unprodoctive splicing by tissues",
    "section": "Enrichment test using heatmap genes as background",
    "text": "Enrichment test using heatmap genes as background\n\n\n[1] \"No enrichment found in any groups using ~1000 heatmap genes as background.\""
  },
  {
    "objectID": "gofig/plot-fig2-heatmap.html#enrichment-test-using-whole-genome-as-background",
    "href": "gofig/plot-fig2-heatmap.html#enrichment-test-using-whole-genome-as-background",
    "title": "Figure 2 - Heatmap of unprodoctive splicing by tissues",
    "section": "Enrichment test using whole genome as background",
    "text": "Enrichment test using whole genome as background\np-value in the table below is multiple testing corrected using gprofiler2’s internal method.\n\n\n[1] \"These clusters have enrichment in GO terms\"\n\n\n[1] \"1\" \"2\" \"3\" \"4\" \"5\"\n\n\n\n\nTable 1: GO enrichment results\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 2: GO enrichment results"
  },
  {
    "objectID": "gofig/plot-fig2-heatmap.html#enrichment-test-of-using-whole-genome-as-backgrounda-with-all-clusters-combined",
    "href": "gofig/plot-fig2-heatmap.html#enrichment-test-of-using-whole-genome-as-backgrounda-with-all-clusters-combined",
    "title": "Figure 2 - Heatmap of unprodoctive splicing by tissues",
    "section": "Enrichment test of using whole genome as backgrounda with all clusters combined",
    "text": "Enrichment test of using whole genome as backgrounda with all clusters combined\np-value in the table below is multiple testing corrected using gprofiler2’s internal method.\n\n\n\n\nTable 2: GO enrichment results - combined\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3: GO enrichment results - combined"
  }
]