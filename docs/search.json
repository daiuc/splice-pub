[
  {
    "objectID": "analysis/2024-06-10-tally-sQTLs.html",
    "href": "analysis/2024-06-10-tally-sQTLs.html",
    "title": "QTL tally",
    "section": "",
    "text": "Code\nbase.geu &lt;- \"../code/results/qtl/noisy/Geuvadis/EUR/separateNoise/cis_100000/perm\"\ngeu.sql.f &lt;- glue(\"{base}/chr{chroms}.addQval.txt.gz\", base = base.geu, chroms = 1:22)\nnames(geu.sql.f) &lt;- glue(\"chr{1:22}\")\n\n\n\n\nCode\ngeu.sql &lt;- map_dfr(geu.sql.f, fread)\n\n\n\n\nCode\naddLabels &lt;- function(dt) {\n  pid_split &lt;- str_split(dt$phenotype_id, \":\")\n  dt$itype &lt;- map_chr(pid_split, ~ .x[5])\n  dt$clu &lt;- map_chr(pid_split, ~ .x[4])\n  dt$clu &lt;- str_extract(dt$clu, \"clu_[0-9]+\")\n\n  dt &lt;- dt[, ctype := paste(sort(unique(itype)), collapse = \",\"), by = clu][]\n  return(dt)\n}\n\n\n\n\nCode\ngeu.sql &lt;- addLabels(geu.sql)\n\n\n\n\nCode\ngeu.sql[1:2, ] %&gt;% DT::datatable()\n\n\n\n\n\n\n\n\nNumber of introns\n\n\nCode\ngeu.sql[, .N, by = itype\n  ][, .(itype, N, P = N/sum(N)  )\n  ][order(-N)]\n\n\n   itype     N          P\n1:    PR 83826 0.63891768\n2:    UP 29665 0.22610518\n3:    IN 11756 0.08960366\n4:    NE  5953 0.04537348\n\n\nNumber of clusters\n\n\nCode\ngeu.sql[, .(N = uniqueN(clu)), by = .(ctype)][, .(ctype, N, P = N/sum(N))][order(-N)]\n\n\n          ctype     N            P\n 1:          PR 21693 0.4992175634\n 2:       PR,UP 14598 0.3359414553\n 3:          IN  2943 0.0677267915\n 4:       NE,PR  2154 0.0495696599\n 5:    NE,PR,UP  1277 0.0293873982\n 6:          UP   488 0.0112302665\n 7:          NE    72 0.0016569246\n 8:    IN,PR,UP    53 0.0012196806\n 9:       IN,UP    43 0.0009895522\n10:       IN,PR    38 0.0008744880\n11:    IN,NE,PR    31 0.0007133981\n12: IN,NE,PR,UP    22 0.0005062825\n13:       IN,NE    20 0.0004602568\n14:       NE,UP    17 0.0003912183\n15:    IN,NE,UP     5 0.0001150642\n\n\n\n\n\nNumber of introns with FDR &lt; 0.1\n\n\nCode\nFDR = params$fdr\n\n\n\n\nCode\ngeu.sql[q &lt; FDR, .N, by = .(itype)][, .(itype, N, P = N/sum(N))][order(-N)]\n\n\n   itype    N          P\n1:    PR 9092 0.54777684\n2:    UP 3981 0.23984817\n3:    IN 2690 0.16206772\n4:    NE  835 0.05030727\n\n\nNumber of clusters with FDR &lt; 0.1\n\n\nCode\ngeu.sql[q &lt; FDR, .(N = uniqueN(clu)), by = .(ctype)][, .(ctype, N, P = N/sum(N))][order(-N)]\n\n\n          ctype    N            P\n 1:       PR,UP 3391 0.4070828331\n 2:          PR 2405 0.2887154862\n 3:          IN  971 0.1165666267\n 4:       NE,PR  700 0.0840336134\n 5:    NE,PR,UP  642 0.0770708283\n 6:          UP   86 0.0103241297\n 7:    IN,PR,UP   27 0.0032412965\n 8:       IN,PR   22 0.0026410564\n 9:    IN,NE,PR   21 0.0025210084\n10:       IN,UP   20 0.0024009604\n11: IN,NE,PR,UP   17 0.0020408163\n12:          NE   15 0.0018007203\n13:       IN,NE    8 0.0009603842\n14:       NE,UP    4 0.0004801921\n15:    IN,NE,UP    1 0.0001200480\n\n\n\n\n\nNumber of introns satisfying FDR &lt; 0.1 and from clusters of PR or PR,UP\n\n\nCode\ngeu.sql[q &lt; FDR & ctype %in% c(\"PR\", \"PR,UP\"), .N, by = .(itype)][, .(itype, N, P = N/sum(N))][order(-N)]\n\n\n   itype    N         P\n1:    PR 6960 0.6886998\n2:    UP 3146 0.3113002\n\n\nNumber of clusters satisfying FDR &lt; 0.1 and from clusters of PR or PR,UP\n\n\nCode\ngeu.sql[q &lt; FDR & ctype %in% c(\"PR\", \"PR,UP\"), .(N = uniqueN(clu)), by = .(ctype)][, .(ctype, N, P = N/sum(N))][order(-N)]\n\n\n   ctype    N         P\n1: PR,UP 3391 0.5850587\n2:    PR 2405 0.4149413\n\n\n\n\n\n\nFor GTEx, use sQTLs from 49 tissues. We use FDR &lt; 0.1 and cluster type PR or PR,UP to filter sQTLs.\n\n\nCode\nTissues &lt;- dir(\"../code/results/qtl/noisy/GTEx/\")\nTissues &lt;- Tissues[!Tissues %in% c(\"Bladder\")]\nnames(Tissues) &lt;- Tissues \nbase1.gtex &lt;- \"../code/results/qtl/noisy/GTEx\"\nbase2.gtex &lt;- \"/cis_100000/perm\"\nsuffix &lt;- \"addQval.txt.gz\"\n# \"../code/results/qtl/noisy/GTEx/Liver/separateNoise/cis_100000/perm/chr1.addQval.txt.gz\"\n\n\n\n\nCode\nreadGTExSQTL &lt;- function(tissue) {\n  base1.gtex &lt;- \"../code/results/qtl/noisy/GTEx/\"\n  base2.gtex &lt;- \"/cis_100000/perm\"\n  suffix &lt;- \"addQval.txt.gz\"\n  folder &lt;- glue(\"{base1.gtex}/{tissue}/separateNoise{base2.gtex}\")\n  files &lt;- glue(\"{folder}/chr{1:22}.{suffix}\")\n  dt &lt;- map_dfr(files, fread)\n}\n\n\n\n\nCode\ngtex.sqls &lt;- readRDS(\"2024-06-10-gtex-sQTLs.rds\")\n\n\n\n\nCode\ntissue.labels &lt;- fread(\"/project/yangili1/cdai/splice-pub/analysis/gtex-tissue-code.csv\",\n                      col.names = c(\"tissue\", \"label\"), header = F)\n\n\nNumber of introns that satisfy FDR &lt; 0.1 and from clusters of PR or PR,UP\n\n\nCode\ngtex.plot1.dt &lt;- imap_dfr(gtex.sqls, \\(x, y) {x[q &lt; FDR & ctype %in% c(\"PR\", \"PR,UP\"), .N, by = .(itype)][, .(tissue = y, itype, N, P = N/sum(N))][order(-N)]})\n\n\n\n\nCode\ngtex.plot1.dt %&gt;% \n  left_join(y = tissue.labels, by = \"tissue\") %&gt;% \n  ggplot() + geom_col(aes(x = forcats::fct_reorder(label, -N), y = N, fill = itype)) +\n    scale_fill_brewer(palette = \"Blues\", direction = 1) +\n    labs(x = NULL, y = \"Num. of sQTL introns\", fill = NULL) + \n    theme_cowplot() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1),\n          legend.position = \"top\"\n         )\n\n\n\n\n\n\n\n\nFigure 1\n\n\n\n\n\n\n\nCode\ngtex.plot1.dt %&gt;% DT::datatable()\n\n\n\n\nTable 1\n\n\n\n\n\n\n\n\n\n\nNumber of clusters that satisfy FDR &lt; 0.1 and from clusters of PR or PR,UP\n\n\nCode\ngtex.plot2.dt &lt;- imap_dfr(gtex.sqls, \\(x, y) {\n  x[q &lt; FDR & ctype %in% c(\"PR\", \"PR,UP\"), .(N = uniqueN(clu)), by = .(ctype)][, .(tissue = y, ctype, N, P = N/sum(N))][order(-N)]\n}\n)\n\n\n\n\nCode\ngtex.plot2.dt %&gt;% \n  left_join(y = tissue.labels, by = \"tissue\") %&gt;% \n  ggplot() + geom_col(aes(x = forcats::fct_reorder(label, -N), y = N, fill = ctype)) +\n    scale_fill_brewer(palette = \"Blues\", direction = 1) +\n    labs(x = NULL, y = \"Num. of sQTL (cluster)\", fill = NULL) + \n    theme_cowplot() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1),\n          legend.position = \"top\"\n         )\n\n\n\n\n\n\n\n\nFigure 2\n\n\n\n\n\n\n\nCode\ngtex.plot2.dt %&gt;% DT::datatable()\n\n\n\n\nTable 2"
  },
  {
    "objectID": "analysis/2024-06-10-tally-sQTLs.html#geuvaids-eur",
    "href": "analysis/2024-06-10-tally-sQTLs.html#geuvaids-eur",
    "title": "QTL tally",
    "section": "",
    "text": "Code\nbase.geu &lt;- \"../code/results/qtl/noisy/Geuvadis/EUR/separateNoise/cis_100000/perm\"\ngeu.sql.f &lt;- glue(\"{base}/chr{chroms}.addQval.txt.gz\", base = base.geu, chroms = 1:22)\nnames(geu.sql.f) &lt;- glue(\"chr{1:22}\")\n\n\n\n\nCode\ngeu.sql &lt;- map_dfr(geu.sql.f, fread)\n\n\n\n\nCode\naddLabels &lt;- function(dt) {\n  pid_split &lt;- str_split(dt$phenotype_id, \":\")\n  dt$itype &lt;- map_chr(pid_split, ~ .x[5])\n  dt$clu &lt;- map_chr(pid_split, ~ .x[4])\n  dt$clu &lt;- str_extract(dt$clu, \"clu_[0-9]+\")\n\n  dt &lt;- dt[, ctype := paste(sort(unique(itype)), collapse = \",\"), by = clu][]\n  return(dt)\n}\n\n\n\n\nCode\ngeu.sql &lt;- addLabels(geu.sql)\n\n\n\n\nCode\ngeu.sql[1:2, ] %&gt;% DT::datatable()\n\n\n\n\n\n\n\n\nNumber of introns\n\n\nCode\ngeu.sql[, .N, by = itype\n  ][, .(itype, N, P = N/sum(N)  )\n  ][order(-N)]\n\n\n   itype     N          P\n1:    PR 83826 0.63891768\n2:    UP 29665 0.22610518\n3:    IN 11756 0.08960366\n4:    NE  5953 0.04537348\n\n\nNumber of clusters\n\n\nCode\ngeu.sql[, .(N = uniqueN(clu)), by = .(ctype)][, .(ctype, N, P = N/sum(N))][order(-N)]\n\n\n          ctype     N            P\n 1:          PR 21693 0.4992175634\n 2:       PR,UP 14598 0.3359414553\n 3:          IN  2943 0.0677267915\n 4:       NE,PR  2154 0.0495696599\n 5:    NE,PR,UP  1277 0.0293873982\n 6:          UP   488 0.0112302665\n 7:          NE    72 0.0016569246\n 8:    IN,PR,UP    53 0.0012196806\n 9:       IN,UP    43 0.0009895522\n10:       IN,PR    38 0.0008744880\n11:    IN,NE,PR    31 0.0007133981\n12: IN,NE,PR,UP    22 0.0005062825\n13:       IN,NE    20 0.0004602568\n14:       NE,UP    17 0.0003912183\n15:    IN,NE,UP     5 0.0001150642\n\n\n\n\n\nNumber of introns with FDR &lt; 0.1\n\n\nCode\nFDR = params$fdr\n\n\n\n\nCode\ngeu.sql[q &lt; FDR, .N, by = .(itype)][, .(itype, N, P = N/sum(N))][order(-N)]\n\n\n   itype    N          P\n1:    PR 9092 0.54777684\n2:    UP 3981 0.23984817\n3:    IN 2690 0.16206772\n4:    NE  835 0.05030727\n\n\nNumber of clusters with FDR &lt; 0.1\n\n\nCode\ngeu.sql[q &lt; FDR, .(N = uniqueN(clu)), by = .(ctype)][, .(ctype, N, P = N/sum(N))][order(-N)]\n\n\n          ctype    N            P\n 1:       PR,UP 3391 0.4070828331\n 2:          PR 2405 0.2887154862\n 3:          IN  971 0.1165666267\n 4:       NE,PR  700 0.0840336134\n 5:    NE,PR,UP  642 0.0770708283\n 6:          UP   86 0.0103241297\n 7:    IN,PR,UP   27 0.0032412965\n 8:       IN,PR   22 0.0026410564\n 9:    IN,NE,PR   21 0.0025210084\n10:       IN,UP   20 0.0024009604\n11: IN,NE,PR,UP   17 0.0020408163\n12:          NE   15 0.0018007203\n13:       IN,NE    8 0.0009603842\n14:       NE,UP    4 0.0004801921\n15:    IN,NE,UP    1 0.0001200480\n\n\n\n\n\nNumber of introns satisfying FDR &lt; 0.1 and from clusters of PR or PR,UP\n\n\nCode\ngeu.sql[q &lt; FDR & ctype %in% c(\"PR\", \"PR,UP\"), .N, by = .(itype)][, .(itype, N, P = N/sum(N))][order(-N)]\n\n\n   itype    N         P\n1:    PR 6960 0.6886998\n2:    UP 3146 0.3113002\n\n\nNumber of clusters satisfying FDR &lt; 0.1 and from clusters of PR or PR,UP\n\n\nCode\ngeu.sql[q &lt; FDR & ctype %in% c(\"PR\", \"PR,UP\"), .(N = uniqueN(clu)), by = .(ctype)][, .(ctype, N, P = N/sum(N))][order(-N)]\n\n\n   ctype    N         P\n1: PR,UP 3391 0.5850587\n2:    PR 2405 0.4149413"
  },
  {
    "objectID": "analysis/2024-06-10-tally-sQTLs.html#gtex",
    "href": "analysis/2024-06-10-tally-sQTLs.html#gtex",
    "title": "QTL tally",
    "section": "",
    "text": "For GTEx, use sQTLs from 49 tissues. We use FDR &lt; 0.1 and cluster type PR or PR,UP to filter sQTLs.\n\n\nCode\nTissues &lt;- dir(\"../code/results/qtl/noisy/GTEx/\")\nTissues &lt;- Tissues[!Tissues %in% c(\"Bladder\")]\nnames(Tissues) &lt;- Tissues \nbase1.gtex &lt;- \"../code/results/qtl/noisy/GTEx\"\nbase2.gtex &lt;- \"/cis_100000/perm\"\nsuffix &lt;- \"addQval.txt.gz\"\n# \"../code/results/qtl/noisy/GTEx/Liver/separateNoise/cis_100000/perm/chr1.addQval.txt.gz\"\n\n\n\n\nCode\nreadGTExSQTL &lt;- function(tissue) {\n  base1.gtex &lt;- \"../code/results/qtl/noisy/GTEx/\"\n  base2.gtex &lt;- \"/cis_100000/perm\"\n  suffix &lt;- \"addQval.txt.gz\"\n  folder &lt;- glue(\"{base1.gtex}/{tissue}/separateNoise{base2.gtex}\")\n  files &lt;- glue(\"{folder}/chr{1:22}.{suffix}\")\n  dt &lt;- map_dfr(files, fread)\n}\n\n\n\n\nCode\ngtex.sqls &lt;- readRDS(\"2024-06-10-gtex-sQTLs.rds\")\n\n\n\n\nCode\ntissue.labels &lt;- fread(\"/project/yangili1/cdai/splice-pub/analysis/gtex-tissue-code.csv\",\n                      col.names = c(\"tissue\", \"label\"), header = F)\n\n\nNumber of introns that satisfy FDR &lt; 0.1 and from clusters of PR or PR,UP\n\n\nCode\ngtex.plot1.dt &lt;- imap_dfr(gtex.sqls, \\(x, y) {x[q &lt; FDR & ctype %in% c(\"PR\", \"PR,UP\"), .N, by = .(itype)][, .(tissue = y, itype, N, P = N/sum(N))][order(-N)]})\n\n\n\n\nCode\ngtex.plot1.dt %&gt;% \n  left_join(y = tissue.labels, by = \"tissue\") %&gt;% \n  ggplot() + geom_col(aes(x = forcats::fct_reorder(label, -N), y = N, fill = itype)) +\n    scale_fill_brewer(palette = \"Blues\", direction = 1) +\n    labs(x = NULL, y = \"Num. of sQTL introns\", fill = NULL) + \n    theme_cowplot() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1),\n          legend.position = \"top\"\n         )\n\n\n\n\n\n\n\n\nFigure 1\n\n\n\n\n\n\n\nCode\ngtex.plot1.dt %&gt;% DT::datatable()\n\n\n\n\nTable 1\n\n\n\n\n\n\n\n\n\n\nNumber of clusters that satisfy FDR &lt; 0.1 and from clusters of PR or PR,UP\n\n\nCode\ngtex.plot2.dt &lt;- imap_dfr(gtex.sqls, \\(x, y) {\n  x[q &lt; FDR & ctype %in% c(\"PR\", \"PR,UP\"), .(N = uniqueN(clu)), by = .(ctype)][, .(tissue = y, ctype, N, P = N/sum(N))][order(-N)]\n}\n)\n\n\n\n\nCode\ngtex.plot2.dt %&gt;% \n  left_join(y = tissue.labels, by = \"tissue\") %&gt;% \n  ggplot() + geom_col(aes(x = forcats::fct_reorder(label, -N), y = N, fill = ctype)) +\n    scale_fill_brewer(palette = \"Blues\", direction = 1) +\n    labs(x = NULL, y = \"Num. of sQTL (cluster)\", fill = NULL) + \n    theme_cowplot() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1),\n          legend.position = \"top\"\n         )\n\n\n\n\n\n\n\n\nFigure 2\n\n\n\n\n\n\n\nCode\ngtex.plot2.dt %&gt;% DT::datatable()\n\n\n\n\nTable 2"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Unproductive Splicing",
    "section": "",
    "text": "Order By\n       Default\n         \n          Date - Oldest\n        \n         \n          Date - Newest\n        \n         \n          Title\n        \n         \n          Author\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\nDate\n\n\nTitle\n\n\nAuthor\n\n\n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\n \n\n\n \n\n\n \n\n\n\n\nJun 17, 2024\n\n\nUnproductive splicing ratio in GTEx across tissues\n\n\n \n\n\n\n\nJun 15, 2024\n\n\nGWAS list\n\n\n \n\n\n\n\nJun 10, 2024\n\n\nQTL tally\n\n\n \n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Analysis. Data path in SpliFi/code"
  },
  {
    "objectID": "analysis/2024-06-15-GWAS-list.html",
    "href": "analysis/2024-06-15-GWAS-list.html",
    "title": "GWAS list",
    "section": "",
    "text": "Code\ngwas_path1 &lt;- \"/project/yangili1/zpmu/GWAS_loci/trait_summary.txt\"\ngwas_summ1 &lt;- fread(gwas_path1)\n\n\nUsed 54 from the following path:\n\"/project/yangili1/zpmu/GWAS_loci\"\n\n\nCode\ngwas_summ1 %&gt;% gt::gt()\n\n\n\n\n\n\n\n\n\nTrait\nLabel\nPMID\n\n\n\n\nAllergy and eczema\nAE\n29892013\n\n\nMultiple sclerosis\nMS\n31604244\n\n\nRheumatoid arthritis\nRA\n24390342\n\n\nAllergic disases\nAllergy\n29083406\n\n\nAdult-onset Asthma\nAsthma\n30929738\n\n\nAptopic dermatitis\nApD\n26482879\n\n\nCrohns' disease\nIIBDGC - CD\n26192919\n\n\nInflammaroty bowel disease\nIIBDGC - IBD\n26192919\n\n\nUlcerative colitis\nIIBDGC - UC\n26192919\n\n\nSystemic lupus erythematosus\nSLE\n27399966\n\n\nAsthma\nTAGC - Asthma\n29273806\n\n\nCrohns' disease\nCD\n28067908\n\n\nInflammaroty bowel disease\nIBD\n28067908\n\n\nUlcerative colitis\nUC\n28067908\n\n\nBasophil count\nBASO#\n27863252\n\n\nBasophil percentage of white cells\nBASO%\n27863252\n\n\nBasophil percentage of granulocytes\nBASO%GRAN\n27863252\n\n\nSum basophil neutrophil count\n(BASO+NEUT)#\n27863252\n\n\nSum eosinophil basophil count\n(EO+BASO)#\n27863252\n\n\nEosinophil count\nEO#\n27863252\n\n\nEosinophil percentage of white cells\nEO%\n27863252\n\n\nEosinophil percentage of granulocytes\nEO%GRAN\n27863252\n\n\nGranulocyte count\nGRAN#\n27863252\n\n\nGranulocyte percentage of myeloid white cells\nGRAN%MYELOID\n27863252\n\n\nHematocrit\nHCT\n27863252\n\n\nHemoglobin concentration\nHGB\n27863252\n\n\nHigh light scatter percentage of red cells\nHLSR%\n27863252\n\n\nHigh light scatter reticulocyte count\nHLSR#\n27863252\n\n\nImmature fraction of reticulocytes\nIRF\n27863252\n\n\nLymphocyte count\nLYMPH#\n27863252\n\n\nLymphocyte percentage of white cells\nLYMPH%\n27863252\n\n\nMean corpuscular hemoglobin concentration\nMCHC\n27863252\n\n\nMean corpuscular hemoglobin\nMCH\n27863252\n\n\nMean corpuscular volume\nMCV\n27863252\n\n\nMonocyte count\nMONO#\n27863252\n\n\nMonocyte percentage of white cells\nMONO%\n27863252\n\n\nMean platelet volume\nMPV\n27863252\n\n\nMyeloid white cell count\nMYELOID#\n27863252\n\n\nSum neutrophil eosinophil count\n(NEUT+EO)#\n27863252\n\n\nNeutrophil percentage of granulocytes\nNEUT%GRAN\n27863252\n\n\nNeutrophil count\nNEUT#\n27863252\n\n\nNeutrophil percentage of white cells\nNEUT%\n27863252\n\n\nPlateletcrit\nPCT\n27863252\n\n\nPlatelet distribution width\nPDW\n27863252\n\n\nPlatelet count\nPLT#\n27863252\n\n\nRed blood cell count\nRBC#\n27863252\n\n\nRed cell distribution width\nRDW\n27863252\n\n\nReticulocyte count\nRET#\n27863252\n\n\nReticulocyte fraction of red cells\nRET%\n27863252\n\n\nWhite blood cell count\nWBC#\n27863252\n\n\nEstimated glomerular filtration rate\neGFR\n31152163\n\n\nType 2 diabetes\nT2D\n29632382\n\n\nParkinson's disease\nPD\n31701892\n\n\nAlzheimer's disease\nAD\n30617256"
  },
  {
    "objectID": "analysis/2024-06-15-GWAS-list.html#gwas-from-phenoix",
    "href": "analysis/2024-06-15-GWAS-list.html#gwas-from-phenoix",
    "title": "GWAS list",
    "section": "",
    "text": "Code\ngwas_path1 &lt;- \"/project/yangili1/zpmu/GWAS_loci/trait_summary.txt\"\ngwas_summ1 &lt;- fread(gwas_path1)\n\n\nUsed 54 from the following path:\n\"/project/yangili1/zpmu/GWAS_loci\"\n\n\nCode\ngwas_summ1 %&gt;% gt::gt()\n\n\n\n\n\n\n\n\n\nTrait\nLabel\nPMID\n\n\n\n\nAllergy and eczema\nAE\n29892013\n\n\nMultiple sclerosis\nMS\n31604244\n\n\nRheumatoid arthritis\nRA\n24390342\n\n\nAllergic disases\nAllergy\n29083406\n\n\nAdult-onset Asthma\nAsthma\n30929738\n\n\nAptopic dermatitis\nApD\n26482879\n\n\nCrohns' disease\nIIBDGC - CD\n26192919\n\n\nInflammaroty bowel disease\nIIBDGC - IBD\n26192919\n\n\nUlcerative colitis\nIIBDGC - UC\n26192919\n\n\nSystemic lupus erythematosus\nSLE\n27399966\n\n\nAsthma\nTAGC - Asthma\n29273806\n\n\nCrohns' disease\nCD\n28067908\n\n\nInflammaroty bowel disease\nIBD\n28067908\n\n\nUlcerative colitis\nUC\n28067908\n\n\nBasophil count\nBASO#\n27863252\n\n\nBasophil percentage of white cells\nBASO%\n27863252\n\n\nBasophil percentage of granulocytes\nBASO%GRAN\n27863252\n\n\nSum basophil neutrophil count\n(BASO+NEUT)#\n27863252\n\n\nSum eosinophil basophil count\n(EO+BASO)#\n27863252\n\n\nEosinophil count\nEO#\n27863252\n\n\nEosinophil percentage of white cells\nEO%\n27863252\n\n\nEosinophil percentage of granulocytes\nEO%GRAN\n27863252\n\n\nGranulocyte count\nGRAN#\n27863252\n\n\nGranulocyte percentage of myeloid white cells\nGRAN%MYELOID\n27863252\n\n\nHematocrit\nHCT\n27863252\n\n\nHemoglobin concentration\nHGB\n27863252\n\n\nHigh light scatter percentage of red cells\nHLSR%\n27863252\n\n\nHigh light scatter reticulocyte count\nHLSR#\n27863252\n\n\nImmature fraction of reticulocytes\nIRF\n27863252\n\n\nLymphocyte count\nLYMPH#\n27863252\n\n\nLymphocyte percentage of white cells\nLYMPH%\n27863252\n\n\nMean corpuscular hemoglobin concentration\nMCHC\n27863252\n\n\nMean corpuscular hemoglobin\nMCH\n27863252\n\n\nMean corpuscular volume\nMCV\n27863252\n\n\nMonocyte count\nMONO#\n27863252\n\n\nMonocyte percentage of white cells\nMONO%\n27863252\n\n\nMean platelet volume\nMPV\n27863252\n\n\nMyeloid white cell count\nMYELOID#\n27863252\n\n\nSum neutrophil eosinophil count\n(NEUT+EO)#\n27863252\n\n\nNeutrophil percentage of granulocytes\nNEUT%GRAN\n27863252\n\n\nNeutrophil count\nNEUT#\n27863252\n\n\nNeutrophil percentage of white cells\nNEUT%\n27863252\n\n\nPlateletcrit\nPCT\n27863252\n\n\nPlatelet distribution width\nPDW\n27863252\n\n\nPlatelet count\nPLT#\n27863252\n\n\nRed blood cell count\nRBC#\n27863252\n\n\nRed cell distribution width\nRDW\n27863252\n\n\nReticulocyte count\nRET#\n27863252\n\n\nReticulocyte fraction of red cells\nRET%\n27863252\n\n\nWhite blood cell count\nWBC#\n27863252\n\n\nEstimated glomerular filtration rate\neGFR\n31152163\n\n\nType 2 diabetes\nT2D\n29632382\n\n\nParkinson's disease\nPD\n31701892\n\n\nAlzheimer's disease\nAD\n30617256"
  },
  {
    "objectID": "analysis/2024-06-17-unprod-splicing-ratio-GTEx.html",
    "href": "analysis/2024-06-17-unprod-splicing-ratio-GTEx.html",
    "title": "Unproductive splicing ratio in GTEx across tissues",
    "section": "",
    "text": "Code\ntissues &lt;- dir(\"/project/yangili1/cdai/SpliFi/code/results/pheno/noisy/GTEx\")\ntissues &lt;- tissues[!str_detect(tissues, \"Bladder\")]\n\n\n\n\nCode\ncomputeUnprodRatio &lt;- function(tissue_rds) {\n\n    introns &lt;- readRDS(tissue_rds)\n    datacols &lt;- names(introns)[5:ncol(introns)]\n    # remove clu_type == N, clusters with only unproductive introns\n    introns  &lt;- introns[str_detect(clu_type, 'PR')]\n    # total reads (by sample)\n    totals &lt;- colSums(introns[, ..datacols])\n    # unproudctive reads (by sample)\n    unprod &lt;- introns[intron_type == 'UP', ..datacols] %&gt;% colSums\n    # unproductive reads / total reads\n    if (all(names(totals) == names(unprod))) {\n        unprod_ratio &lt;- round(unprod / totals, 5)\n    } else {\n        stop('samples of totals and unprod are not the same')\n    }\n\n    return(unprod_ratio)\n\n}\n\n\npoint_scale &lt;- function(x, newmin, newmax) {\n  newmax  &lt;- max(newmax)\n  newmin  &lt;- min(newmin)\n  new_range &lt;- abs(newmax - newmin) \n  old_range &lt;- abs(max(x) - min(x))\n\n  # Normalize the values between 0 and 1\n  normalized_x &lt;- (x - min(x)) / old_range\n\n  # Scale the normalized values to the new range and offset by 0.5\n  scaled_x &lt;- normalized_x * new_range + newmin\n\n  return(scaled_x)\n}\n\n\n\n\nCode\ntissues_rds &lt;- glue(\"/project/yangili1/cdai/SpliFi/data/ExtractFractions/GTEx/{tissues}.numerators_constcounts.noise_by_intron.rds\")\nnames(tissues_rds) &lt;- tissues\n\n\n\n\nCode\nratios &lt;- map(tissues_rds, computeUnprodRatio)\n\n\n\n\nCode\nratios &lt;- imap_dfr(\n    ratios,\n    \\(x, y) enframe(x, \"sample\", \"unprodRatio\") %&gt;% add_column(tissue = y)\n)\nratios  &lt;- as.data.table(ratios) %&gt;%\n    .[, .(sample, unprodRatio, nsample = uniqueN(sample)), by = tissue]\n\n\n\n\nCode\nratios[, .(median_prod_ratio = median(unprodRatio)), by = tissue][order(-median_prod_ratio)]\n\n\n                                  tissue median_prod_ratio\n 1:                               Testis          0.009140\n 2:                     Brain-Cerebellum          0.007230\n 3:           Brain-CerebellarHemisphere          0.006740\n 4:        Brain-Spinalcord_cervicalc-1_          0.006150\n 5:                              Thyroid          0.005650\n 6:                             Prostate          0.005630\n 7:                         Nerve-Tibial          0.005360\n 8:                               Spleen          0.005230\n 9:                            Pituitary          0.004970\n10:                Brain-Substantianigra          0.004820\n11:                                Ovary          0.004780\n12:                                 Lung          0.004705\n13:                        Kidney-Cortex          0.004650\n14:                    Brain-Hippocampus          0.004630\n15:         SmallIntestine-TerminalIleum          0.004630\n16:                 Breast-MammaryTissue          0.004540\n17:                               Uterus          0.004515\n18:                   Brain-Hypothalamus          0.004450\n19:       Skin-NotSunExposed_Suprapubic_          0.004310\n20:                         Brain-Cortex          0.004290\n21:                               Vagina          0.004290\n22:                 Adipose-Subcutaneous          0.004220\n23:                       Brain-Amygdala          0.004160\n24:          Brain-Putamen_basalganglia_          0.004150\n25:            Skin-SunExposed_Lowerleg_          0.004140\n26:                        Colon-Sigmoid          0.004110\n27:          Brain-Caudate_basalganglia_          0.004070\n28: Brain-Nucleusaccumbens_basalganglia_          0.004065\n29:            Adipose-Visceral_Omentum_          0.004010\n30:                     Colon-Transverse          0.003955\n31:   Esophagus-GastroesophagealJunction          0.003910\n32:  Brain-Anteriorcingulatecortex_BA24_          0.003890\n33:             Brain-FrontalCortex_BA9_          0.003820\n34:                           WholeBlood          0.003730\n35:                   MinorSalivaryGland          0.003705\n36:                 Esophagus-Muscularis          0.003690\n37:                        Artery-Tibial          0.003570\n38:                      Artery-Coronary          0.003520\n39:                              Stomach          0.003450\n40:                         Artery-Aorta          0.003440\n41:                         AdrenalGland          0.003435\n42:                Heart-AtrialAppendage          0.003400\n43:                                Liver          0.003160\n44:     Cells-EBV-transformedlymphocytes          0.003110\n45:                     Esophagus-Mucosa          0.002960\n46:                  Heart-LeftVentricle          0.002650\n47:                             Pancreas          0.002460\n48:                      Muscle-Skeletal          0.002450\n49:            Cells-Culturedfibroblasts          0.001860\n                                  tissue median_prod_ratio\n\n\nCode\nmedian_unprod_ratio_all_gtex &lt;- ratios[tissue != \"EUR\", .(median_prod_ratio = median(unprodRatio)), by = tissue\n    ][order(-median_prod_ratio)] %&gt;% \n    pull(median_prod_ratio) %&gt;% median\n\n\n\n\nCode\ntissue.labels &lt;- fread(\"/project/yangili1/cdai/splice-pub/analysis/gtex-tissue-code.csv\",\n                       header = F, col.names = c(\"tissue\", \"label\"))\n\n\n\n\nCode\ndf &lt;- ratios[, .(sample, unprodRatio, nsample, med = median(unprodRatio),rk=rank(unprodRatio, ties.method = \"first\")), by = tissue\n        ][, .(sample, unprodRatio, nsample, med, tissue = forcats::fct_reorder(tissue, -med), rk)\n        ][, .(sample, tissue, unprodRatio, nsample, med, tissuei = as.integer(tissue), rk)\n        ][, .(sample, unprodRatio, nsample, med, tissuei, rk, pointx = point_scale(rk, (tissuei - .5), tissuei+.5)), by = tissue\n        ][order(tissuei, rk)] %&gt;% \n    left_join(y = tissue.labels, by = \"tissue\")\n\n\n\n\nCode\nlabels  &lt;- df[, .(tissue, label, tissuei, nsample)] %&gt;% unique\nlabels\n\n\n                                  tissue   label tissuei nsample\n 1:                               Testis  TESTIS       1     361\n 2:                     Brain-Cerebellum   BRNCB       2     241\n 3:           Brain-CerebellarHemisphere  BRNCBH       3     215\n 4:        Brain-Spinalcord_cervicalc-1_  BRNSPC       4     159\n 5:                              Thyroid THYROID       5     653\n 6:                             Prostate  PRSTTE       6     245\n 7:                         Nerve-Tibial  NERVET       7     619\n 8:                               Spleen  SPLEEN       8     241\n 9:                            Pituitary  PTTARY       9     283\n10:                Brain-Substantianigra  BRNSNG      10     139\n11:                                Ovary   OVARY      11     180\n12:                                 Lung    LUNG      12     578\n13:                        Kidney-Cortex  KDNCTX      13      85\n14:                    Brain-Hippocampus  BRNHPC      14     197\n15:         SmallIntestine-TerminalIleum  SNTTRM      15     187\n16:                 Breast-MammaryTissue  BREAST      16     459\n17:                               Uterus  UTERUS      17     142\n18:                   Brain-Hypothalamus  BRNHPT      18     202\n19:       Skin-NotSunExposed_Suprapubic_  SKINNS      19     604\n20:                         Brain-Cortex   BRNCT      20     255\n21:                               Vagina  VAGINA      21     156\n22:                 Adipose-Subcutaneous  ADPSBO      22     663\n23:                       Brain-Amygdala  BRNAGD      23     152\n24:          Brain-Putamen_basalganglia_  BRNPBG      24     205\n25:            Skin-SunExposed_Lowerleg_   SKINS      25     701\n26:                        Colon-Sigmoid  CLNSGM      26     373\n27:          Brain-Caudate_basalganglia_  BRNCDB      27     246\n28: Brain-Nucleusaccumbens_basalganglia_  BRNNAB      28     246\n29:            Adipose-Visceral_Omentum_  ADPVSC      29     541\n30:                     Colon-Transverse  CLNTRN      30     406\n31:   Esophagus-GastroesophagealJunction  ESPGEL      31     375\n32:  Brain-Anteriorcingulatecortex_BA24_  BRNATG      32     176\n33:             Brain-FrontalCortex_BA9_  BRNFCT      33     209\n34:                           WholeBlood  WHLBLD      34     755\n35:                   MinorSalivaryGland  SLVRYG      35     162\n36:                 Esophagus-Muscularis  ESPMSL      36     515\n37:                        Artery-Tibial  ARTTBL      37     663\n38:                      Artery-Coronary  ARTCRN      38     240\n39:                              Stomach  STMACH      39     359\n40:                         Artery-Aorta  ARTAOT      40     432\n41:                         AdrenalGland  ADNGLD      41     258\n42:                Heart-AtrialAppendage   HRTAA      42     429\n43:                                Liver   LIVER      43     226\n44:     Cells-EBV-transformedlymphocytes     LCL      44     174\n45:                     Esophagus-Mucosa  ESPMCS      45     555\n46:                  Heart-LeftVentricle   HRTLV      46     432\n47:                             Pancreas PNCREAS      47     328\n48:                      Muscle-Skeletal MUSCLSK      48     803\n49:            Cells-Culturedfibroblasts FIBRBLS      49     504\n                                  tissue   label tissuei nsample\n\n\n\n\n\nCode\nlabel_x1 &lt;- function(ids) {\n    labels[tissuei == ids, label]\n}\n\nlabel_x2 &lt;- function(ids) {\n    labels[tissuei == ids, nsample] \n}\n\n\ndf %&gt;% left_join(y = tissue.labels, by = \"tissue\") %&gt;%\n      ggplot() +\n        geom_point(aes(x = pointx, y = unprodRatio), color = 'midnightblue', alpha = .1) +\n        geom_tile(aes(x = tissuei, y = med), color = 'firebrick', fill= 'firebrick', height = 5e-5, width = .9) +\n        scale_x_continuous(\n            breaks = unique(df$tissuei), \n            labels = unique(df$label),\n            expand = c(0, .5),\n            guide = guide_axis(angle = 90),\n            sec.axis = sec_axis(~., \n                                breaks = unique(df$tissuei),\n                                labels = label_x2,  \n                                guide = guide_axis(angle = 90)\n                               )\n            ) +\n        scale_y_continuous(labels = scales::percent_format(accuracy = .1)) +\n        labs(x = \"Tissue / Number of Samples\",\n            y = \"Fraction of unproductive reads\"\n            )\n\n\n\n\n\n\n\n\nFigure 1: Unproductive splicing ratio in GTEx across tissues"
  }
]