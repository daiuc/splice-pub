{
  "hash": "8691ca3ccb843ced441684813c9d6532",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Check sqtl beta beta corr plot - Liver\"\ndate: 2024-7-16\nformat: html\ncategories: ['corr', 'sqtl', 'Liver']\ncode-fold: true\nexecute:\n  include: true\n  eval: true\n  cache: false\n  echo: false\n---\n\n\n\n# Check sqtl beta beta corr plot\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"../smk-plots/gtex-sqtl-enrichment-v4/Cells-EBV-transformedlymphocytes-scatter.png\"\n[2] \"../smk-plots/gtex-sqtl-enrichment-v4/Liver-scatter.png\"                           \n[3] \"../smk-plots/gtex-sqtl-enrichment-v4/WholeBlood-scatter.png\"                      \n```\n\n\n:::\n:::\n\n::: {.cell .column-page layout-ncol=\"4\"}\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size](../smk-plots/gtex-sqtl-enrichment-v4/Cells-EBV-transformedlymphocytes-scatter.png){#fig-scatterplots-1 width=100%}\n:::\n\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size](../smk-plots/gtex-sqtl-enrichment-v4/Liver-scatter.png){#fig-scatterplots-2 width=100%}\n:::\n\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size](../smk-plots/gtex-sqtl-enrichment-v4/WholeBlood-scatter.png){#fig-scatterplots-3 width=100%}\n:::\n:::\n\n\n\n# Take a closer look at whole blood\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n**Consider selecting random intron for PR**\n**also try random selection for UP**\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nRemoved 67 transcriptional snps\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Transformation introduced infinite values in continuous x-axis\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 450 rows containing non-finite values (`stat_ecdf()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](2024-07-16-sQTL-beta-beta-plot-check-Liver_files/figure-html/plot cnt summary-1.png){width=672}\n:::\n:::\n\n\nRemove introns with low read counts (less than 10 reads).\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Number of sQTLs removed due to low read counts:\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   ctype   N\n1:    PR 536\n2: PR,UP  73\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Number of sQTLs remaining:\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   ctype   N\n1:    PR 675\n2: PR,UP 520\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nCorrelation test for Liver:\n\nOriginal:\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n          ctype         pval   estimate xpos ypos\nPR   Productive 1.569125e-04 -0.1440360    0    0\nUP Unproductive 1.205498e-12 -0.3037351    0    0\n```\n\n\n:::\n:::\n\n\nsplit by intron bins:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n    ctype binsbyMean   N\n 1:    PR      (0,1] 227\n 2:    PR      (1,2] 133\n 3:    PR      (2,5] 178\n 4:    PR     (5,10] 146\n 5:    PR    (10,20] 169\n 6:    PR    (20,50] 145\n 7:    PR   (50,100]  95\n 8:    PR  (100,Inf] 131\n 9: PR,UP      (0,1] 202\n10: PR,UP      (1,2] 106\n11: PR,UP      (2,5] 123\n12: PR,UP     (5,10]  93\n13: PR,UP    (10,20]  39\n14: PR,UP    (20,50]  24\n15: PR,UP   (50,100]   8\n16: PR,UP  (100,Inf]   4\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n\n::: {#fig-elephants layout-ncol=2}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![before removing low reads](../smk-plots/gtex-sqtl-enrichment-v4/Liver-scatter.png){width=700}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![after removing low reads](2024-07-16-sQTL-beta-beta-plot-check-Liver_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\nBeta beta correlation plot for Liver:\n:::\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n$`(0,1]`\n          ctype         pval   estimate xpos ypos\nPR   Productive 8.193055e-10 -0.3932333    0    0\nUP Unproductive 1.139917e-12 -0.4732474    0    0\n\n$`(1,2]`\n          ctype       pval   estimate xpos ypos\nUP Unproductive 0.02968139 -0.2113030    0    0\nPR   Productive 0.43620741 -0.0680786    0    0\n\n$`(10,20]`\n          ctype      pval    estimate xpos ypos\nPR   Productive 0.4299658 -0.06110832    0    0\nUP Unproductive 0.8583073  0.02954254    0    0\n\n$`(100,Inf]`\n          ctype       pval   estimate xpos ypos\nPR   Productive 0.02455384  0.1964043    0    0\nUP Unproductive 0.39536401 -0.6046360    0    0\n\n$`(2,5]`\n          ctype       pval    estimate xpos ypos\nPR   Productive 0.50020538 -0.05085651    0    0\nUP Unproductive 0.05991577 -0.17013945    0    0\n\n$`(20,50]`\n          ctype      pval     estimate xpos ypos\nPR   Productive 0.9423765 -0.006055148    0    0\nUP Unproductive 0.2912667  0.224645397    0    0\n\n$`(5,10]`\n          ctype      pval    estimate xpos ypos\nPR   Productive 0.2736122  0.09119975    0    0\nUP Unproductive 0.1549035 -0.14868809    0    0\n\n$`(50,100]`\n          ctype      pval     estimate xpos ypos\nPR   Productive 0.3968099  0.087929945    0    0\nUP Unproductive 0.9959961 -0.002135432    0    0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell .column-screen}\n::: {.cell-output-display}\n![](2024-07-16-sQTL-beta-beta-plot-check-Liver_files/figure-html/unnamed-chunk-30-1.png){width=960}\n:::\n:::\n",
    "supporting": [
      "2024-07-16-sQTL-beta-beta-plot-check-Liver_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}