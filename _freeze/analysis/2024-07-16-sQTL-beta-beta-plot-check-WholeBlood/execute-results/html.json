{
  "hash": "51718a68b6d4a4be4c9e3c322f0d92b8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Check sqtl beta beta corr plot\"\ndate: 2024-7-16\nformat: html\ncategories: ['corr', 'sqtl', 'WholeBlood']\ncode-fold: true\nexecute:\n  include: true\n  eval: true\n  cache: false\n  echo: false\n---\n\n\n\n# Check sqtl beta beta corr plot\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"../smk-plots/gtex-sqtl-enrichment-v4/Cells-EBV-transformedlymphocytes-scatter.png\"\n[2] \"../smk-plots/gtex-sqtl-enrichment-v4/Liver-scatter.png\"                           \n[3] \"../smk-plots/gtex-sqtl-enrichment-v4/WholeBlood-scatter.png\"                      \n```\n\n\n:::\n:::\n\n::: {.cell .column-page layout-ncol=\"4\"}\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size](../smk-plots/gtex-sqtl-enrichment-v4/Cells-EBV-transformedlymphocytes-scatter.png){#fig-scatterplots-1 width=100%}\n:::\n\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size](../smk-plots/gtex-sqtl-enrichment-v4/Liver-scatter.png){#fig-scatterplots-2 width=100%}\n:::\n\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size](../smk-plots/gtex-sqtl-enrichment-v4/WholeBlood-scatter.png){#fig-scatterplots-3 width=100%}\n:::\n:::\n\n\n\n# Take a closer look at whole blood\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n**Consider selecting random intron for PR**\n**also try random selection for UP**\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nRemoved 208 transcriptional snps\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Transformation introduced infinite values in continuous x-axis\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 1430 rows containing non-finite values (`stat_ecdf()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](2024-07-16-sQTL-beta-beta-plot-check-WholeBlood_files/figure-html/plot cnt summary-1.png){width=672}\n:::\n:::\n\n\nRemove introns with low read counts (less than 10 reads).\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Number of sQTLs removed due to low read counts:\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   ctype    N\n1:    PR 1162\n2: PR,UP  174\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Number of sQTLs remaining:\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   ctype    N\n1: PR,UP 1291\n2:    PR 1763\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nCorrelation test for WholeBlood:\n\nOriginal:\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n          ctype         pval  estimate xpos ypos\nUP Unproductive 6.552652e-21 -0.255785    0    0\nPR   Productive 8.060112e-32 -0.272386    0    0\n```\n\n\n:::\n:::\n\n\nsplit by intron bins:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n    ctype binsbyMean   N\n 1:    PR      (0,1] 710\n 2:    PR      (1,2] 300\n 3:    PR      (2,5] 444\n 4:    PR     (5,10] 336\n 5:    PR    (10,20] 291\n 6:    PR    (20,50] 388\n 7:    PR   (50,100] 183\n 8:    PR  (100,Inf] 313\n 9: PR,UP      (0,1] 621\n10: PR,UP      (1,2] 277\n11: PR,UP      (2,5] 287\n12: PR,UP     (5,10] 118\n13: PR,UP    (10,20]  86\n14: PR,UP    (20,50]  59\n15: PR,UP   (50,100]  14\n16: PR,UP  (100,Inf]  16\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n\n::: {#fig-elephants layout-ncol=2}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![before removing low reads](../smk-plots/gtex-sqtl-enrichment-v4/WholeBlood-scatter.png){width=700}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![after removing low reads](2024-07-16-sQTL-beta-beta-plot-check-WholeBlood_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\nBeta beta correlation plot for WholeBlood:\n:::\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n$`(0,1]`\n          ctype         pval   estimate xpos ypos\nPR   Productive 9.439602e-28 -0.3937742    0    0\nUP Unproductive 3.360361e-18 -0.3393361    0    0\n\n$`(1,2]`\n          ctype         pval   estimate xpos ypos\nPR   Productive 0.0004428076 -0.2015878    0    0\nUP Unproductive 0.0448751320 -0.1206233    0    0\n\n$`(10,20]`\n          ctype      pval   estimate xpos ypos\nPR   Productive 0.0189258 -0.1375205    0    0\nUP Unproductive 0.3205614  0.1083808    0    0\n\n$`(100,Inf]`\n          ctype       pval  estimate xpos ypos\nPR   Productive 0.04477046 0.1135186    0    0\nUP Unproductive 0.12066092 0.4040155    0    0\n\n$`(2,5]`\n          ctype         pval   estimate xpos ypos\nUP Unproductive 6.826288e-06 -0.2620576    0    0\nPR   Productive 4.277786e-07 -0.2371908    0    0\n\n$`(20,50]`\n          ctype       pval     estimate xpos ypos\nPR   Productive 0.09007917 -0.086167490    0    0\nUP Unproductive 0.95834860  0.006947826    0    0\n\n$`(5,10]`\n          ctype       pval     estimate xpos ypos\nPR   Productive 0.03117262 -0.117587458    0    0\nUP Unproductive 0.92852704  0.008346092    0    0\n\n$`(50,100]`\n          ctype      pval   estimate xpos ypos\nUP Unproductive 0.1687407 0.38941135    0    0\nPR   Productive 0.7548967 0.02323378    0    0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell .column-screen}\n::: {.cell-output-display}\n![](2024-07-16-sQTL-beta-beta-plot-check-WholeBlood_files/figure-html/unnamed-chunk-30-1.png){width=960}\n:::\n:::\n",
    "supporting": [
      "2024-07-16-sQTL-beta-beta-plot-check-WholeBlood_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}