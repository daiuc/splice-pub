{
  "hash": "f828a50d8ccb9a4a8e13f0fe2288ab3d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"List of differentially spliced junctions\"\ndate: 2024-9-5\nformat: html\ncode-fold: true\nexecute:\n  include: false\n  eval: false\n  cache: false\n  echo: false\n---\n\n\n>im making good progress on re-analyzing that comprative rna-seq data leafcutter2 styleâ€¦ but after discussing a little with yang today, we have an idea for a figure panel that would involve identifying a nice example of a conserved unproductive splice event that is also present in your GTEx cross-tissue differential splicing analysis. Can you share a list of junctions that are differentially spliced any pair of GTEx tissues that you looked at. Like, ideal would be a text file of human junction coordinates, and the tissue pairs from which the differential splicing was done, and a beta (so I can see if the direction of the effect is same in other other species).\n\n\n\n\n::: {.callout-note}\n\n## Notes\n\n\n- Results here are before the recent implementation of foward splicing junction classifer and bug fixes.\n:::\n\n\n# List of differentially spliced junctions\n\n\nList of differentialy spliced junctions are here: \n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_AdrenalGland_data.rds\n/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Artery-Coronary_data.rds\n/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-Amygdala_data.rds\n/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-Anteriorcingulatecortex_BA24__data.rds\n/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-Caudate_basalganglia__data.rds\n/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-CerebellarHemisphere_data.rds\n/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-Cerebellum_data.rds\n/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-Cortex_data.rds\n/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-FrontalCortex_BA9__data.rds\n/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-Hippocampus_data.rds\nTotal number of pairs of comparisons\n702\n```\n\n\n:::\n:::\n\n\n\n\n\n# Join differentially expressed genes and differentially spliced junctions\n\nYou can use this funciton to get the table of differentially spliced junctions and differentially expressed genes. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_DS_DGE_table <- function(rds, contrast, FDR = 1e-5, selection = 'all', plot=FALSE) {\n    # rds: a single rds file, previousp rocessed in \"../../SpliFi/prepdata.smk\"\n    # contrast: a string, the contrast name\n    # return a joined table (on gene_names) of differential spliced junctions and diffenetially expressed genes\n    data <- readRDS(rds)\n    ds <- data$ds\n    dge <- data$dge\n    dge_dsc <- data$dge_dsc\n\n    joined_dt <- inner_join(\n        x = ds[abs(deltapsi) > .1 & `p.adjust` < FDR & ctype %in% c('PR', 'PR,UP'), \n        .(gene_id, gene_name, intron, cluster, itype, ctype, deltapsi)],\n        y = dge[, .(gene_id, g_l2fc = log2FoldChange, g_z = stat, g_l2fcSE = lfcSE)],\n        by = 'gene_id'\n    )\n\n    if (selection == 'maxClu') {\n        joined_dt  <- joined_dt[\n            , .(intron, deltapsi, g_l2fc, g_z, g_l2fcSE, rk = rank(-abs(deltapsi), ties.method = \"random\")), \n            by = .(gene_id, gene_name, cluster, itype, ctype)\n            ][rk == 1, -c('rk')]\n    } else if (selection == 'maxGene') {\n        joined_dt <- joined_dt[\n            , .(intron, deltapsi, g_l2fc, g_z, g_l2fcSE, rk = rank(-abs(deltapsi), ties.method = \"random\")), \n            by = .(gene_id, gene_name, itype)\n            ][rk == 1, -c('rk')]\n    }\n\n    return(joined_dt)\n}\n```\n:::\n\n\n\n# Other previously prepared data\n\n\n## Clusters selected for plotting heatmaps\n\nThe Heatmap in Figure 2 is a common set of clusters across tissues. These clusters are selected because in at least some tissues (vs. others), they showed differential splicing and differential gene expression. \n\nHere's a set of chosen clusters. If a cluster has multiple UP introns, only the best one is selected (largest deltaPSI). Introns are also selected if deltaPSI and expression L2FC has different signs.\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n/project/yangili1/cdai/SpliFi/data/ds_v_dge/chosen_clusters_dpsi_0_2.rds\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "2024-09-05-list-of-ds-introns-for-ben_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}