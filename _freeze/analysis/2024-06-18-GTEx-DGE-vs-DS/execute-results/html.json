{
  "hash": "0b8a0075ad7124e905746e7feb73063f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Differential splicing vs differential gene expression in GTEx\"\ndate: \"2024-6-18\"\nparams: \n  fdr: 1e-5\ncategories:\n  - GTEx\n  - DGE\n  - DS\ncode-fold: true\nexecute:\n  include: true\n  cache: true\n---\n\n\n\n\n\n\n# Intro\n\nThis notebook produces the comparison of differential splicing and differential gene expression.\nPre-processed data are under `../../SpliFi/data/ds_v_dge/{tissue2}_v_{tissue1}_data.rds`\n\n\n\n## `Brain-Cortex_v_Muscle-Skeletal`\n\n### Load data\n\nSaved RDS file is a list of 3 objects: \n  - `ds` : differential splicing results\n  - `dge` : differential gene expression results\n  - `dge_dsc` : metadata for dge results\n\n::: {.cell}\n\n```{.r .cell-code}\ncontrast <- \"Brain-Cortex_v_Muscle-Skeletal\"\ndata <- readRDS(glue('/project/yangili1/cdai/SpliFi/data/ds_v_dge/{contrast}_data.rds'))\n\nds <- data$ds\ndge <- data$dge\n```\n:::\n\n\n\n**ds:**\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(ds) %>% gt::gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"nckalgkisl\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#nckalgkisl table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#nckalgkisl thead, #nckalgkisl tbody, #nckalgkisl tfoot, #nckalgkisl tr, #nckalgkisl td, #nckalgkisl th {\n  border-style: none;\n}\n\n#nckalgkisl p {\n  margin: 0;\n  padding: 0;\n}\n\n#nckalgkisl .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#nckalgkisl .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#nckalgkisl .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#nckalgkisl .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#nckalgkisl .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nckalgkisl .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nckalgkisl .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nckalgkisl .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#nckalgkisl .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#nckalgkisl .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#nckalgkisl .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#nckalgkisl .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#nckalgkisl .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#nckalgkisl .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#nckalgkisl .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#nckalgkisl .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#nckalgkisl .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#nckalgkisl .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#nckalgkisl .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nckalgkisl .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#nckalgkisl .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#nckalgkisl .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#nckalgkisl .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nckalgkisl .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#nckalgkisl .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#nckalgkisl .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nckalgkisl .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nckalgkisl .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#nckalgkisl .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nckalgkisl .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#nckalgkisl .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nckalgkisl .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nckalgkisl .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nckalgkisl .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nckalgkisl .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nckalgkisl .gt_left {\n  text-align: left;\n}\n\n#nckalgkisl .gt_center {\n  text-align: center;\n}\n\n#nckalgkisl .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#nckalgkisl .gt_font_normal {\n  font-weight: normal;\n}\n\n#nckalgkisl .gt_font_bold {\n  font-weight: bold;\n}\n\n#nckalgkisl .gt_font_italic {\n  font-style: italic;\n}\n\n#nckalgkisl .gt_super {\n  font-size: 65%;\n}\n\n#nckalgkisl .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#nckalgkisl .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#nckalgkisl .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#nckalgkisl .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#nckalgkisl .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#nckalgkisl .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#nckalgkisl .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"intron\">intron</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cluster\">cluster</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"itype\">itype</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ctype\">ctype</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"gene_name\">gene_name</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"gene_id\">gene_id</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"logef\">logef</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Muscle-Skeletal\">Muscle-Skeletal</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Brain-Cortex\">Brain-Cortex</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"deltapsi\">deltapsi</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"status\">status</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"loglr\">loglr</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"df\">df</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p\">p</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.adjust\">p.adjust</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"intron\" class=\"gt_row gt_left\">chr1:930336:931038:clu_11_+</td>\n<td headers=\"cluster\" class=\"gt_row gt_left\">chr1:clu_11_+</td>\n<td headers=\"itype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"ctype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"gene_name\" class=\"gt_row gt_left\">SAMD11</td>\n<td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000187634.11</td>\n<td headers=\"logef\" class=\"gt_row gt_right\">0.001370763</td>\n<td headers=\"Muscle-Skeletal\" class=\"gt_row gt_right\">0.5276685</td>\n<td headers=\"Brain-Cortex\" class=\"gt_row gt_right\">0.5283518</td>\n<td headers=\"deltapsi\" class=\"gt_row gt_right\">0.0006832305</td>\n<td headers=\"status\" class=\"gt_row gt_left\">Success</td>\n<td headers=\"loglr\" class=\"gt_row gt_right\">0.0001028596</td>\n<td headers=\"df\" class=\"gt_row gt_right\">1</td>\n<td headers=\"p\" class=\"gt_row gt_right\">0.9885564</td>\n<td headers=\"p.adjust\" class=\"gt_row gt_right\">0.9923067</td></tr>\n    <tr><td headers=\"intron\" class=\"gt_row gt_left\">chr1:931089:935771:clu_11_+</td>\n<td headers=\"cluster\" class=\"gt_row gt_left\">chr1:clu_11_+</td>\n<td headers=\"itype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"ctype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"gene_name\" class=\"gt_row gt_left\">SAMD11</td>\n<td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000187634.11</td>\n<td headers=\"logef\" class=\"gt_row gt_right\">-0.001370763</td>\n<td headers=\"Muscle-Skeletal\" class=\"gt_row gt_right\">0.4723315</td>\n<td headers=\"Brain-Cortex\" class=\"gt_row gt_right\">0.4716482</td>\n<td headers=\"deltapsi\" class=\"gt_row gt_right\">-0.0006832305</td>\n<td headers=\"status\" class=\"gt_row gt_left\">Success</td>\n<td headers=\"loglr\" class=\"gt_row gt_right\">0.0001028596</td>\n<td headers=\"df\" class=\"gt_row gt_right\">1</td>\n<td headers=\"p\" class=\"gt_row gt_right\">0.9885564</td>\n<td headers=\"p.adjust\" class=\"gt_row gt_right\">0.9923067</td></tr>\n    <tr><td headers=\"intron\" class=\"gt_row gt_left\">chr1:939129:939271:clu_12_+</td>\n<td headers=\"cluster\" class=\"gt_row gt_left\">chr1:clu_12_+</td>\n<td headers=\"itype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"ctype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"gene_name\" class=\"gt_row gt_left\">SAMD11</td>\n<td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000187634.11</td>\n<td headers=\"logef\" class=\"gt_row gt_right\">0.033612392</td>\n<td headers=\"Muscle-Skeletal\" class=\"gt_row gt_right\">0.3507898</td>\n<td headers=\"Brain-Cortex\" class=\"gt_row gt_right\">0.3662486</td>\n<td headers=\"deltapsi\" class=\"gt_row gt_right\">0.0154587644</td>\n<td headers=\"status\" class=\"gt_row gt_left\">Success</td>\n<td headers=\"loglr\" class=\"gt_row gt_right\">0.0288890045</td>\n<td headers=\"df\" class=\"gt_row gt_right\">1</td>\n<td headers=\"p\" class=\"gt_row gt_right\">0.8100430</td>\n<td headers=\"p.adjust\" class=\"gt_row gt_right\">0.8467780</td></tr>\n    <tr><td headers=\"intron\" class=\"gt_row gt_left\">chr1:939129:939274:clu_12_+</td>\n<td headers=\"cluster\" class=\"gt_row gt_left\">chr1:clu_12_+</td>\n<td headers=\"itype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"ctype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"gene_name\" class=\"gt_row gt_left\">SAMD11</td>\n<td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000187634.11</td>\n<td headers=\"logef\" class=\"gt_row gt_right\">-0.033612392</td>\n<td headers=\"Muscle-Skeletal\" class=\"gt_row gt_right\">0.6492102</td>\n<td headers=\"Brain-Cortex\" class=\"gt_row gt_right\">0.6337514</td>\n<td headers=\"deltapsi\" class=\"gt_row gt_right\">-0.0154587644</td>\n<td headers=\"status\" class=\"gt_row gt_left\">Success</td>\n<td headers=\"loglr\" class=\"gt_row gt_right\">0.0288890045</td>\n<td headers=\"df\" class=\"gt_row gt_right\">1</td>\n<td headers=\"p\" class=\"gt_row gt_right\">0.8100430</td>\n<td headers=\"p.adjust\" class=\"gt_row gt_right\">0.8467780</td></tr>\n    <tr><td headers=\"intron\" class=\"gt_row gt_left\">chr1:939412:941143:clu_13_+</td>\n<td headers=\"cluster\" class=\"gt_row gt_left\">chr1:clu_13_+</td>\n<td headers=\"itype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"ctype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"gene_name\" class=\"gt_row gt_left\">SAMD11</td>\n<td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000187634.11</td>\n<td headers=\"logef\" class=\"gt_row gt_right\">-0.022419411</td>\n<td headers=\"Muscle-Skeletal\" class=\"gt_row gt_right\">0.2376936</td>\n<td headers=\"Brain-Cortex\" class=\"gt_row gt_right\">0.2324409</td>\n<td headers=\"deltapsi\" class=\"gt_row gt_right\">-0.0052526823</td>\n<td headers=\"status\" class=\"gt_row gt_left\">Success</td>\n<td headers=\"loglr\" class=\"gt_row gt_right\">1.3652655309</td>\n<td headers=\"df\" class=\"gt_row gt_right\">2</td>\n<td headers=\"p\" class=\"gt_row gt_right\">0.2553129</td>\n<td headers=\"p.adjust\" class=\"gt_row gt_right\">0.3191507</td></tr>\n    <tr><td headers=\"intron\" class=\"gt_row gt_left\">chr1:941306:942135:clu_13_+</td>\n<td headers=\"cluster\" class=\"gt_row gt_left\">chr1:clu_13_+</td>\n<td headers=\"itype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"ctype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"gene_name\" class=\"gt_row gt_left\">SAMD11</td>\n<td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000187634.11</td>\n<td headers=\"logef\" class=\"gt_row gt_right\">-0.165432662</td>\n<td headers=\"Muscle-Skeletal\" class=\"gt_row gt_right\">0.4241880</td>\n<td headers=\"Brain-Cortex\" class=\"gt_row gt_right\">0.3595370</td>\n<td headers=\"deltapsi\" class=\"gt_row gt_right\">-0.0646509809</td>\n<td headers=\"status\" class=\"gt_row gt_left\">Success</td>\n<td headers=\"loglr\" class=\"gt_row gt_right\">1.3652655309</td>\n<td headers=\"df\" class=\"gt_row gt_right\">2</td>\n<td headers=\"p\" class=\"gt_row gt_right\">0.2553129</td>\n<td headers=\"p.adjust\" class=\"gt_row gt_right\">0.3191507</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n**dge:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(dge) %>% gt::gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"zsqpmmsbog\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#zsqpmmsbog table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#zsqpmmsbog thead, #zsqpmmsbog tbody, #zsqpmmsbog tfoot, #zsqpmmsbog tr, #zsqpmmsbog td, #zsqpmmsbog th {\n  border-style: none;\n}\n\n#zsqpmmsbog p {\n  margin: 0;\n  padding: 0;\n}\n\n#zsqpmmsbog .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#zsqpmmsbog .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#zsqpmmsbog .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#zsqpmmsbog .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#zsqpmmsbog .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zsqpmmsbog .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zsqpmmsbog .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zsqpmmsbog .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#zsqpmmsbog .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#zsqpmmsbog .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#zsqpmmsbog .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#zsqpmmsbog .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#zsqpmmsbog .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#zsqpmmsbog .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#zsqpmmsbog .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zsqpmmsbog .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#zsqpmmsbog .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#zsqpmmsbog .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#zsqpmmsbog .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zsqpmmsbog .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#zsqpmmsbog .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#zsqpmmsbog .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#zsqpmmsbog .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zsqpmmsbog .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#zsqpmmsbog .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#zsqpmmsbog .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zsqpmmsbog .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zsqpmmsbog .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#zsqpmmsbog .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zsqpmmsbog .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#zsqpmmsbog .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zsqpmmsbog .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zsqpmmsbog .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zsqpmmsbog .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zsqpmmsbog .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zsqpmmsbog .gt_left {\n  text-align: left;\n}\n\n#zsqpmmsbog .gt_center {\n  text-align: center;\n}\n\n#zsqpmmsbog .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#zsqpmmsbog .gt_font_normal {\n  font-weight: normal;\n}\n\n#zsqpmmsbog .gt_font_bold {\n  font-weight: bold;\n}\n\n#zsqpmmsbog .gt_font_italic {\n  font-style: italic;\n}\n\n#zsqpmmsbog .gt_super {\n  font-size: 65%;\n}\n\n#zsqpmmsbog .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#zsqpmmsbog .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#zsqpmmsbog .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#zsqpmmsbog .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#zsqpmmsbog .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#zsqpmmsbog .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#zsqpmmsbog .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"gene_id\">gene_id</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"baseMean\">baseMean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"log2FoldChange\">log2FoldChange</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"lfcSE\">lfcSE</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"stat\">stat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"pvalue\">pvalue</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"padj\">padj</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000109061.9</td>\n<td headers=\"baseMean\" class=\"gt_row gt_right\">264709.904</td>\n<td headers=\"log2FoldChange\" class=\"gt_row gt_right\">-13.54712</td>\n<td headers=\"lfcSE\" class=\"gt_row gt_right\">0.2173014</td>\n<td headers=\"stat\" class=\"gt_row gt_right\">-62.34253</td>\n<td headers=\"pvalue\" class=\"gt_row gt_right\">0</td>\n<td headers=\"padj\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000168530.15</td>\n<td headers=\"baseMean\" class=\"gt_row gt_right\">109266.143</td>\n<td headers=\"log2FoldChange\" class=\"gt_row gt_right\">-13.36231</td>\n<td headers=\"lfcSE\" class=\"gt_row gt_right\">0.1923248</td>\n<td headers=\"stat\" class=\"gt_row gt_right\">-69.47785</td>\n<td headers=\"pvalue\" class=\"gt_row gt_right\">0</td>\n<td headers=\"padj\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000125414.18</td>\n<td headers=\"baseMean\" class=\"gt_row gt_right\">209656.455</td>\n<td headers=\"log2FoldChange\" class=\"gt_row gt_right\">-13.35553</td>\n<td headers=\"lfcSE\" class=\"gt_row gt_right\">0.2288908</td>\n<td headers=\"stat\" class=\"gt_row gt_right\">-58.34893</td>\n<td headers=\"pvalue\" class=\"gt_row gt_right\">0</td>\n<td headers=\"padj\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000250978.5</td>\n<td headers=\"baseMean\" class=\"gt_row gt_right\">1478.281</td>\n<td headers=\"log2FoldChange\" class=\"gt_row gt_right\">-13.28802</td>\n<td headers=\"lfcSE\" class=\"gt_row gt_right\">0.3241620</td>\n<td headers=\"stat\" class=\"gt_row gt_right\">-40.99192</td>\n<td headers=\"pvalue\" class=\"gt_row gt_right\">0</td>\n<td headers=\"padj\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000116748.21</td>\n<td headers=\"baseMean\" class=\"gt_row gt_right\">14974.113</td>\n<td headers=\"log2FoldChange\" class=\"gt_row gt_right\">-13.21024</td>\n<td headers=\"lfcSE\" class=\"gt_row gt_right\">0.2008433</td>\n<td headers=\"stat\" class=\"gt_row gt_right\">-65.77385</td>\n<td headers=\"pvalue\" class=\"gt_row gt_right\">0</td>\n<td headers=\"padj\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000159173.18</td>\n<td headers=\"baseMean\" class=\"gt_row gt_right\">145207.909</td>\n<td headers=\"log2FoldChange\" class=\"gt_row gt_right\">-13.10009</td>\n<td headers=\"lfcSE\" class=\"gt_row gt_right\">0.2499607</td>\n<td headers=\"stat\" class=\"gt_row gt_right\">-52.40861</td>\n<td headers=\"pvalue\" class=\"gt_row gt_right\">0</td>\n<td headers=\"padj\" class=\"gt_row gt_right\">0</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\nprint(data$dge_dsc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"mean of normalized counts for all samples\"                     \n[2] \"log2 fold change (MLE): tissue Brain.Cortex vs Muscle.Skeletal\"\n[3] \"standard error: tissue Brain.Cortex vs Muscle.Skeletal\"        \n[4] \"Wald statistic: tissue Brain.Cortex vs Muscle.Skeletal\"        \n[5] \"Wald test p-value: tissue Brain.Cortex vs Muscle.Skeletal\"     \n[6] \"BH adjusted p-values\"                                          \n```\n\n\n:::\n:::\n\n\n\n\n### Prep data\n\n\nMainly to join ds and dge dataset on `gene_id`. \n\nIntrons from ds tables are selected using: \n  - `abs(deltapsi) > .1` : to filter out introns with small deltaPSI\n  - `p.adjust < FDR` : to filter out introns with high FDR\n  - `ctype %in% c('PR', 'PR,UP')` : introns are either productive or unproductive\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntissues <- str_split(contrast, \"_v_\") %>% unlist # follow tissue2_v_tissue1\n\n# confirm ds contrast\nconfirm_level_ds <- all(names(data$ds)[c(9, 8)] == tissues)\n\n# confirm dge contrast\nconfirm_level_dge <- str_detect(str_split(data$dge_dsc[2], \"tissue \")[[1]][[2]] %>% str_replace_all(\"\\\\.\", \"-\"),\n                                glue(\"{tissues[1]} vs {tissues[2]}\")\n                                )\n\nif (confirm_level_dge & confirm_level_ds) {\n  message(\"Confirmed tissue order\")\n} else {\n  stop(\"Tissue order not confirmed\")\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nConfirmed tissue order\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nFDR <- params$fdr\n\nds[`p.adjust` < FDR & ctype %in% c('PR', 'PR,UP')\n  ][,.(intron, deltapsi, itype)] %>% unique %>% \n  ggplot() + stat_ecdf(aes(x=abs(deltapsi), color=itype)) +\n    scale_color_brewer(type = \"qual\", palette = 2, direction = -1, label = c(PR=\"Productive\", UP=\"Unproductive\"), name = NULL) +\n    labs(title = glue(\"{contrast}\")) +\n    scale_x_sqrt(name = \"abs(deltaPSI)\")\n```\n\n::: {.cell-output-display}\n![Distribution of deltaPSI in Brain-Cortex vs Muscle-Skeletal](2024-06-18-GTEx-DGE-vs-DS_files/figure-html/fig-distribution-of-dPSI-BRNCTX-MUSCSKLT-1.png){#fig-distribution-of-dPSI-BRNCTX-MUSCSKLT width=80%}\n:::\n:::\n\n\n\nJoined ds and dge tables on `gene_id`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\njoined_dt <- inner_join(\n  x = ds[abs(deltapsi) > .1 & `p.adjust` < FDR & ctype %in% c('PR', 'PR,UP'), \n        .(gene_id, gene_name, intron, cluster, itype, ctype, deltapsi)],\n  y = dge[, .(gene_id, g_l2fc = log2FoldChange, g_z = stat, g_l2fcSE = lfcSE)],\n  by = 'gene_id'\n  )\n```\n:::\n\n\n\nQuick look of the joined table\n\n\n::: {.cell}\n\n```{.r .cell-code}\njoined_dt %>% head %>% gt::gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"osesucktrt\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#osesucktrt table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#osesucktrt thead, #osesucktrt tbody, #osesucktrt tfoot, #osesucktrt tr, #osesucktrt td, #osesucktrt th {\n  border-style: none;\n}\n\n#osesucktrt p {\n  margin: 0;\n  padding: 0;\n}\n\n#osesucktrt .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#osesucktrt .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#osesucktrt .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#osesucktrt .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#osesucktrt .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#osesucktrt .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#osesucktrt .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#osesucktrt .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#osesucktrt .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#osesucktrt .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#osesucktrt .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#osesucktrt .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#osesucktrt .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#osesucktrt .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#osesucktrt .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#osesucktrt .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#osesucktrt .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#osesucktrt .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#osesucktrt .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#osesucktrt .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#osesucktrt .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#osesucktrt .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#osesucktrt .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#osesucktrt .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#osesucktrt .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#osesucktrt .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#osesucktrt .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#osesucktrt .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#osesucktrt .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#osesucktrt .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#osesucktrt .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#osesucktrt .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#osesucktrt .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#osesucktrt .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#osesucktrt .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#osesucktrt .gt_left {\n  text-align: left;\n}\n\n#osesucktrt .gt_center {\n  text-align: center;\n}\n\n#osesucktrt .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#osesucktrt .gt_font_normal {\n  font-weight: normal;\n}\n\n#osesucktrt .gt_font_bold {\n  font-weight: bold;\n}\n\n#osesucktrt .gt_font_italic {\n  font-style: italic;\n}\n\n#osesucktrt .gt_super {\n  font-size: 65%;\n}\n\n#osesucktrt .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#osesucktrt .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#osesucktrt .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#osesucktrt .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#osesucktrt .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#osesucktrt .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#osesucktrt .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"gene_id\">gene_id</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"gene_name\">gene_name</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"intron\">intron</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cluster\">cluster</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"itype\">itype</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ctype\">ctype</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"deltapsi\">deltapsi</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"g_l2fc\">g_l2fc</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"g_z\">g_z</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"g_l2fcSE\">g_l2fcSE</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000188157.14</td>\n<td headers=\"gene_name\" class=\"gt_row gt_left\">AGRN</td>\n<td headers=\"intron\" class=\"gt_row gt_left\">chr1:1051815:1051992:clu_22_+</td>\n<td headers=\"cluster\" class=\"gt_row gt_left\">chr1:clu_22_+</td>\n<td headers=\"itype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"ctype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"deltapsi\" class=\"gt_row gt_right\">0.4048714</td>\n<td headers=\"g_l2fc\" class=\"gt_row gt_right\">3.570754</td>\n<td headers=\"g_z\" class=\"gt_row gt_right\">45.75627</td>\n<td headers=\"g_l2fcSE\" class=\"gt_row gt_right\">0.07803857</td></tr>\n    <tr><td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000188157.14</td>\n<td headers=\"gene_name\" class=\"gt_row gt_left\">AGRN</td>\n<td headers=\"intron\" class=\"gt_row gt_left\">chr1:1051815:1053752:clu_22_+</td>\n<td headers=\"cluster\" class=\"gt_row gt_left\">chr1:clu_22_+</td>\n<td headers=\"itype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"ctype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"deltapsi\" class=\"gt_row gt_right\">-0.3365948</td>\n<td headers=\"g_l2fc\" class=\"gt_row gt_right\">3.570754</td>\n<td headers=\"g_z\" class=\"gt_row gt_right\">45.75627</td>\n<td headers=\"g_l2fcSE\" class=\"gt_row gt_right\">0.07803857</td></tr>\n    <tr><td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000158286.12</td>\n<td headers=\"gene_name\" class=\"gt_row gt_left\">RNF207</td>\n<td headers=\"intron\" class=\"gt_row gt_left\">chr1:6212733:6213065:clu_111_+</td>\n<td headers=\"cluster\" class=\"gt_row gt_left\">chr1:clu_111_+</td>\n<td headers=\"itype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"ctype\" class=\"gt_row gt_left\">PR,UP</td>\n<td headers=\"deltapsi\" class=\"gt_row gt_right\">-0.7185528</td>\n<td headers=\"g_l2fc\" class=\"gt_row gt_right\">1.907734</td>\n<td headers=\"g_z\" class=\"gt_row gt_right\">16.39761</td>\n<td headers=\"g_l2fcSE\" class=\"gt_row gt_right\">0.11634224</td></tr>\n    <tr><td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000158286.12</td>\n<td headers=\"gene_name\" class=\"gt_row gt_left\">RNF207</td>\n<td headers=\"intron\" class=\"gt_row gt_left\">chr1:6212903:6213065:clu_111_+</td>\n<td headers=\"cluster\" class=\"gt_row gt_left\">chr1:clu_111_+</td>\n<td headers=\"itype\" class=\"gt_row gt_left\">UP</td>\n<td headers=\"ctype\" class=\"gt_row gt_left\">PR,UP</td>\n<td headers=\"deltapsi\" class=\"gt_row gt_right\">0.7185528</td>\n<td headers=\"g_l2fc\" class=\"gt_row gt_right\">1.907734</td>\n<td headers=\"g_z\" class=\"gt_row gt_right\">16.39761</td>\n<td headers=\"g_l2fcSE\" class=\"gt_row gt_right\">0.11634224</td></tr>\n    <tr><td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000171735.18</td>\n<td headers=\"gene_name\" class=\"gt_row gt_left\">CAMTA1</td>\n<td headers=\"intron\" class=\"gt_row gt_left\">chr1:7747781:7749770:clu_131_+</td>\n<td headers=\"cluster\" class=\"gt_row gt_left\">chr1:clu_131_+</td>\n<td headers=\"itype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"ctype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"deltapsi\" class=\"gt_row gt_right\">0.3256170</td>\n<td headers=\"g_l2fc\" class=\"gt_row gt_right\">1.330244</td>\n<td headers=\"g_z\" class=\"gt_row gt_right\">21.12208</td>\n<td headers=\"g_l2fcSE\" class=\"gt_row gt_right\">0.06297885</td></tr>\n    <tr><td headers=\"gene_id\" class=\"gt_row gt_left\">ENSG00000171735.18</td>\n<td headers=\"gene_name\" class=\"gt_row gt_left\">CAMTA1</td>\n<td headers=\"intron\" class=\"gt_row gt_left\">chr1:7747781:7751198:clu_131_+</td>\n<td headers=\"cluster\" class=\"gt_row gt_left\">chr1:clu_131_+</td>\n<td headers=\"itype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"ctype\" class=\"gt_row gt_left\">PR</td>\n<td headers=\"deltapsi\" class=\"gt_row gt_right\">-0.6950003</td>\n<td headers=\"g_l2fc\" class=\"gt_row gt_right\">1.330244</td>\n<td headers=\"g_z\" class=\"gt_row gt_right\">21.12208</td>\n<td headers=\"g_l2fcSE\" class=\"gt_row gt_right\">0.06297885</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\ndim(joined_dt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3603   10\n```\n\n\n:::\n\n```{.r .cell-code}\njoined_dt[, .(Ngene = uniqueN(gene_id), Nintron = uniqueN(intron))]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Ngene Nintron\n1:  1650    3603\n```\n\n\n:::\n:::\n\n\n\n\n### Compute correlation\n\nCompute correlation between intron's deltaPSI and gene's log2FC\n\n*Note for some reason quarto does not refresh the output of this cell, result is not correct!*\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor_res <- joined_dt %>% \n  split(by = 'itype') %>% \n  map(~cor.test(x = .x$g_z, y = .x$deltapsi, method = 'p')) %>% \n  imap_dfr(\n    \\(x, y) {\n      data.table(\n        cor = x$estimate,\n        p = x$`p.value`,\n        itype = y)\n    }\n  )\n\ncor_res \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           cor          p itype\n1:  0.02569642 0.14315331    PR\n2: -0.13544088 0.01062843    UP\n```\n\n\n:::\n:::\n\n\n\n### Plot correlation\n\n\n::: {.cell}\n\n```{.r .cell-code}\njoined_dt %>% \n  ggplot() +\n    geom_pointdensity(aes(g_z, deltapsi), size = .5, ) +\n    scale_color_viridis_c() + \n    geom_smooth(aes(g_z, deltapsi), method = \"lm\", formula = y~x, se = FALSE) +\n    labs(title = glue(\"{title}\", title = str_replace(contrast, \"_v_\", \" vs \")), \n         x = \"DGE: Log2FC (z)\",\n         y = \"deltaPSI\") +\n    facet_wrap(~itype, scales = \"free\")\n```\n\n::: {.cell-output-display}\n![Correlation between deltaPSI and log2FC in Brain-Cortex vs Muscle-Skeletal](2024-06-18-GTEx-DGE-vs-DS_files/figure-html/fig-correlation-BRNCTX-MUSCSKLT-1.png){#fig-correlation-BRNCTX-MUSCSKLT width=80%}\n:::\n:::\n\n\n\n## Unproductive splicing vs. expression for all GTEx tissue pairs\n\n\nHere, I try to compare the correlation between unproductive splicing and gene expression across all GTEx tissue pairs.\n\n\n### Prepare data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nread_contrast <- function(rds, contrast, FDR = 1e-5, selection = 'all') {\n  #' @params rds: path to rds file'\n  #' @params contrast: contrast name'\n  #' @params FDR: FDR threshold'\n  #' @params selection: 'all', 'maxClu', 'maxGene'.\n  #'                    Select all introns, max deltaPSI per cluster, or max deltaPSI per gene'\n\n\n\n  data <- readRDS(rds)\n  ds <- data$ds\n  dge <- data$dge\n  dge_dsc <- data$dge_dsc\n\n  joined_dt <- inner_join(\n    x = ds[abs(deltapsi) > .1 & `p.adjust` < FDR & ctype %in% c('PR', 'PR,UP'), \n          .(gene_id, gene_name, intron, cluster, itype, ctype, deltapsi)],\n    y = dge[, .(gene_id, g_l2fc = log2FoldChange, g_z = stat, g_l2fcSE = lfcSE)],\n    by = 'gene_id'\n  )\n\n  if (selection == 'maxClu') {\n    joined_dt  <- joined_dt[\n      , .(intron, deltapsi, g_l2fc, g_z, g_l2fcSE, rk = rank(-abs(deltapsi), ties.method = \"random\")), \n      by = .(gene_id, gene_name, cluster, itype, ctype)\n      ][rk == 1, -c('rk')]\n  } else if (selection == 'maxGene') {\n    joined_dt <- joined_dt[\n      , .(intron, deltapsi, g_l2fc, g_z, g_l2fcSE, rk = rank(-abs(deltapsi), ties.method = \"random\")), \n      by = .(gene_id, gene_name, itype)\n      ][rk == 1, -c('rk')]\n  }\n\n  # run cor.test\n  cor_res <- joined_dt %>% \n    split(by = 'itype') %>% \n    map(~cor.test(x = .x$g_z, y = .x$deltapsi, method = 'pearson')) %>% \n    imap_dfr(\n      \\(x, y) {\n        data.table(\n          cor = x$estimate,\n          p = x$`p.value`,\n          itype = y,\n          contrast = contrast)\n      }\n    )\n\n    # plot scatter plot\n    p  <- joined_dt %>% \n      ggplot() + \n        geom_pointdensity(aes(g_z, deltapsi), size = .5, alpha = .5) +\n        scale_color_viridis_c() + \n        geom_smooth(aes(g_z, deltapsi), method = \"lm\", formula = y~x, se = FALSE, color = 'blue', lwd = 1) +\n        geom_text(aes(x = 0,\n                      y = 0.1, \n                      label = paste(\"cor: \", round(cor, 3), \", \",\n                                    \"p. val: \", format(p, digits = 3, scientific = T), \n                                    sep = \"\")\n                      ),\n                  data = cor_res, color = 'blue', size = 4, vjust = 1) +\n        labs(x = \"DGE: Z-score\", y = \"DS: deltaPSI\", color = \"Num. points\", \n             title = str_wrap(str_replace_all(contrast, '_', ' '), width = 40)) +\n        facet_wrap(~itype)\n\n    return(list(cor_res = cor_res, gg = p, joineddf = joined_dt))\n\n}\n```\n:::\n\n\n\nLoad contrast ds, dge data.\n\nrds file and contrast name example:\n\n::: {.cell}\n\n```{.r .cell-code}\nrds_list <- dir('/project/yangili1/cdai/SpliFi/data/ds_v_dge', full.names = T, pattern = '*.rds')\nrds_list <- rds_list[str_detect(rds_list, \".+ds_v_dge.+_v_.+data.rds\")]\ncontrast_list <- str_split(rds_list, \"/\") %>% map(., last) %>% unlist %>% str_remove_all('_data\\\\.rds')\n\n\nhead(rds_list)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_AdrenalGland_data.rds\"                       \n[2] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Artery-Coronary_data.rds\"                    \n[3] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-Amygdala_data.rds\"                     \n[4] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-Anteriorcingulatecortex_BA24__data.rds\"\n[5] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-Caudate_basalganglia__data.rds\"        \n[6] \"/project/yangili1/cdai/SpliFi/data/ds_v_dge/Adipose-Visceral_Omentum__v_Brain-CerebellarHemisphere_data.rds\"         \n```\n\n\n:::\n\n```{.r .cell-code}\nhead(contrast_list)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Adipose-Visceral_Omentum__v_AdrenalGland\"                       \n[2] \"Adipose-Visceral_Omentum__v_Artery-Coronary\"                    \n[3] \"Adipose-Visceral_Omentum__v_Brain-Amygdala\"                     \n[4] \"Adipose-Visceral_Omentum__v_Brain-Anteriorcingulatecortex_BA24_\"\n[5] \"Adipose-Visceral_Omentum__v_Brain-Caudate_basalganglia_\"        \n[6] \"Adipose-Visceral_Omentum__v_Brain-CerebellarHemisphere\"         \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nFDR <- params$fdr\n```\n:::\n\n\n\nProcess all the contrast data using *FDR=1e\\-5*:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- map2(rds_list, contrast_list, read_contrast, FDR = 1e-5, selection = 'maxClu')\ndf <- map_dfr(res, ~.x$cor_res)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nres3 <- map2(rds_list, contrast_list, read_contrast, FDR = 1e-5, selection = 'all')\ndf3 <- map_dfr(res3, ~.x[['cor_res']])\n```\n:::\n\n\n### Plot all tissue pairs - DS vs. DGE\n\n\n::: {.cell outwidth='80%'}\n\n```{.r .cell-code}\ngg3 <- df3 %>% \n  ggplot() + geom_pointdensity(aes(cor, -log10(p), color = itype), size = .5, alpha = .9) +\n  scale_color_brewer(type = \"qual\", \n                     palette = 1,\n                     direction = 1,\n                     label = c(PR=\"Productive\", UP=\"Unproductive\"),\n                     name = NULL) +\n  lims(x = c(-.5, .2), y = c(0, 30)) +\n  geom_hline(yintercept = -log10(0.001), linetype = 2) +\n    labs(title = 'Correlation between differential gene\\nexpression and diffferential splicing',\n         x = 'Correlation',\n         y = '-log10(p-value)'\n         )\ngg3\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 3 rows containing non-finite values (`stat_pointdensity()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Correlation between deltaPSI and expression log2FC for all GTEx tissue pairs](2024-06-18-GTEx-DGE-vs-DS_files/figure-html/fig-ds-dge-corr-all-tissue-pairs-allintrons-1.png){#fig-ds-dge-corr-all-tissue-pairs-allintrons width=672}\n:::\n:::\n\n\n\n\n### Plot Brain-Cortex vs. Muscle-Skeletal - DS vs. DGE\n\n\n\n::: {.cell outwidth='80%'}\n\n```{.r .cell-code}\nid_to_plot <- map_chr(res, ~.x$cor_res[, contrast] %>% unique) %>% \n  str_detect(., \"Brain-Cortex_v_Muscle-Skeletal\") %>% \n  which\ngg <- pluck(res, id_to_plot) %>% pluck('gg')\ngg\n```\n\n::: {.cell-output-display}\n![Correlation between deltaPSI and expression log2FC in Brain-Cortex vs Muscle-Skeletal](2024-06-18-GTEx-DGE-vs-DS_files/figure-html/fig-ds-dge-corr-brain-cortex-muscle-skeletal-maxClu-1.png){#fig-ds-dge-corr-brain-cortex-muscle-skeletal-maxClu width=768}\n:::\n:::\n\n\n\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}