{
  "hash": "a75d6a188df4cea578c6b0310a99a744",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"GTEx sQTL enrichment - updated (V4) - different pseudocount\"\ndate: 2024-8-15\ncategories: ['qtl']\ncode-fold: true\nexecute:\n  include: true\n  eval: true\n  cache: false\n  echo: false\n---\n\n\n\n::: {.callout-note}\nChanged pseducount count method in phenotype prep script\n\n-  from: $\\frac{num + 0.5 }{ denom + 0.5}$\n-  to  : $\\frac{num + addon }{ denom + addon}$, where `addon = denom * .01 if denom < 100 else 0.05`\n\n:::\n\n\n\nThe underlying data for both the qqplot and the scatter plot are the from this procedure:\n\n1. Map sQTLs using permutation pass with QTLtools against leafcutter2 output. Each phenotype is an intron.\n2. Permpass result report a top SNP for each intron. Use the collection of these top SNPs to subset genotype VCF file. \n3. Run nominal pass for eQTL with expression data and the subsetted genotype VCF file. This effectively run regression analysis of each top sQTL SNP against gene expression.\n\nThen for the qqplot, I plotted the pvalue of expression regression for each productive vs. unproductive sQTLs top SNP.\n\nFor the scatter plot, each top SNP is the top SNP of a productive or unprodutive sQTL. X axis is SNP's regression slope for gene expression, and Y axis is the regression slope of splicing.\n\nNote each sQTL is either a productive or unproductive sQTLs, and represent a intron cluster. A productive sQTL is a cluster that only have productive introns. The strongest intron is chosen to represent the cluster (instead of aggregated of all the introns). \n\nAn unproductive sQTL is a cluster that has both productive intron and unproductive introns with permutation pass q value < 0.1. The best intron (largest top SNP slope) is chosen to represent the cluster as unproductive sQTL. Note, comparing to previous version, here for u-sQTLs (ctype = PR,UP) select the best unproductive intron to represent the cluster.\n\n::: {.callout-note}\nThis update removed the following categories of SNPs from the GTEx VEP annotation file:\n\n  - enhancer_d\n  - promoter_d\n  - promoter_flanking_region_d\n\nqqplot Y axis is flipped if sQTL slope and eQTL slope are in opposite direction.\n:::\n\n\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n\n\n# Enrichment of sQTL in eQTL pvalues\n\n\n\n::: {.cell .column-screen layout-ncol=\"4\"}\n::: {.cell-output-display}\n![qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)](../smk-plots/gtex-sqtl-enrichment-v4-test/Brain-Hippocampus-qqplot.png){#fig-qqplot-eQTL-sQTL-diff-direction-1 width=100%}\n:::\n\n::: {.cell-output-display}\n![qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)](../smk-plots/gtex-sqtl-enrichment-v4-test/Kidney-Cortex-qqplot.png){#fig-qqplot-eQTL-sQTL-diff-direction-2 width=100%}\n:::\n\n::: {.cell-output-display}\n![qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)](../smk-plots/gtex-sqtl-enrichment-v4-test/Liver-qqplot.png){#fig-qqplot-eQTL-sQTL-diff-direction-3 width=100%}\n:::\n\n::: {.cell-output-display}\n![qqplot of eQTL pvalues of sQTL top SNPs (new pseudocount)](../smk-plots/gtex-sqtl-enrichment-v4-test/Muscle-Skeletal-qqplot.png){#fig-qqplot-eQTL-sQTL-diff-direction-4 width=100%}\n:::\n:::\n\n::: {.cell .column-screen layout-ncol=\"4\"}\n::: {.cell-output-display}\n![](../smk-plots/gtex-sqtl-enrichment-v4/Brain-Hippocampus-qqplot.png){#fig-qqplot-eQTL-sQTL-diff-direction-old-1 width=100%}\n:::\n\n::: {.cell-output-display}\n![](../smk-plots/gtex-sqtl-enrichment-v4/Kidney-Cortex-qqplot.png){#fig-qqplot-eQTL-sQTL-diff-direction-old-2 width=100%}\n:::\n\n::: {.cell-output-display}\n![](../smk-plots/gtex-sqtl-enrichment-v4/Liver-qqplot.png){#fig-qqplot-eQTL-sQTL-diff-direction-old-3 width=100%}\n:::\n\n::: {.cell-output-display}\n![](../smk-plots/gtex-sqtl-enrichment-v4/Muscle-Skeletal-qqplot.png){#fig-qqplot-eQTL-sQTL-diff-direction-old-4 width=100%}\n:::\n:::\n\n\n# Comparison of sQTL (top SNP beta) and eQTL effect size (nominal beta of same top sQTL SNP)\n\n::: {.callout-note}\n\n- cor.test used pearson correlation\n\n:::\n\n\n\n::: {.cell .column-screen layout-ncol=\"4\"}\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size (new pseudocount)](../smk-plots/gtex-sqtl-enrichment-v4-test/Brain-Hippocampus-scatter.png){#fig-scatterplots-1 width=100%}\n:::\n\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size (new pseudocount)](../smk-plots/gtex-sqtl-enrichment-v4-test/Kidney-Cortex-scatter.png){#fig-scatterplots-2 width=100%}\n:::\n\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size (new pseudocount)](../smk-plots/gtex-sqtl-enrichment-v4-test/Liver-scatter.png){#fig-scatterplots-3 width=100%}\n:::\n\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size (new pseudocount)](../smk-plots/gtex-sqtl-enrichment-v4-test/Muscle-Skeletal-scatter.png){#fig-scatterplots-4 width=100%}\n:::\n:::\n\n::: {.cell .column-screen layout-ncol=\"4\"}\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size (old)](../smk-plots/gtex-sqtl-enrichment-v4/Brain-Hippocampus-scatter.png){#fig-scatterplots-old-1 width=100%}\n:::\n\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size (old)](../smk-plots/gtex-sqtl-enrichment-v4/Kidney-Cortex-scatter.png){#fig-scatterplots-old-2 width=100%}\n:::\n\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size (old)](../smk-plots/gtex-sqtl-enrichment-v4/Liver-scatter.png){#fig-scatterplots-old-3 width=100%}\n:::\n\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size (old)](../smk-plots/gtex-sqtl-enrichment-v4/Muscle-Skeletal-scatter.png){#fig-scatterplots-old-4 width=100%}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}