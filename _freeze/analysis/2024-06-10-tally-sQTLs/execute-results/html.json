{
  "hash": "457659e0298c03dae85066981ba0757b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"QTL tally\"\ndate: 2024-6-10\nparams: \n  fdr: 0.1\ncategories: ['qtl']\ncode-fold: true\nexecute:\n  include: true\n  cache: false\n---\n\n\n\n\n# Tally sQTLs from GTEx 49 tissues and Geuvadis EUR\n\n\n## Geuvaids EUR\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbase.geu <- \"../code/results/qtl/noisy/Geuvadis/EUR/separateNoise/cis_100000/perm\"\ngeu.sql.f <- glue(\"{base}/chr{chroms}.addQval.txt.gz\", base = base.geu, chroms = 1:22)\nnames(geu.sql.f) <- glue(\"chr{1:22}\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngeu.sql <- map_dfr(geu.sql.f, fread)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\naddLabels <- function(dt) {\n  pid_split <- str_split(dt$phenotype_id, \":\")\n  dt$itype <- map_chr(pid_split, ~ .x[5])\n  dt$clu <- map_chr(pid_split, ~ .x[4])\n  dt$clu <- str_extract(dt$clu, \"clu_[0-9]+\")\n\n  dt <- dt[, ctype := paste(sort(unique(itype)), collapse = \",\"), by = clu][]\n  return(dt)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngeu.sql <- addLabels(geu.sql)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngeu.sql[1:2, ] %>% DT::datatable()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-3c6647d06b05e5496bdd\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-3c6647d06b05e5496bdd\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\"],[\"chr1:15947:16606:clu_3223_-:IN\",\"chr1:16310:16606:clu_3223_-:IN\"],[\"chr1\",\"chr1\"],[15948,16311],[16606,16606],[\"-\",\"-\"],[69,69],[-779,-91704],[\"1:17385:G:A\",\"1:108310:T:C\"],[\"chr1\",\"chr1\"],[17385,108310],[17385,108310],[358,358],[332.531,351.55],[0.971271,0.988301],[32.4891,39.5983],[0.00150657,0.008257280000000001],[0.0277762,0.0193263],[0.344664,0.200482],[0.08091909999999999,0.315684],[0.0762255,0.302397],[0.2956,0.55159],[\"IN\",\"IN\"],[\"clu_3223\",\"clu_3223\"],[\"IN\",\"IN\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>phenotype_id<\\/th>\\n      <th>phenotype_chr<\\/th>\\n      <th>phenotype_start<\\/th>\\n      <th>phenotype_end<\\/th>\\n      <th>phenotype_strand<\\/th>\\n      <th>num_variants<\\/th>\\n      <th>best_nom_dist<\\/th>\\n      <th>best_genotype_id<\\/th>\\n      <th>best_genotype_chr<\\/th>\\n      <th>best_genotype_start<\\/th>\\n      <th>best_genotype_end<\\/th>\\n      <th>dof_true<\\/th>\\n      <th>dof_est<\\/th>\\n      <th>beta_ml1<\\/th>\\n      <th>beta_ml2<\\/th>\\n      <th>pval_nom<\\/th>\\n      <th>pval_r2<\\/th>\\n      <th>slope<\\/th>\\n      <th>pval_emp<\\/th>\\n      <th>pval_adj<\\/th>\\n      <th>q<\\/th>\\n      <th>itype<\\/th>\\n      <th>clu<\\/th>\\n      <th>ctype<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4,6,7,10,11,12,13,14,15,16,17,18,19,20,21]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"phenotype_id\",\"targets\":1},{\"name\":\"phenotype_chr\",\"targets\":2},{\"name\":\"phenotype_start\",\"targets\":3},{\"name\":\"phenotype_end\",\"targets\":4},{\"name\":\"phenotype_strand\",\"targets\":5},{\"name\":\"num_variants\",\"targets\":6},{\"name\":\"best_nom_dist\",\"targets\":7},{\"name\":\"best_genotype_id\",\"targets\":8},{\"name\":\"best_genotype_chr\",\"targets\":9},{\"name\":\"best_genotype_start\",\"targets\":10},{\"name\":\"best_genotype_end\",\"targets\":11},{\"name\":\"dof_true\",\"targets\":12},{\"name\":\"dof_est\",\"targets\":13},{\"name\":\"beta_ml1\",\"targets\":14},{\"name\":\"beta_ml2\",\"targets\":15},{\"name\":\"pval_nom\",\"targets\":16},{\"name\":\"pval_r2\",\"targets\":17},{\"name\":\"slope\",\"targets\":18},{\"name\":\"pval_emp\",\"targets\":19},{\"name\":\"pval_adj\",\"targets\":20},{\"name\":\"q\",\"targets\":21},{\"name\":\"itype\",\"targets\":22},{\"name\":\"clu\",\"targets\":23},{\"name\":\"ctype\",\"targets\":24}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### All phenotypes/introns\nNumber of introns\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngeu.sql[, .N, by = itype\n  ][, .(itype, N, P = N/sum(N)  )\n  ][order(-N)]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    itype     N          P\n   <char> <int>      <num>\n1:     PR 83826 0.63891768\n2:     UP 29665 0.22610518\n3:     IN 11756 0.08960366\n4:     NE  5953 0.04537348\n```\n\n\n:::\n:::\n\n\nNumber of clusters\n\n::: {.cell}\n\n```{.r .cell-code}\ngeu.sql[, .(N = uniqueN(clu)), by = .(ctype)][, .(ctype, N, P = N/sum(N))][order(-N)]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          ctype     N            P\n         <char> <int>        <num>\n 1:          PR 21693 0.4992175634\n 2:       PR,UP 14598 0.3359414553\n 3:          IN  2943 0.0677267915\n 4:       NE,PR  2154 0.0495696599\n 5:    NE,PR,UP  1277 0.0293873982\n 6:          UP   488 0.0112302665\n 7:          NE    72 0.0016569246\n 8:    IN,PR,UP    53 0.0012196806\n 9:       IN,UP    43 0.0009895522\n10:       IN,PR    38 0.0008744880\n11:    IN,NE,PR    31 0.0007133981\n12: IN,NE,PR,UP    22 0.0005062825\n13:       IN,NE    20 0.0004602568\n14:       NE,UP    17 0.0003912183\n15:    IN,NE,UP     5 0.0001150642\n```\n\n\n:::\n:::\n\n\n\n### Use FDR 0.1 to filter sQTLs\n\nNumber of introns with FDR < 0.1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFDR = params$fdr\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngeu.sql[q < FDR, .N, by = .(itype)][, .(itype, N, P = N/sum(N))][order(-N)]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    itype     N          P\n   <char> <int>      <num>\n1:     PR  9092 0.54777684\n2:     UP  3981 0.23984817\n3:     IN  2690 0.16206772\n4:     NE   835 0.05030727\n```\n\n\n:::\n:::\n\n\n\nNumber of clusters with FDR < 0.1\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngeu.sql[q < FDR, .(N = uniqueN(clu)), by = .(ctype)][, .(ctype, N, P = N/sum(N))][order(-N)]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          ctype     N            P\n         <char> <int>        <num>\n 1:       PR,UP  3391 0.4070828331\n 2:          PR  2405 0.2887154862\n 3:          IN   971 0.1165666267\n 4:       NE,PR   700 0.0840336134\n 5:    NE,PR,UP   642 0.0770708283\n 6:          UP    86 0.0103241297\n 7:    IN,PR,UP    27 0.0032412965\n 8:       IN,PR    22 0.0026410564\n 9:    IN,NE,PR    21 0.0025210084\n10:       IN,UP    20 0.0024009604\n11: IN,NE,PR,UP    17 0.0020408163\n12:          NE    15 0.0018007203\n13:       IN,NE     8 0.0009603842\n14:       NE,UP     4 0.0004801921\n15:    IN,NE,UP     1 0.0001200480\n```\n\n\n:::\n:::\n\n\n\n\n### Use FDR 0.1 to filter sQTLs, and only keep introns from clusters of `PR` or `PR,UP`\n\nNumber of introns satisfying FDR < 0.1 and from clusters of `PR` or `PR,UP`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngeu.sql[q < FDR & ctype %in% c(\"PR\", \"PR,UP\"), .N, by = .(itype)][, .(itype, N, P = N/sum(N))][order(-N)]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    itype     N         P\n   <char> <int>     <num>\n1:     PR  6960 0.6886998\n2:     UP  3146 0.3113002\n```\n\n\n:::\n:::\n\n\nNumber of clusters satisfying FDR < 0.1 and from clusters of `PR` or `PR,UP`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngeu.sql[q < FDR & ctype %in% c(\"PR\", \"PR,UP\"), .(N = uniqueN(clu)), by = .(ctype)][, .(ctype, N, P = N/sum(N))][order(-N)]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    ctype     N         P\n   <char> <int>     <num>\n1:  PR,UP  3391 0.5850587\n2:     PR  2405 0.4149413\n```\n\n\n:::\n:::\n\n \n\n## GTEx\n\nFor GTEx, use sQTLs from 49 tissues. We use FDR < 0.1 and cluster type `PR` or `PR,UP` to filter sQTLs.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTissues <- dir(\"../code/results/qtl/noisy/GTEx/\")\nTissues <- Tissues[!Tissues %in% c(\"Bladder\")]\nnames(Tissues) <- Tissues \nbase1.gtex <- \"../code/results/qtl/noisy/GTEx\"\nbase2.gtex <- \"/cis_100000/perm\"\nsuffix <- \"addQval.txt.gz\"\n# \"../code/results/qtl/noisy/GTEx/Liver/separateNoise/cis_100000/perm/chr1.addQval.txt.gz\"\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreadGTExSQTL <- function(tissue) {\n  base1.gtex <- \"../code/results/qtl/noisy/GTEx/\"\n  base2.gtex <- \"/cis_100000/perm\"\n  suffix <- \"addQval.txt.gz\"\n  folder <- glue(\"{base1.gtex}/{tissue}/separateNoise{base2.gtex}\")\n  files <- glue(\"{folder}/chr{1:22}.{suffix}\")\n  dt <- map_dfr(files, fread)\n}\n```\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngtex.sqls <- readRDS(\"2024-06-10-gtex-sQTLs.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntissue.labels <- fread(\"/project/yangili1/cdai/splice-pub/analysis/gtex-tissue-code.csv\",\n                      col.names = c(\"tissue\", \"label\"), header = F)\n```\n:::\n\n\n\nNumber of introns that satisfy FDR < 0.1 and from clusters of `PR` or `PR,UP`\n\n::: {.cell}\n\n```{.r .cell-code}\ngtex.plot1.dt <- imap_dfr(gtex.sqls, \\(x, y) {x[q < FDR & ctype %in% c(\"PR\", \"PR,UP\"), .N, by = .(itype)][, .(tissue = y, itype, N, P = N/sum(N))][order(-N)]})\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngtex.plot1.dt %>% \n  left_join(y = tissue.labels, by = \"tissue\") %>% \n  ggplot() + geom_col(aes(x = forcats::fct_reorder(label, -N), y = N, fill = itype)) +\n    scale_fill_brewer(palette = \"Blues\", direction = 1) +\n    labs(x = NULL, y = \"Num. of sQTL introns\", fill = NULL) + \n    theme_cowplot() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1),\n          legend.position = \"top\"\n         )\n```\n\n::: {.cell-output-display}\n![](2024-06-10-tally-sQTLs_files/figure-html/fig-gtex_sqtl_by_intron-1.png){#fig-gtex_sqtl_by_intron width=100%}\n:::\n:::\n\n::: {#tbl-gtex-sqtl-by-intron .cell}\n\n```{.r .cell-code}\ngtex.plot1.dt %>% DT::datatable()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-2b152011ee15c8b5055b\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-2b152011ee15c8b5055b\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\"],[\"Adipose-Subcutaneous\",\"Adipose-Subcutaneous\",\"Adipose-Visceral_Omentum_\",\"Adipose-Visceral_Omentum_\",\"AdrenalGland\",\"AdrenalGland\",\"Artery-Aorta\",\"Artery-Aorta\",\"Artery-Coronary\",\"Artery-Coronary\",\"Artery-Tibial\",\"Artery-Tibial\",\"Brain-Amygdala\",\"Brain-Amygdala\",\"Brain-Anteriorcingulatecortex_BA24_\",\"Brain-Anteriorcingulatecortex_BA24_\",\"Brain-Caudate_basalganglia_\",\"Brain-Caudate_basalganglia_\",\"Brain-CerebellarHemisphere\",\"Brain-CerebellarHemisphere\",\"Brain-Cerebellum\",\"Brain-Cerebellum\",\"Brain-Cortex\",\"Brain-Cortex\",\"Brain-FrontalCortex_BA9_\",\"Brain-FrontalCortex_BA9_\",\"Brain-Hippocampus\",\"Brain-Hippocampus\",\"Brain-Hypothalamus\",\"Brain-Hypothalamus\",\"Brain-Nucleusaccumbens_basalganglia_\",\"Brain-Nucleusaccumbens_basalganglia_\",\"Brain-Putamen_basalganglia_\",\"Brain-Putamen_basalganglia_\",\"Brain-Spinalcord_cervicalc-1_\",\"Brain-Spinalcord_cervicalc-1_\",\"Brain-Substantianigra\",\"Brain-Substantianigra\",\"Breast-MammaryTissue\",\"Breast-MammaryTissue\",\"Cells-Culturedfibroblasts\",\"Cells-Culturedfibroblasts\",\"Cells-EBV-transformedlymphocytes\",\"Cells-EBV-transformedlymphocytes\",\"Colon-Sigmoid\",\"Colon-Sigmoid\",\"Colon-Transverse\",\"Colon-Transverse\",\"Esophagus-GastroesophagealJunction\",\"Esophagus-GastroesophagealJunction\",\"Esophagus-Mucosa\",\"Esophagus-Mucosa\",\"Esophagus-Muscularis\",\"Esophagus-Muscularis\",\"Heart-AtrialAppendage\",\"Heart-AtrialAppendage\",\"Heart-LeftVentricle\",\"Heart-LeftVentricle\",\"Kidney-Cortex\",\"Kidney-Cortex\",\"Liver\",\"Liver\",\"Lung\",\"Lung\",\"MinorSalivaryGland\",\"MinorSalivaryGland\",\"Muscle-Skeletal\",\"Muscle-Skeletal\",\"Nerve-Tibial\",\"Nerve-Tibial\",\"Ovary\",\"Ovary\",\"Pancreas\",\"Pancreas\",\"Pituitary\",\"Pituitary\",\"Prostate\",\"Prostate\",\"Skin-NotSunExposed_Suprapubic_\",\"Skin-NotSunExposed_Suprapubic_\",\"Skin-SunExposed_Lowerleg_\",\"Skin-SunExposed_Lowerleg_\",\"SmallIntestine-TerminalIleum\",\"SmallIntestine-TerminalIleum\",\"Spleen\",\"Spleen\",\"Stomach\",\"Stomach\",\"Testis\",\"Testis\",\"Thyroid\",\"Thyroid\",\"Uterus\",\"Uterus\",\"Vagina\",\"Vagina\",\"WholeBlood\",\"WholeBlood\"],[\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\",\"PR\",\"UP\"],[11510,2865,9502,2323,5240,1212,8059,1888,4622,1107,11020,2619,1954,417,2746,575,3809,845,4651,1202,5448,1358,4445,996,3530,766,2550,580,3132,719,3848,890,2942,632,2416,545,1721,353,8553,2220,11264,2393,4683,1045,6974,1698,7608,1892,7277,1726,9357,2130,9402,2260,7013,1610,5438,1165,1099,243,3077,776,10661,2700,3496,857,10118,2222,11730,3052,3984,1097,4779,1208,6071,1581,5059,1361,9922,2461,11352,2788,4058,1057,5477,1424,5812,1467,13233,3727,12442,3153,3156,822,3124,823,7365,1768],[0.800695652173913,0.199304347826087,0.8035517970401691,0.1964482029598309,0.8121512709237446,0.1878487290762554,0.8101940283502563,0.1898059716497436,0.80677256065631,0.19322743934369,0.8079771244226116,0.1920228755773884,0.8241248418388866,0.1758751581611135,0.8268593797049082,0.1731406202950918,0.8184357541899442,0.1815642458100559,0.7946352297966854,0.2053647702033145,0.8004701733764326,0.1995298266235674,0.8169454144458739,0.1830545855541261,0.8216945996275605,0.1783054003724395,0.8146964856230032,0.1853035143769968,0.8132952479875357,0.1867047520124643,0.8121570282819756,0.1878429717180245,0.8231673195299385,0.1768326804700616,0.8159405606214117,0.1840594393785883,0.8297974927675988,0.1702025072324012,0.7939292676134782,0.2060707323865218,0.8247785018671744,0.1752214981328257,0.8175628491620112,0.1824371508379888,0.8041974169741697,0.1958025830258303,0.8008421052631579,0.1991578947368421,0.8082861268466067,0.1917138731533933,0.8145729955601985,0.1854270044398015,0.8062081975647402,0.1937918024352598,0.8132900382697437,0.1867099617302563,0.8235650461911252,0.1764349538088748,0.8189269746646796,0.1810730253353204,0.7985984946794705,0.2014015053205294,0.797919317416361,0.202080682583639,0.8031242821042959,0.1968757178957041,0.819935170178282,0.180064829821718,0.7935326748748478,0.2064673251251522,0.7840976185790198,0.2159023814209801,0.7982294972440287,0.2017705027559713,0.7933873497124935,0.2066126502875065,0.7880062305295951,0.211993769470405,0.8012597916498425,0.1987402083501575,0.8028288543140029,0.1971711456859972,0.7933528836754643,0.2066471163245357,0.7936530937545283,0.2063469062454717,0.7984613271053717,0.2015386728946284,0.7802476415094339,0.219752358490566,0.7978198140429625,0.2021801859570375,0.7933634992458521,0.2066365007541478,0.7914872054725107,0.2085127945274892,0.8064162925654221,0.1935837074345779]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>tissue<\\/th>\\n      <th>itype<\\/th>\\n      <th>N<\\/th>\\n      <th>P<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"tissue\",\"targets\":1},{\"name\":\"itype\",\"targets\":2},{\"name\":\"N\",\"targets\":3},{\"name\":\"P\",\"targets\":4}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nNumber of clusters that satisfy FDR < 0.1 and from clusters of `PR` or `PR,UP`\n\n::: {.cell}\n\n```{.r .cell-code}\ngtex.plot2.dt <- imap_dfr(gtex.sqls, \\(x, y) {\n  x[q < FDR & ctype %in% c(\"PR\", \"PR,UP\"), .(N = uniqueN(clu)), by = .(ctype)][, .(tissue = y, ctype, N, P = N/sum(N))][order(-N)]\n}\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngtex.plot2.dt %>% \n  left_join(y = tissue.labels, by = \"tissue\") %>% \n  ggplot() + geom_col(aes(x = forcats::fct_reorder(label, -N), y = N, fill = ctype)) +\n    scale_fill_brewer(palette = \"Blues\", direction = 1) +\n    labs(x = NULL, y = \"Num. of sQTL (cluster)\", fill = NULL) + \n    theme_cowplot() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1),\n          legend.position = \"top\"\n         )\n```\n\n::: {.cell-output-display}\n![](2024-06-10-tally-sQTLs_files/figure-html/fig-gtex_sqtl_by_cluster-1.png){#fig-gtex_sqtl_by_cluster width=100%}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\"2024-06-10-gtex-sqtl-tally-by-tissue.svg\", width = 8, height = 4)\n```\n:::\n\n::: {#tbl-gtex-sqtl-by-cluster .cell}\n\n```{.r .cell-code}\ngtex.plot2.dt %>% DT::datatable()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-a1e9f5bc9d19deaaeedf\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-a1e9f5bc9d19deaaeedf\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\"],[\"Adipose-Subcutaneous\",\"Adipose-Subcutaneous\",\"Adipose-Visceral_Omentum_\",\"Adipose-Visceral_Omentum_\",\"AdrenalGland\",\"AdrenalGland\",\"Artery-Aorta\",\"Artery-Aorta\",\"Artery-Coronary\",\"Artery-Coronary\",\"Artery-Tibial\",\"Artery-Tibial\",\"Brain-Amygdala\",\"Brain-Amygdala\",\"Brain-Anteriorcingulatecortex_BA24_\",\"Brain-Anteriorcingulatecortex_BA24_\",\"Brain-Caudate_basalganglia_\",\"Brain-Caudate_basalganglia_\",\"Brain-CerebellarHemisphere\",\"Brain-CerebellarHemisphere\",\"Brain-Cerebellum\",\"Brain-Cerebellum\",\"Brain-Cortex\",\"Brain-Cortex\",\"Brain-FrontalCortex_BA9_\",\"Brain-FrontalCortex_BA9_\",\"Brain-Hippocampus\",\"Brain-Hippocampus\",\"Brain-Hypothalamus\",\"Brain-Hypothalamus\",\"Brain-Nucleusaccumbens_basalganglia_\",\"Brain-Nucleusaccumbens_basalganglia_\",\"Brain-Putamen_basalganglia_\",\"Brain-Putamen_basalganglia_\",\"Brain-Spinalcord_cervicalc-1_\",\"Brain-Spinalcord_cervicalc-1_\",\"Brain-Substantianigra\",\"Brain-Substantianigra\",\"Breast-MammaryTissue\",\"Breast-MammaryTissue\",\"Cells-Culturedfibroblasts\",\"Cells-Culturedfibroblasts\",\"Cells-EBV-transformedlymphocytes\",\"Cells-EBV-transformedlymphocytes\",\"Colon-Sigmoid\",\"Colon-Sigmoid\",\"Colon-Transverse\",\"Colon-Transverse\",\"Esophagus-GastroesophagealJunction\",\"Esophagus-GastroesophagealJunction\",\"Esophagus-Mucosa\",\"Esophagus-Mucosa\",\"Esophagus-Muscularis\",\"Esophagus-Muscularis\",\"Heart-AtrialAppendage\",\"Heart-AtrialAppendage\",\"Heart-LeftVentricle\",\"Heart-LeftVentricle\",\"Kidney-Cortex\",\"Kidney-Cortex\",\"Liver\",\"Liver\",\"Lung\",\"Lung\",\"MinorSalivaryGland\",\"MinorSalivaryGland\",\"Muscle-Skeletal\",\"Muscle-Skeletal\",\"Nerve-Tibial\",\"Nerve-Tibial\",\"Ovary\",\"Ovary\",\"Pancreas\",\"Pancreas\",\"Pituitary\",\"Pituitary\",\"Prostate\",\"Prostate\",\"Skin-NotSunExposed_Suprapubic_\",\"Skin-NotSunExposed_Suprapubic_\",\"Skin-SunExposed_Lowerleg_\",\"Skin-SunExposed_Lowerleg_\",\"SmallIntestine-TerminalIleum\",\"SmallIntestine-TerminalIleum\",\"Spleen\",\"Spleen\",\"Stomach\",\"Stomach\",\"Testis\",\"Testis\",\"Thyroid\",\"Thyroid\",\"Uterus\",\"Uterus\",\"Vagina\",\"Vagina\",\"WholeBlood\",\"WholeBlood\"],[\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\",\"PR\",\"PR,UP\"],[4008,3099,3353,2558,1978,1444,2906,2123,1712,1372,3815,2890,828,573,1152,766,1500,1078,1767,1417,2041,1604,1746,1249,1426,971,1055,755,1263,923,1520,1111,1226,807,982,724,736,499,3041,2439,4065,2599,1745,1228,2533,1948,2767,2155,2681,1970,3404,2410,3356,2471,2653,1842,2096,1415,457,339,1199,909,3698,2977,1340,1038,3717,2415,3985,3211,1465,1294,1852,1367,2259,1828,1850,1589,3495,2692,4027,3000,1539,1276,2000,1597,2198,1680,4355,3846,4273,3283,1206,984,1204,1009,2632,1973],[0.5639510341916421,0.4360489658083579,0.5672475046523431,0.4327524953476569,0.5780245470485097,0.4219754529514904,0.5778484788228276,0.4221515211771724,0.5551232166018158,0.4448767833981842,0.5689783743475019,0.4310216256524981,0.5910064239828694,0.4089935760171306,0.6006256517205423,0.3993743482794578,0.5818463925523661,0.4181536074476338,0.554962311557789,0.445037688442211,0.5599451303155006,0.4400548696844993,0.5829716193656094,0.4170283806343906,0.5949103045473508,0.4050896954526492,0.5828729281767956,0.4171270718232044,0.5777676120768527,0.4222323879231473,0.5777270999619917,0.4222729000380084,0.603049680275455,0.396950319724545,0.5756154747948418,0.4243845252051583,0.5959514170040486,0.4040485829959514,0.55492700729927,0.4450729927007299,0.6099939975990396,0.3900060024009604,0.5869492095526404,0.4130507904473596,0.5652756081231868,0.4347243918768132,0.5621698496546119,0.4378301503453881,0.5764351752311331,0.4235648247688669,0.5854833161334709,0.4145166838665291,0.5759395915565471,0.4240604084434529,0.5902113459399333,0.4097886540600668,0.5969809171176303,0.4030190828823697,0.5741206030150754,0.4258793969849246,0.568785578747628,0.4312144212523719,0.5540074906367041,0.4459925093632959,0.5634987384356602,0.4365012615643398,0.6061643835616438,0.3938356164383562,0.5537798777098388,0.4462201222901612,0.53098948894527,0.46901051105473,0.5753339546442995,0.4246660453557005,0.5527281624663567,0.4472718375336432,0.5379470776388485,0.4620529223611515,0.564894132859221,0.435105867140779,0.5730752810587733,0.4269247189412267,0.5467140319715809,0.4532859680284192,0.5560189046427578,0.4439810953572422,0.5667870036101083,0.4332129963898917,0.5310328008779417,0.4689671991220583,0.5655108523028057,0.4344891476971943,0.5506849315068493,0.4493150684931507,0.54405784003615,0.45594215996385,0.5715526601520087,0.4284473398479913]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>tissue<\\/th>\\n      <th>ctype<\\/th>\\n      <th>N<\\/th>\\n      <th>P<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"tissue\",\"targets\":1},{\"name\":\"ctype\",\"targets\":2},{\"name\":\"N\",\"targets\":3},{\"name\":\"P\",\"targets\":4}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}