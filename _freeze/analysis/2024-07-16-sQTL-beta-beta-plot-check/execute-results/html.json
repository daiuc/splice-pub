{
  "hash": "2a140e78605d6fc091778014307fb936",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Check sqtl beta beta corr plot\"\ndate: 2024-7-16\nformat: html\ncategories: ['corr', 'sqtl']\ncode-fold: true\nexecute:\n  include: true\n  eval: true\n  cache: false\n  echo: false\n---\n\n\n\n# Check sqtl beta beta corr plot\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"../smk-plots/gtex-sqtl-enrichment-v4/Cells-EBV-transformedlymphocytes-scatter.png\"\n[2] \"../smk-plots/gtex-sqtl-enrichment-v4/Liver-scatter.png\"                           \n[3] \"../smk-plots/gtex-sqtl-enrichment-v4/WholeBlood-scatter.png\"                      \n```\n\n\n:::\n:::\n\n::: {.cell .column-page layout-ncol=\"4\"}\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size](../smk-plots/gtex-sqtl-enrichment-v4/Cells-EBV-transformedlymphocytes-scatter.png){#fig-scatterplots-1 width=100%}\n:::\n\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size](../smk-plots/gtex-sqtl-enrichment-v4/Liver-scatter.png){#fig-scatterplots-2 width=100%}\n:::\n\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size](../smk-plots/gtex-sqtl-enrichment-v4/WholeBlood-scatter.png){#fig-scatterplots-3 width=100%}\n:::\n:::\n\n\n\n# Take a closer look at whole blood\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n**Consider selecting random intron for PR**\n**also try random selection for UP**\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nRemoved 105 transcriptional snps\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Transformation introduced infinite values in continuous x-axis\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 327 rows containing non-finite values (`stat_ecdf()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](2024-07-16-sQTL-beta-beta-plot-check_files/figure-html/plot cnt summary-1.png){width=672}\n:::\n:::\n\n\nRemove introns with low read counts (less than 10 reads).\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Number of sQTLs removed due to low read counts:\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   ctype    N\n1: PR,UP  174\n2:    PR 1078\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Number of sQTLs remaining:\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   ctype   N\n1:    PR 786\n2: PR,UP 653\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nCorrelation test for Cells\\-EBV\\-transformedlymphocytes:\n\nOriginal:\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n          ctype         pval   estimate xpos ypos\nPR   Productive 1.022677e-05 -0.1551985    0    0\nUP Unproductive 1.278154e-17 -0.3239933    0    0\n```\n\n\n:::\n:::\n\n\nsplit by intron bins:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n    ctype binsbyMean   N\n 1:    PR      (0,1] 168\n 2:    PR      (1,2] 130\n 3:    PR      (2,5] 255\n 4:    PR     (5,10] 248\n 5:    PR    (10,20] 238\n 6:    PR    (20,50] 309\n 7:    PR   (50,100] 205\n 8:    PR  (100,Inf] 338\n 9: PR,UP      (0,1] 151\n10: PR,UP      (1,2] 126\n11: PR,UP      (2,5] 237\n12: PR,UP     (5,10] 147\n13: PR,UP    (10,20]  98\n14: PR,UP    (20,50]  58\n15: PR,UP   (50,100]  12\n16: PR,UP  (100,Inf]   6\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n\n::: {#fig-elephants layout-ncol=2}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![before removing low reads](../smk-plots/gtex-sqtl-enrichment-v4/Cells-EBV-transformedlymphocytes-scatter.png){width=700}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![after removing low reads](2024-07-16-sQTL-beta-beta-plot-check_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\nBeta beta correlation plot for Cells\\-EBV\\-transformedlymphocytes:\n:::\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n$`(0,1]`\n          ctype         pval   estimate xpos ypos\nPR   Productive 1.254156e-07 -0.3940962    0    0\nUP Unproductive 1.159352e-06 -0.3836414    0    0\n\n$`(1,2]`\n          ctype       pval     estimate xpos ypos\nUP Unproductive 0.02402581 -0.200991146    0    0\nPR   Productive 0.92858376 -0.007937331    0    0\n\n$`(10,20]`\n          ctype       pval     estimate xpos ypos\nUP Unproductive 0.01042595 -0.257659300    0    0\nPR   Productive 0.92471101  0.006157967    0    0\n\n$`(100,Inf]`\n          ctype       pval   estimate xpos ypos\nPR   Productive 0.39343452 0.04656646    0    0\nUP Unproductive 0.08579947 0.75021041    0    0\n\n$`(2,5]`\n          ctype         pval   estimate xpos ypos\nPR   Productive 9.594439e-04 -0.2055858    0    0\nUP Unproductive 1.568447e-08 -0.3569761    0    0\n\n$`(20,50]`\n          ctype       pval    estimate xpos ypos\nPR   Productive 0.67153749  0.02421734    0    0\nUP Unproductive 0.02685682 -0.29067908    0    0\n\n$`(5,10]`\n          ctype         pval   estimate xpos ypos\nPR   Productive 0.8150535088  0.0149280    0    0\nUP Unproductive 0.0002438611 -0.2982141    0    0\n\n$`(50,100]`\n          ctype      pval    estimate xpos ypos\nPR   Productive 0.2844609  0.07511026    0    0\nUP Unproductive 0.8289487 -0.06996110    0    0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell .column-screen}\n::: {.cell-output-display}\n![](2024-07-16-sQTL-beta-beta-plot-check_files/figure-html/unnamed-chunk-30-1.png){width=960}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}