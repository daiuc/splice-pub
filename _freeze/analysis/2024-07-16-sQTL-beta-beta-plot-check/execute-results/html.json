{
  "hash": "c8f2a35e6a92c12d85543ccbef09ba09",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Check sqtl beta beta corr plot\"\ndate: 2024-7-16\nformat: html\ncategories: ['corr', 'sqtl']\ncode-fold: true\nexecute:\n  include: true\n  eval: true\n  cache: false\n  echo: false\n---\n\n\n\n# Check sqtl beta beta corr plot\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"../smk-plots/gtex-sqtl-enrichment-v4/Cells-EBV-transformedlymphocytes-scatter.png\"\n[2] \"../smk-plots/gtex-sqtl-enrichment-v4/Liver-scatter.png\"                           \n[3] \"../smk-plots/gtex-sqtl-enrichment-v4/WholeBlood-scatter.png\"                      \n```\n\n\n:::\n:::\n\n::: {.cell .column-page layout-ncol=\"4\"}\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size](../smk-plots/gtex-sqtl-enrichment-v4/Cells-EBV-transformedlymphocytes-scatter.png){#fig-scatterplots-1 width=100%}\n:::\n\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size](../smk-plots/gtex-sqtl-enrichment-v4/Liver-scatter.png){#fig-scatterplots-2 width=100%}\n:::\n\n::: {.cell-output-display}\n![comparison of sQTL and eQTL effect size](../smk-plots/gtex-sqtl-enrichment-v4/WholeBlood-scatter.png){#fig-scatterplots-3 width=100%}\n:::\n:::\n\n\n\n# Take a closer look at whole blood\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nRemoved 256 transcriptional snps\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Transformation introduced infinite values in continuous x-axis\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 1266 rows containing non-finite values (`stat_ecdf()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](2024-07-16-sQTL-beta-beta-plot-check_files/figure-html/plot cnt summary-1.png){width=672}\n:::\n:::\n\n\nRemove introns with low read counts (less than 10 reads).\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Number of sQTLs removed due to low read counts:\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   ctype    N\n1: PR,UP  277\n2:    PR 1709\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Number of sQTLs remaining:\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   ctype    N\n1:    PR 2023\n2: PR,UP 1642\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nCorrelation test for Lung:\n\nOriginal:\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n          ctype         pval   estimate xpos ypos\nPR   Productive 1.250455e-19 -0.1981433    0    0\nUP Unproductive 2.313864e-16 -0.1998512    0    0\n```\n\n\n:::\n:::\n\n\nsplit by intron bins:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n    ctype binsbyMean   N\n 1:    PR      (0,1] 618\n 2:    PR      (1,2] 367\n 3:    PR      (2,5] 595\n 4:    PR     (5,10] 475\n 5:    PR    (10,20] 468\n 6:    PR    (20,50] 541\n 7:    PR   (50,100] 309\n 8:    PR  (100,Inf] 411\n 9: PR,UP      (0,1] 622\n10: PR,UP      (1,2] 343\n11: PR,UP      (2,5] 452\n12: PR,UP     (5,10] 237\n13: PR,UP    (10,20] 164\n14: PR,UP    (20,50]  90\n15: PR,UP   (50,100]  21\n16: PR,UP  (100,Inf]   7\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n\n::: {#fig-elephants layout-ncol=2}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![before removing low reads](../smk-plots/gtex-sqtl-enrichment-v4/Lung-scatter.png){width=700}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![after removing low reads](2024-07-16-sQTL-beta-beta-plot-check_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\nBeta beta correlation plot for Lung:\n:::\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n$`(0,1]`\n          ctype         pval   estimate xpos ypos\nPR   Productive 1.015190e-21 -0.3720193    0    0\nUP Unproductive 2.336674e-14 -0.2995103    0    0\n\n$`(1,2]`\n          ctype       pval   estimate xpos ypos\nPR   Productive 0.02607562 -0.1161513    0    0\nUP Unproductive 0.48797500 -0.0375712    0    0\n\n$`(10,20]`\n          ctype      pval     estimate xpos ypos\nUP Unproductive 0.9077659 -0.009116447    0    0\nPR   Productive 0.1384376 -0.068591320    0    0\n\n$`(100,Inf]`\n          ctype        pval   estimate xpos ypos\nPR   Productive 0.006876986  0.1331280    0    0\nUP Unproductive 0.472298485 -0.3282339    0    0\n\n$`(2,5]`\n          ctype         pval   estimate xpos ypos\nUP Unproductive 1.531775e-06 -0.2238487    0    0\nPR   Productive 1.460106e-03 -0.1301878    0    0\n\n$`(20,50]`\n          ctype      pval   estimate xpos ypos\nPR   Productive 0.4288784 0.03408153    0    0\nUP Unproductive 0.1750955 0.14420358    0    0\n\n$`(5,10]`\n          ctype       pval    estimate xpos ypos\nUP Unproductive 0.34150335 -0.06205554    0    0\nPR   Productive 0.03076732 -0.09912773    0    0\n\n$`(50,100]`\n          ctype      pval    estimate xpos ypos\nPR   Productive 0.4240250 -0.04564083    0    0\nUP Unproductive 0.5551912 -0.13650176    0    0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell .column-screen}\n::: {.cell-output-display}\n![](2024-07-16-sQTL-beta-beta-plot-check_files/figure-html/unnamed-chunk-30-1.png){width=960}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}